import{u as L,m as M,b as V,r as l,s as n,j as e,L as p,l as B,P as C,S as T,n as O}from"./index-BktnpWS0.js";import{S as R}from"./store-DDL7ZG_8.js";import{A as P}from"./arrow-left-DLErrt3f.js";import{S as U}from"./shield-check-DNs4Rlpo.js";import{S as d}from"./star-N_Zw1XPq.js";import{S as Z}from"./shopping-bag-CPPoF0he.js";import{M as F}from"./message-square-Bdx-_X7f.js";import{C as z}from"./check-t-U1Tl8Z.js";import{S as Y}from"./send-Ywos9H0t.js";function te(){const A=L(),{userId:o}=M(),{user:x}=V(),[a,D]=l.useState(null),[m,E]=l.useState([]),[c,$]=l.useState([]),[q,f]=l.useState(!0),[h,u]=l.useState(!1),[g,b]=l.useState(5),[j,w]=l.useState(""),[N,y]=l.useState(null),[v,k]=l.useState(!1);l.useEffect(()=>{o&&S()},[o]);const S=async()=>{f(!0);try{const{data:s}=await n.from("vendor_profiles").select("*").eq("user_id",o).single();if(s){D(s);const{data:t}=await n.from("products").select("*, category:categories(name, slug)").eq("vendor_id",s.id).eq("is_active",!0).order("created_at",{ascending:!1});t&&E(t);const{data:r}=await n.from("vendor_reviews").select("*, user:profiles(full_name)").eq("vendor_id",s.id).order("created_at",{ascending:!1});r&&$(r)}}catch(s){console.error("Error fetching shop data:",s)}finally{f(!1)}},I=async s=>{if(s.preventDefault(),!!x&&a){u(!0),y(null);try{const{error:t}=await n.from("vendor_reviews").insert({vendor_id:a.id,user_id:x.id,rating:g,comment:j});if(t)throw t;k(!0),w(""),b(5),S(),setTimeout(()=>k(!1),3e3)}catch(t){y(t.message)}finally{u(!1)}}};return q?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-emerald-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 font-black uppercase tracking-widest text-xs",children:"Opening Shop..."})]})}):a?e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20",children:[e.jsxs("div",{className:"h-[250px] md:h-[300px] relative overflow-hidden bg-gray-900",children:[a.shop_banner_url?e.jsx("img",{src:a.shop_banner_url,className:"w-full h-full object-cover opacity-60",alt:a.shop_name}):e.jsx("div",{className:"w-full h-full bg-emerald-900 flex items-center justify-center"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-50 via-transparent to-transparent"})]}),e.jsxs("div",{className:"container mx-auto px-4 -mt-20 relative z-10",children:[e.jsx("div",{className:"bg-white rounded-3xl shadow-xl shadow-gray-200/50 p-6 md:p-8 border border-gray-100",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[e.jsx("div",{className:"w-24 h-24 md:w-32 md:h-32 bg-white p-1.5 rounded-2xl shadow-xl border border-gray-50 flex-shrink-0 flex items-center justify-center overflow-hidden",children:a.shop_logo_url?e.jsx("img",{src:a.shop_logo_url,className:"w-full h-full object-cover rounded-xl",alt:a.shop_name}):e.jsx(R,{className:"w-12 h-12 text-emerald-500"})}),e.jsxs("div",{className:"flex-1 mt-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-black text-gray-900 uppercase tracking-tight",children:a.shop_name}),a.is_verified&&e.jsxs("div",{className:"bg-emerald-50 px-3 py-1 rounded-full flex items-center gap-1.5 border border-emerald-100",children:[e.jsx(U,{className:"w-4 h-4 text-emerald-600"}),e.jsx("span",{className:"text-[8px] font-black text-emerald-900 uppercase tracking-widest",children:"Verified Merchant"})]})]}),e.jsx("p",{className:"text-sm text-gray-600 font-medium leading-relaxed max-w-2xl mb-6",children:a.shop_description||"Certified ZimAIO partner committed to providing superior products."}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-center border-t border-gray-50 pt-6 mt-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest mb-0.5",children:"Rating"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(d,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"}),e.jsx("span",{className:"text-base font-black text-gray-900",children:(a.rating||5).toFixed(1)})]})]}),e.jsx("div",{className:"h-8 w-px bg-gray-100 hidden sm:block"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest mb-0.5",children:"Catalog"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Z,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("span",{className:"text-base font-black text-gray-900",children:[m.length," Items"]})]})]}),e.jsx("div",{className:"h-8 w-px bg-gray-100 hidden sm:block"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest mb-0.5",children:"Presence"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(B,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-base font-black text-gray-900",children:"Zimbabwe"})]})]})]})]})]})}),e.jsxs("div",{className:"mt-12",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4 mb-8",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-gray-900 uppercase tracking-tight",children:"Catalog Items"}),e.jsxs("p",{className:"text-gray-500 font-bold uppercase tracking-widest text-[10px] mt-1",children:["Products from ",a.shop_name]})]})}),m.length===0?e.jsxs("div",{className:"bg-white rounded-[2.5rem] border border-gray-100 p-20 text-center shadow-sm",children:[e.jsx(C,{className:"w-20 h-20 text-gray-200 mx-auto mb-6"}),e.jsx("h3",{className:"text-2xl font-black text-gray-900 uppercase",children:"Inventory Empty"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"This vendor has no active products listed currently."})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:m.map(s=>{var t,r;return e.jsxs(p,{to:`/products/${s.slug}`,className:"group bg-white rounded-2xl overflow-hidden border border-gray-100 shadow-sm hover:shadow-xl hover:shadow-emerald-900/5 transition-all duration-300",children:[e.jsxs("div",{className:"aspect-square relative overflow-hidden bg-gray-50",children:[(t=s.images)!=null&&t[0]?e.jsx("img",{src:s.images[0],className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",alt:s.name}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(C,{className:"w-8 h-8 text-gray-200"})}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx("span",{className:"px-2 py-0.5 bg-white/90 backdrop-blur-md rounded-full text-[8px] font-black text-emerald-600 uppercase tracking-widest shadow-sm",children:((r=s.category)==null?void 0:r.name)||"Item"})})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h4",{className:"font-bold text-gray-900 text-xs mb-2 uppercase tracking-tight group-hover:text-emerald-600 transition-colors line-clamp-1 leading-tight",children:s.name}),e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-50 pt-2",children:[e.jsxs("p",{className:"text-sm font-black text-emerald-600",children:["$",s.base_price.toFixed(2)]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:i=>{var _;i.preventDefault(),i.stopPropagation(),(_=s.category)!=null&&_.slug&&A(`/products?category=${s.category.slug}`)},className:"w-6 h-6 bg-gray-50 hover:bg-emerald-600 hover:text-white text-gray-400 rounded-lg flex items-center justify-center transition-all",title:"Find Similar",children:e.jsx(T,{className:"w-3.5 h-3.5"})}),e.jsx("div",{className:"w-6 h-6 bg-emerald-50 rounded-lg flex items-center justify-center text-emerald-600 group-hover:bg-emerald-600 group-hover:text-white transition-all",children:e.jsx(P,{className:"w-3.5 h-3.5 rotate-180"})})]})]})]})]},s.id)})})]}),e.jsx("div",{className:"mt-16",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-10",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx("h2",{className:"text-xl font-black text-gray-900 uppercase tracking-tight mb-1",children:"Shop Ratings"}),e.jsxs("p",{className:"text-gray-400 font-bold text-[10px] uppercase tracking-widest mb-8",children:["Customer feedback for ",a.shop_name,"."]}),e.jsxs("div",{className:"bg-white rounded-3xl p-6 border border-gray-100 shadow-sm mb-6 text-left",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"text-4xl font-black text-gray-900 mb-1",children:(a.rating||5).toFixed(1)}),e.jsx("div",{className:"flex justify-center gap-1 mb-1",children:[...Array(5)].map((s,t)=>e.jsx(d,{className:`w-4 h-4 ${t<Math.floor(a.rating||5)?"text-yellow-500 fill-yellow-500":"text-gray-200"}`},t))}),e.jsxs("p",{className:"text-[9px] font-black text-gray-400 uppercase tracking-[0.2em]",children:[c.length," Store Reviews"]})]}),e.jsx("div",{className:"space-y-3",children:[5,4,3,2,1].map(s=>{const t=c.filter(i=>i.rating===s).length,r=c.length>0?t/c.length*100:0;return e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-400 w-2 shrink-0",children:s}),e.jsx("div",{className:"flex-1 h-1.5 bg-gray-50 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-yellow-500 rounded-full",style:{width:`${r}%`}})}),e.jsx("span",{className:"text-[10px] font-black text-gray-400 w-6 shrink-0 text-right",children:t})]},s)})})]}),e.jsxs("div",{className:"bg-white rounded-3xl p-6 border border-emerald-100 shadow-xl shadow-emerald-900/5 text-left",children:[e.jsxs("h3",{className:"font-black text-gray-900 uppercase tracking-tight mb-4 flex items-center gap-2 text-sm",children:[e.jsx(F,{className:"w-4 h-4 text-emerald-600"})," Rate Vendor"]}),x?e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[8px] font-black text-gray-400 uppercase tracking-widest mb-2 block text-center",children:"Your Rating"}),e.jsx("div",{className:"flex justify-center gap-1",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>b(s),className:`p-1 transition-all ${g>=s?"scale-110":"opacity-30 hover:opacity-100"}`,children:e.jsx(d,{className:`w-6 h-6 ${g>=s?"text-yellow-500 fill-yellow-500":"text-gray-300"}`})},s))})]}),e.jsx("div",{children:e.jsx("textarea",{required:!0,value:j,onChange:s=>w(s.target.value),placeholder:"Service feedback...",rows:3,className:"w-full bg-gray-50 border border-transparent rounded-xl p-4 text-xs font-medium focus:bg-white focus:border-emerald-500 outline-none transition-all placeholder-gray-400"})}),N&&e.jsxs("div",{className:"bg-red-50 text-red-600 text-[8px] font-bold p-3 rounded-lg flex items-center gap-2",children:[e.jsx(O,{className:"w-3 h-3"})," ",N]}),e.jsx("button",{type:"submit",disabled:h,className:`w-full py-3 rounded-xl font-black uppercase tracking-widest text-[9px] transition-all flex items-center justify-center gap-2 ${v?"bg-emerald-50 text-emerald-600":h?"bg-gray-100 text-gray-400":"bg-gray-900 text-white hover:bg-emerald-600"}`,children:v?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-3 h-3"})," Posted"]}):h?e.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"w-3 h-3"})," Submit"]})})]}):e.jsxs("div",{className:"text-center py-2",children:[e.jsx("p",{className:"text-[10px] text-gray-400 font-bold mb-2",children:"Sign in to share your experience"}),e.jsx(p,{to:"/login",className:"text-[9px] font-black text-emerald-600 uppercase tracking-widest hover:underline",children:"Sign In Now"})]})]})]}),e.jsx("div",{className:"lg:col-span-2 space-y-4",children:c.length===0?e.jsxs("div",{className:"bg-white rounded-3xl border border-gray-100 p-12 text-center shadow-sm",children:[e.jsx(F,{className:"w-12 h-12 text-gray-100 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-black text-gray-900 uppercase",children:"Awaiting Feedback"}),e.jsx("p",{className:"text-gray-400 font-bold text-[10px] uppercase tracking-widest",children:"Be the first to rate your experience."})]}):c.map(s=>{var t,r,i;return e.jsxs("div",{className:"bg-white rounded-3xl p-6 md:p-8 border border-gray-100 shadow-sm text-left",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-50 rounded-xl flex items-center justify-center font-black text-emerald-600 uppercase text-sm",children:((r=(t=s.user)==null?void 0:t.full_name)==null?void 0:r.charAt(0))||"U"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-black text-gray-900 uppercase tracking-tight text-xs",children:((i=s.user)==null?void 0:i.full_name)||"Verified Customer"}),e.jsx("p",{className:"text-[8px] text-gray-400 font-bold uppercase tracking-widest",children:new Date(s.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-yellow-50 px-2 py-1 rounded-full",children:[e.jsx(d,{className:"w-3 h-3 text-yellow-500 fill-yellow-500"}),e.jsx("span",{className:"text-[10px] font-black text-yellow-700",children:s.rating.toFixed(1)})]})]}),e.jsxs("p",{className:"text-gray-600 font-medium leading-relaxed italic text-sm",children:['"',s.comment,'"']})]},s.id)})})]})})]})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx(R,{className:"w-20 h-20 text-gray-200 mx-auto mb-6"}),e.jsx("h2",{className:"text-3xl font-black text-gray-900 uppercase mb-4",children:"Store Not Found"}),e.jsx("p",{className:"text-gray-500 font-medium mb-8",children:"The shop you are looking for might have moved or closed down."}),e.jsxs(p,{to:"/vendors",className:"inline-flex items-center gap-2 bg-emerald-600 text-white px-8 py-4 rounded-2xl font-black uppercase tracking-widest text-xs shadow-xl shadow-emerald-200 hover:bg-emerald-700 transition-all",children:[e.jsx(P,{className:"w-4 h-4"})," Back to Vendors"]})]})})}export{te as ShopPage};
