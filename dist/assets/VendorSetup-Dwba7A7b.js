import{e as _,u as C,r as l,j as e,S as D,w as z,C as E,d as L,A as q,s as o}from"./index-T9wcIP7k.js";import{U as $}from"./upload-DtkpSNDN.js";import{C as F}from"./check-CtKt80mY.js";function B(){const{profile:s}=_(),k=C(),[m,i]=l.useState(!1),[p,n]=l.useState(null),[g,w]=l.useState([]),[r,h]=l.useState(null),[c,j]=l.useState(""),[x,f]=l.useState(!1);l.useEffect(()=>{(async()=>{const{data:t}=await o.from("vendor_packages").select("*").eq("is_active",!0).order("sort_order");if(t){w(t);const u=t.find(b=>b.is_default)||t[0];h(u)}})()},[]);const v=async a=>{if(a.preventDefault(),i(!0),n(null),!r){n("Please select a subscription package."),i(!1);return}const t=new FormData(a.currentTarget),u=t.get("shopName"),b=t.get("shopDescription"),N=t.get("businessEmail"),S=t.get("businessPhone");try{const{error:d}=await o.from("vendor_profiles").upsert({user_id:s==null?void 0:s.id,shop_name:u,shop_description:b,business_email:N,business_phone:S,is_approved:!1,kyc_status:"none"},{onConflict:"user_id"});if(d)throw d;const{data:y}=await o.from("vendor_subscriptions").select("id").eq("vendor_id",s==null?void 0:s.id).maybeSingle();y?await o.from("vendor_subscriptions").update({package_id:r.id,billing_cycle:"monthly"}).eq("id",y.id):await o.from("vendor_subscriptions").insert({vendor_id:s==null?void 0:s.id,package_id:r.id,status:"active",billing_cycle:"monthly"}),k("/vendor/dashboard")}catch(d){n(d.message)}finally{i(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-2xl w-full bg-white dark:bg-slate-900 rounded-[40px] shadow-2xl border border-gray-100 dark:border-slate-800 animate-in fade-in zoom-in duration-500 relative",children:[e.jsxs("div",{className:"p-10 border-b border-gray-50 dark:border-slate-800 bg-gray-50/50 dark:bg-slate-900/50 flex items-center gap-6 rounded-t-[40px]",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-600 rounded-3xl flex items-center justify-center text-white shadow-lg shadow-emerald-500/20",children:e.jsx(D,{size:32})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black text-gray-900 dark:text-white uppercase tracking-tight",children:"Shop Setup"}),e.jsx("p",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 mt-1 uppercase tracking-widest",children:"Configure your digital storefront identity."})]})]}),e.jsxs("form",{onSubmit:v,className:"p-10 space-y-8",children:[p&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-100 dark:border-red-900/30 p-4 rounded-2xl flex items-center gap-3 text-red-600 dark:text-red-400",children:[e.jsx(z,{size:20}),e.jsx("p",{className:"text-sm font-bold",children:p})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest ml-1 mb-2 block",children:"Shop Name"}),e.jsx("input",{name:"shopName",required:!0,placeholder:"e.g. Zim Minerals Premium",className:"w-full bg-gray-50 dark:bg-slate-800 border-gray-100 dark:border-slate-700 border focus:border-emerald-500 dark:focus:border-emerald-500 focus:bg-white dark:focus:bg-slate-900 rounded-2xl py-4 px-5 text-sm font-black transition-all outline-none dark:text-white"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest ml-1 mb-2 block",children:"Business Email"}),e.jsx("input",{name:"businessEmail",type:"email",required:!0,defaultValue:s==null?void 0:s.email,placeholder:"sales@yourshop.com",className:"w-full bg-gray-50 dark:bg-slate-800 border-gray-100 dark:border-slate-700 border focus:border-emerald-500 dark:focus:border-emerald-500 focus:bg-white dark:focus:bg-slate-900 rounded-2xl py-4 px-5 text-sm font-black transition-all outline-none dark:text-white"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest ml-1 mb-2 block",children:"Business Phone"}),e.jsx("input",{name:"businessPhone",required:!0,placeholder:"+263 ...",className:"w-full bg-gray-50 dark:bg-slate-800 border-gray-100 dark:border-slate-700 border focus:border-emerald-500 dark:focus:border-emerald-500 focus:bg-white dark:focus:bg-slate-900 rounded-2xl py-4 px-5 text-sm font-black transition-all outline-none dark:text-white"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest ml-1 mb-2 block",children:"Shop Logo (Optional)"}),e.jsxs("div",{className:"w-full h-[54px] bg-gray-50 dark:bg-slate-800 border-gray-100 dark:border-slate-700 border border-dashed rounded-2xl flex items-center justify-center text-gray-400 text-[10px] font-black uppercase tracking-widest gap-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-slate-700 transition-colors",children:[e.jsx($,{size:14}),"Select File"]})]})]})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest ml-1 mb-2 block",children:"Shop Description"}),e.jsx("textarea",{name:"shopDescription",required:!0,rows:3,placeholder:"Tell customers about your products and expertise...",className:"w-full bg-gray-50 dark:bg-slate-800 border-gray-100 dark:border-slate-700 border focus:border-emerald-500 dark:focus:border-emerald-500 focus:bg-white dark:focus:bg-slate-900 rounded-2xl p-5 text-sm font-bold transition-all outline-none dark:text-white"})]}),e.jsxs("div",{className:"relative group z-20",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest ml-1 mb-2 block",children:"Select Subscription Plan"}),e.jsxs("div",{onClick:()=>f(!x),className:"w-full bg-gray-50 dark:bg-slate-800 border-gray-100 dark:border-slate-700 border rounded-2xl p-4 cursor-pointer flex items-center justify-between hover:border-emerald-500 transition-all",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-black text-gray-900 dark:text-white",children:(r==null?void 0:r.name)||"Select Package"}),e.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider ${(r==null?void 0:r.price_monthly)===0?"text-emerald-500":"text-gray-500"}`,children:(r==null?void 0:r.price_monthly)===0?"Lifetime Free Access":`$${r==null?void 0:r.price_monthly}/mo`})]}),e.jsx(E,{size:16,className:`text-gray-400 transition-transform ${x?"rotate-180":""}`})]}),x&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white dark:bg-slate-800 border border-gray-100 dark:border-slate-700 rounded-2xl shadow-xl overflow-hidden z-50",children:[e.jsx("div",{className:"p-3 border-b border-gray-50 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 dark:bg-slate-900 px-3 py-2 rounded-xl",children:[e.jsx(L,{size:14,className:"text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search packages...",value:c,onChange:a=>j(a.target.value),className:"bg-transparent border-none outline-none text-xs font-bold w-full dark:text-white",autoFocus:!0})]})}),e.jsxs("div",{className:"max-h-48 overflow-y-auto p-2 scrollbar-thin scrollbar-thumb-gray-200 dark:scrollbar-thumb-slate-700",children:[g.filter(a=>a.name.toLowerCase().includes(c.toLowerCase())).map(a=>e.jsxs("div",{onClick:()=>{h(a),f(!1)},className:`p-3 rounded-xl cursor-pointer flex items-center justify-between transition-colors ${(r==null?void 0:r.id)===a.id?"bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600":"hover:bg-gray-50 dark:hover:bg-slate-700 text-gray-600 dark:text-gray-300"}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-black uppercase tracking-wide",children:a.name}),e.jsx("p",{className:"text-[10px] opacity-70",children:a.price_monthly===0?"Free":`$${a.price_monthly} / mo`})]}),(r==null?void 0:r.id)===a.id&&e.jsx(F,{size:14})]},a.id)),g.filter(a=>a.name.toLowerCase().includes(c.toLowerCase())).length===0&&e.jsx("div",{className:"p-4 text-center text-xs text-gray-400 font-medium",children:"No packages found"})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",disabled:m,className:"w-full bg-gray-900 dark:bg-emerald-600 text-white py-6 rounded-2xl text-[11px] font-black uppercase tracking-[0.2em] hover:bg-black dark:hover:bg-emerald-700 transition-all shadow-xl shadow-gray-200 dark:shadow-emerald-900/20 flex items-center justify-center gap-3 active:scale-95 disabled:opacity-50",children:m?"Propagating Store Data...":e.jsxs(e.Fragment,{children:["Launch My Store",e.jsx(q,{size:16})]})})})]})]})})}export{B as VendorSetup};
