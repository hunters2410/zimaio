import{n as k,b as v,r,s as n,j as e,m as y,D as _}from"./index-DO0RgZ49.js";import{R as b}from"./refresh-ccw-CpAuEwPx.js";import{X as S}from"./x-DeAqnK16.js";import{A as u}from"./arrow-up-right-Dg7K0HEg.js";import{T as D}from"./trending-down-B9LMXrry.js";import{C as z}from"./clock-BObq69c6.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"M17 7 7 17",key:"15tmo1"}],["path",{d:"M17 17H7V7",key:"1org7z"}]],C=k("arrow-down-left",A);function W(){var h;const{user:a}=v(),[s,f]=r.useState(null),[c,j]=r.useState([]),[d,o]=r.useState(!0),[i,x]=r.useState(null);r.useEffect(()=>{a&&m()},[a]);const m=async()=>{o(!0);try{let{data:t,error:l}=await n.from("wallets").select("*").eq("user_id",a==null?void 0:a.id).single();if(l&&l.code==="PGRST116"){const{data:N,error:g}=await n.from("wallets").insert([{user_id:a==null?void 0:a.id,balance_usd:0,balance_zig:0}]).select().single();if(g)throw g;t=N}else if(l)throw l;f({id:t.id,balance_usd:Number(t.balance_usd)||0,balance_zig:Number(t.balance_zig)||0,total_earned:Number(t.total_earned)||0,total_withdrawn:Number(t.total_withdrawn)||0});const{data:w,error:p}=await n.from("wallet_transactions_detailed").select("*").eq("wallet_id",t.id).order("created_at",{ascending:!1}).limit(10);if(p)throw p;j(w||[])}catch(t){x({type:"error",text:t.message})}finally{o(!1)}};return d&&!s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-600"})}):e.jsxs("div",{className:"max-w-6xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-black text-slate-900 dark:text-white uppercase tracking-tighter",children:"My Treasury"}),e.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-[10px] mt-1",children:"Personal Funds & Balance Audit"})]}),e.jsx("button",{onClick:m,className:"p-3 bg-white dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 rounded-2xl hover:bg-slate-50 transition-colors shadow-sm",children:e.jsx(b,{className:`w-5 h-5 ${d?"animate-spin":""}`})})]}),i&&e.jsxs("div",{className:`p-4 rounded-2xl flex items-center justify-between ${i.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest",children:i.text})]}),e.jsx("button",{onClick:()=>x(null),children:e.jsx(S,{size:18})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-slate-900 to-slate-800 rounded-[2rem] p-8 text-white shadow-2xl relative overflow-hidden group border-4 border-white/5",children:e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("div",{className:"p-2 bg-white/10 rounded-lg",children:e.jsx(_,{className:"w-5 h-5 text-cyan-400"})}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-cyan-400/80",children:"USD Balance"})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-4xl font-black tracking-tighter",children:["$",s==null?void 0:s.balance_usd.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsx(u,{className:"w-5 h-5 text-green-400"})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-[2rem] p-8 border-2 border-slate-50 dark:border-slate-700 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("div",{className:"p-2 bg-cyan-50 dark:bg-cyan-900/20 rounded-lg",children:e.jsx(b,{className:"w-5 h-5 text-cyan-600"})}),e.jsx("span",{className:"text-[10px] font-black text-slate-400 tracking-widest uppercase",children:"ZIG Treasury"})]}),e.jsxs("p",{className:"text-3xl font-black text-slate-900 dark:text-white tracking-tighter",children:[s==null?void 0:s.balance_zig.toLocaleString()," ",e.jsx("span",{className:"text-xs",children:"ZIG"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-[2rem] p-8 border-2 border-slate-50 dark:border-slate-700 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-50 dark:bg-purple-900/20 rounded-lg",children:e.jsx(D,{className:"w-5 h-5 text-purple-600"})}),e.jsx("span",{className:"text-[10px] font-black text-slate-400 tracking-widest uppercase",children:"Total Spent"})]}),e.jsxs("p",{className:"text-3xl font-black text-slate-900 dark:text-white tracking-tighter",children:["$",(h=s==null?void 0:s.total_withdrawn)==null?void 0:h.toLocaleString()]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-[2.5rem] border-2 border-slate-50 dark:border-slate-700 shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"p-8 border-b-2 border-slate-50 dark:border-slate-700 flex items-center justify-between",children:[e.jsx("h2",{className:"text-sm font-black text-slate-900 dark:text-white uppercase tracking-widest",children:"Recent Activity"}),e.jsx(z,{className:"w-4 h-4 text-slate-300"})]}),e.jsxs("div",{className:"divide-y-2 divide-slate-50 dark:divide-slate-800",children:[c.map(t=>e.jsxs("div",{className:"p-6 flex items-center justify-between hover:bg-slate-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-3 rounded-2xl ${t.amount>0?"bg-green-50 text-green-600":"bg-red-50 text-red-600"}`,children:t.amount>0?e.jsx(C,{size:20}):e.jsx(u,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-slate-900 dark:text-white uppercase tracking-tighter",children:t.description}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:new Date(t.created_at).toLocaleString()})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-sm font-black tracking-tight ${t.amount>0?"text-green-600":"text-slate-900 dark:text-white"}`,children:[t.amount>0?"+":"",t.amount," ",t.currency]}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-slate-300",children:t.transaction_type})]})]},t.id)),c.length===0&&e.jsx("div",{className:"p-20 text-center",children:e.jsx("p",{className:"text-[10px] font-black text-slate-300 uppercase tracking-[0.4em]",children:"No financial data logged yet"})})]})]})]})}export{W as CustomerWallet};
