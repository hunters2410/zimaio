import{i as rt,r as a,s as m,j as e,n as ne,D as ce,R as vt,b as se,L as ze,u as lt,c as kt,o as _t,S as ie,p as St,q as Ct,k as Re,h as ge,P as X,M as Dt,d as nt,C as ve,U as it,l as Pt,A as qt}from"./index-BktnpWS0.js";import{W as $t}from"./wallet-BZzyyv9x.js";import{A as Ae}from"./arrow-up-right-D1EFnWCi.js";import{C as J}from"./circle-check-big-DQYFJHkd.js";import{T as Ce}from"./trending-up-wuknMfwd.js";import{S as he}from"./store-DDL7ZG_8.js";import{C as oe}from"./credit-card-BMxorgaG.js";import{I as Le,T as ue,E as Rt,M as Ee,a as Ue}from"./triangle-alert-HMuOKNOn.js";import{S as pe}from"./save-Ddg7boI0.js";import{X as ee}from"./x-Be8cuiWM.js";import{B as Ze,C as At}from"./chevron-left-AWoZAuKB.js";import{C as Xe}from"./chevron-right-peYPGYwP.js";import{S as dt}from"./shield-QBrICIHj.js";import{Z as ct}from"./zap-CpGj1Zaf.js";import{M as Lt}from"./maximize-DSH1SQuK.js";import{R as ot}from"./rotate-ccw-BpT03k5V.js";import{S as Et}from"./settings-D3GsvmJN.js";import{U as be}from"./upload-D9QKC-bD.js";import{L as Ut}from"./lock-BwUOE3mp.js";import{L as It,E as Je,P as Ie,M as Ot,A as Mt}from"./pen-DVuHV3aD.js";import{L as et}from"./layout-grid-6J_pzq4j.js";import{P as _e}from"./plus-DKkFzrwN.js";import{E as Ft}from"./ellipsis-vertical-ZD8ril7W.js";import{F as xt}from"./funnel-NTM8UTrP.js";import{E as Se}from"./eye-geM34do8.js";import{T as Oe}from"./trash-2-BZYqHlTV.js";import{C as te}from"./circle-x-Cwk9QA9x.js";import{C as Be}from"./calendar-CBE4Rgbp.js";import{F as de}from"./file-text-DIHdwLby.js";import{T as Vt}from"./truck-CO3939ut.js";import{C as mt}from"./clock-Ep4hhKF1.js";import{C as Me}from"./check-t-U1Tl8Z.js";import{V as Tt}from"./VendorPOS-CvODHvda.js";import{S as ke}from"./shield-check-DNs4Rlpo.js";import{D as tt}from"./jspdf.es.min-Bw_9JQnp.js";import{R as Fe,A as ut,C as pt,X as gt,Y as ht,T as Ve,a as bt,P as zt,b as Bt,c as Wt}from"./AreaChart-C4MoTLKD.js";import{C as Kt}from"./circle-Bl7k3hc2.js";import{S as Gt}from"./send-Ywos9H0t.js";import"./html2canvas.esm-CBrSDip1.js";import"./minus-CUR8ke6T.js";import"./banknote-WnSVUBld.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Te=rt("archive",Yt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],$e=rt("history",Ht);function Qt(){const[r,D]=a.useState([]),[R,j]=a.useState([]),[E,x]=a.useState([]),[M,C]=a.useState([]),[p,v]=a.useState(0),[S,U]=a.useState(!0),[u,P]=a.useState(!1),[b,n]=a.useState(null),[y,_]=a.useState(null),[c,d]=a.useState(null),[k,s]=a.useState({}),[o,f]=a.useState(!1),[A,I]=a.useState(!1),[q,B]=a.useState(""),[i,g]=a.useState("");a.useEffect(()=>{l()},[]);const l=async()=>{U(!0);try{const{data:{user:h}}=await m.auth.getUser();if(!h)throw new Error("Not authenticated");d(h.id);const[F,w,T,G]=await Promise.all([m.from("vendor_profiles").select("id").eq("user_id",h.id).single(),m.from("wallets").select("balance").eq("user_id",h.id).maybeSingle(),m.from("payment_gateways").select("*").eq("is_active",!0),m.from("withdrawal_requests").select("*").eq("vendor_id",h.id).order("requested_at",{ascending:!1})]);if(F.error)throw F.error;const Q=F.data;_(Q.id),w.data?v(w.data.balance||0):(console.warn("Wallet data not found for user"),v(0)),T.data&&x(T.data),G.data&&C(G.data);const[ae,re]=await Promise.all([m.from("currencies").select("*").eq("is_active",!0).in("code",["USD","ZWL"]).order("code"),m.from("vendor_currency_rates").select("*").eq("vendor_id",Q.id)]);if(ae.error)throw ae.error;if(re.error)throw re.error;D(ae.data||[]),j(re.data||[]);const xe={};(re.data||[]).forEach(le=>{le.currency_code&&le.exchange_rate!==void 0&&(xe[le.currency_code]=le.exchange_rate.toString())}),s(xe)}catch(h){console.error("Error in VendorCurrencyManagement fetchData:",h),n({type:"error",text:`Failed to load wallet data: ${h.message}`})}finally{U(!1)}},L=async h=>{if(h.preventDefault(),!c)return;const F=parseFloat(q);if(isNaN(F)||F<=0){alert("Please enter a valid amount");return}if(F>p){alert("Insufficient balance");return}if(!i){alert("Please select a payment gateway");return}P(!0);try{const{error:w}=await m.from("withdrawal_requests").insert({vendor_id:c,amount:F,currency:"USD",status:"pending",payment_method:i,net_amount:F*.98,withdrawal_charges:F*.02});if(w)throw w;f(!1),B(""),n({type:"success",text:"Withdrawal request submitted successfully."}),l()}catch(w){alert(w.message)}finally{P(!1)}},W=(h,F)=>{h!=="USD"&&(F===""||/^\d*\.?\d*$/.test(F))&&s(w=>({...w,[h]:F}))},z=async()=>{if(y){P(!0),n(null);try{for(const[h,F]of Object.entries(k)){if(h==="USD")continue;const w=parseFloat(F);if(isNaN(w)||w<=0)throw new Error(`Invalid rate for ${h}`);const T=R.find(G=>G.currency_code===h);T?await m.from("vendor_currency_rates").update({exchange_rate:w}).eq("id",T.id):await m.from("vendor_currency_rates").insert({vendor_id:y,currency_code:h,exchange_rate:w,is_active:!0})}n({type:"success",text:"Changes saved successfully."}),l()}catch(h){n({type:"error",text:h.message})}finally{P(!1)}}},V=h=>{const F=r.find(w=>w.code===h);F&&s(w=>({...w,[h]:F.exchange_rate.toString()}))};return S?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-emerald-600"})}):e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl p-6 shadow-sm overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-emerald-50 rounded-full -mr-16 -mt-16 opacity-50"}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-emerald-600 rounded-2xl flex items-center justify-center shadow-lg shadow-emerald-600/20",children:e.jsx($t,{className:"text-white w-7 h-7"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase tracking-widest font-black text-gray-400 mb-0.5",children:"Available Balance"}),e.jsxs("h2",{className:"text-3xl font-black text-gray-900 leading-none",children:[e.jsx("span",{className:"text-gray-400 text-xl mr-1",children:"$"}),p.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white text-xs font-bold px-5 py-2.5 rounded-xl transition-all shadow-sm active:scale-95",children:[e.jsx(Ae,{className:"w-4 h-4"}),"WITHDRAW"]}),e.jsxs("button",{onClick:()=>I(!0),className:"flex items-center gap-2 bg-white hover:bg-gray-50 text-gray-700 text-xs font-bold px-5 py-2.5 rounded-xl transition-all border border-gray-200 active:scale-95 shadow-sm",children:[e.jsx($e,{className:"w-4 h-4"}),"HISTORY"]})]})]})]}),b&&e.jsxs("div",{className:`p-3 rounded-xl flex items-center gap-3 text-sm font-medium ${b.type==="success"?"bg-green-50 text-green-700 border border-green-100":"bg-red-50 text-red-700 border border-red-100"}`,children:[b.type==="success"?e.jsx(J,{className:"w-4 h-4"}):e.jsx(ne,{className:"w-4 h-4"}),b.text]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-5 border-b border-gray-50 bg-gray-50/30 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-emerald-50 rounded-lg",children:e.jsx(Ce,{className:"w-4 h-4 text-emerald-600"})}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"Exchange Rate Control"})]}),e.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-wider bg-white px-3 py-1 rounded-full border border-gray-100",children:"Market Basis: 1 USD"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:r.map(h=>{var T;const F=k[h.code]||h.exchange_rate.toString(),w=h.code==="USD";return e.jsxs("div",{className:`p-5 rounded-2xl border ${w?"bg-gray-50/50 border-gray-100 opacity-80":"bg-white border-gray-200"} transition-all hover:shadow-md hover:shadow-gray-100/50`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-lg font-bold ${w?"bg-gray-100 text-gray-400":"bg-emerald-50 text-emerald-600"}`,children:h.symbol}),e.jsxs("div",{children:[e.jsx("span",{className:"font-black text-gray-900 text-xs uppercase tracking-tight block",children:h.name}),e.jsx("span",{className:"text-[10px] text-gray-400 font-bold",children:h.code})]})]}),w&&e.jsx("span",{className:"text-[9px] font-black text-gray-400 bg-gray-200/50 px-2 py-0.5 rounded-full letter-spacing-widest",children:"DEFAULT"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1.5 ml-1",children:"Your Custom Rate"}),e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"text",value:F,disabled:w,onChange:G=>W(h.code,G.target.value),className:"w-full pl-9 pr-12 py-2.5 bg-white border border-gray-200 rounded-xl text-sm text-gray-900 font-black focus:ring-4 focus:ring-emerald-500/10 focus:border-emerald-500 outline-none transition-all disabled:bg-gray-50 disabled:text-gray-400"}),e.jsx(ce,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 group-focus-within:text-emerald-500 transition-colors"}),!w&&e.jsx("button",{onClick:()=>V(h.code),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 text-gray-300 hover:text-emerald-600 transition-colors bg-gray-50 rounded-lg",title:"Reset to system rate",children:e.jsx(vt,{className:"w-3.5 h-3.5"})})]})]}),!w&&e.jsxs("div",{className:"pt-3 border-t border-gray-50 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] font-bold",children:[e.jsxs("span",{className:"text-gray-400 flex items-center gap-1",children:[e.jsx(he,{className:"w-3 h-3"})," System Rate"]}),e.jsx("span",{className:"text-gray-700 bg-gray-100 px-2 py-0.5 rounded",children:h.exchange_rate})]}),e.jsxs("div",{className:"flex items-center justify-between text-[10px] font-bold",children:[e.jsxs("span",{className:"text-gray-400 flex items-center gap-1",children:[e.jsx(oe,{className:"w-3 h-3"})," Live Rate"]}),e.jsx("span",{className:"text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded",children:((T=R.find(G=>G.currency_code===h.code))==null?void 0:T.exchange_rate)||h.exchange_rate})]})]})]})]},h.code)})}),e.jsxs("div",{className:"mt-8 flex flex-col md:flex-row md:items-center justify-between gap-6 p-5 border border-blue-50 bg-blue-50/20 rounded-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-1 opacity-5",children:e.jsx(Le,{className:"w-20 h-20 text-blue-500"})}),e.jsxs("div",{className:"flex items-start gap-3 relative z-10",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx(Le,{className:"w-4 h-4 text-blue-600 shrink-0"})}),e.jsx("p",{className:"text-xs text-blue-800 font-medium leading-relaxed max-w-md",children:"Set your custom exchange rates to control your profit margins. Prices on the storefront will be automatically calculated using these specific rates only for your store."})]}),e.jsxs("button",{onClick:z,disabled:u,className:"flex items-center justify-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white text-xs font-black px-8 py-3 rounded-xl transition-all disabled:opacity-50 shadow-lg shadow-emerald-600/20 active:scale-95 uppercase tracking-wider relative z-10",children:[e.jsx(pe,{className:"w-4 h-4"}),u?"Processing...":"Save Rates"]})]})]})]}),o&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-3xl shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-50 flex items-center justify-between bg-gray-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-600 rounded-xl flex items-center justify-center shadow-lg shadow-emerald-600/20",children:e.jsx(Ae,{className:"text-white w-5 h-5"})}),e.jsx("h3",{className:"text-lg font-black text-gray-900 uppercase tracking-tight",children:"Withdraw Funds"})]}),e.jsx("button",{onClick:()=>f(!1),className:"p-2 hover:bg-gray-100 rounded-xl transition-all",children:e.jsx(ee,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("form",{onSubmit:L,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"bg-emerald-50/50 p-4 rounded-2xl border border-emerald-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-emerald-600 uppercase tracking-widest mb-1",children:"Max Available"}),e.jsxs("p",{className:"text-2xl font-black text-emerald-700",children:["$",p.toFixed(2)]})]}),e.jsx(oe,{className:"w-8 h-8 text-emerald-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2 ml-1",children:"Amount to Withdraw (USD)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.01",required:!0,value:q,onChange:h=>B(h.target.value),placeholder:"0.00",className:"w-full pl-10 pr-4 py-3 bg-white border border-gray-200 rounded-2xl text-lg font-black focus:ring-4 focus:ring-emerald-500/10 focus:border-emerald-500 outline-none transition-all"}),e.jsx(ce,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2 ml-1",children:"Automatic Gateway"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[E.map(h=>e.jsxs("button",{type:"button",onClick:()=>g(h.gateway_name),className:`flex items-center justify-between p-4 rounded-2xl border-2 transition-all ${i===h.gateway_name?"border-emerald-600 bg-emerald-50/50":"border-gray-100 hover:border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${i===h.gateway_name?"bg-emerald-600 text-white":"bg-gray-100 text-gray-400"}`,children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-bold text-sm text-gray-900",children:h.gateway_name})]}),i===h.gateway_name&&e.jsx("div",{className:"w-2 h-2 bg-emerald-600 rounded-full animate-pulse"})]},h.id)),E.length===0&&e.jsx("div",{className:"p-4 bg-gray-50 border border-gray-100 rounded-2xl text-center",children:e.jsx("p",{className:"text-xs text-gray-400",children:"No payment gateways configured."})})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsxs("button",{type:"submit",disabled:u||!q||!i,className:"w-full flex items-center justify-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white text-sm font-black py-4 rounded-2xl transition-all disabled:opacity-50 shadow-xl shadow-emerald-600/20 active:scale-95 uppercase tracking-widest",children:[e.jsx(pe,{className:"w-4 h-4"}),u?"Processing...":"Request Withdrawal"]}),e.jsx("p",{className:"text-[10px] text-gray-400 text-center mt-4",children:"Transactions include a 2.0% platform processing fee."})]})]})]})}),A&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-3xl shadow-2xl overflow-hidden animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"p-6 border-b border-gray-50 flex items-center justify-between bg-gray-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-900 rounded-xl flex items-center justify-center shadow-lg shadow-slate-900/20 text-white",children:e.jsx($e,{className:"w-5 h-5"})}),e.jsx("h3",{className:"text-lg font-black text-gray-900 uppercase tracking-tight",children:"Withdrawal History"})]}),e.jsx("button",{onClick:()=>I(!1),className:"p-2 hover:bg-gray-100 rounded-xl transition-all",children:e.jsx(ee,{className:"w-5 h-5 text-gray-400"})})]}),e.jsx("div",{className:"p-0 overflow-hidden",children:e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-gray-50/80 sticky top-0 backdrop-blur-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Gateway"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Amount"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:M.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:4,className:"px-6 py-12 text-center",children:[e.jsx($e,{className:"w-12 h-12 text-gray-100 mx-auto mb-4"}),e.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase tracking-widest",children:"No transaction history found"})]})}):M.map(h=>e.jsxs("tr",{className:"hover:bg-gray-50/50 group transition-all",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("span",{className:"text-xs font-bold text-gray-900 leading-none block",children:new Date(h.requested_at).toLocaleDateString()}),e.jsx("span",{className:"text-[10px] text-gray-400 font-medium",children:new Date(h.requested_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-xs font-black text-gray-600 uppercase tracking-tighter",children:h.payment_method})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"text-sm font-black text-gray-900",children:["$",h.amount.toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-[9px] font-black uppercase tracking-widest ${h.status==="completed"?"bg-green-50 text-green-700":h.status==="pending"?"bg-amber-50 text-amber-700":"bg-red-50 text-red-700"}`,children:h.status})})]},h.id))})]})})}),e.jsxs("div",{className:"p-6 bg-gray-50 border-t border-gray-100 flex justify-between items-center",children:[e.jsxs("span",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:["Showing ",M.length," Transactions"]}),e.jsx("button",{onClick:()=>I(!1),className:"text-xs font-black text-emerald-600 hover:text-emerald-700 uppercase tracking-tight",children:"Close Records"})]})]})}),r.length===0&&!S&&!b&&e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl p-8 text-center shadow-sm",children:[e.jsx(ce,{className:"w-12 h-12 text-gray-100 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-gray-400 font-bold uppercase tracking-widest",children:"No active currencies configured."})]})]})}function Zt(){const{user:r}=se(),[D,R]=a.useState([]),[j,E]=a.useState(0),[x,M]=a.useState(!1),[C,p]=a.useState(!1),v=a.useRef(null);a.useEffect(()=>{if(!r)return;S();const n=m.channel("vendor-notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${r.id}`},_=>{const c=_.new;R(d=>[c,...d]),E(d=>d+1)}).subscribe(),y=_=>{v.current&&!v.current.contains(_.target)&&M(!1)};return document.addEventListener("mousedown",y),()=>{m.removeChannel(n),document.removeEventListener("mousedown",y)}},[r]);const S=async()=>{if(!r)return;p(!0);const{data:n,error:y}=await m.from("notifications").select("*").eq("user_id",r.id).order("created_at",{ascending:!1}).limit(20);!y&&n&&(R(n),E(n.filter(_=>!_.is_read).length)),p(!1)},U=async n=>{R(y=>y.map(_=>_.id===n?{..._,is_read:!0}:_)),E(y=>Math.max(0,y-1)),await m.from("notifications").update({is_read:!0}).eq("id",n)},u=async()=>{R(n=>n.map(y=>({...y,is_read:!0}))),E(0),await m.from("notifications").update({is_read:!0}).eq("user_id",r==null?void 0:r.id).eq("is_read",!1)},P=async(n,y)=>{var c;y.stopPropagation();const _=((c=D.find(d=>d.id===n))==null?void 0:c.is_read)===!1;R(d=>d.filter(k=>k.id!==n)),_&&E(d=>Math.max(0,d-1)),await m.from("notifications").delete().eq("id",n)},b=n=>{switch(n){case"success":return e.jsx(J,{className:"h-5 w-5 text-green-500"});case"warning":return e.jsx(ue,{className:"h-5 w-5 text-amber-500"});case"error":return e.jsx(ue,{className:"h-5 w-5 text-red-500"});default:return e.jsx(Le,{className:"h-5 w-5 text-blue-500"})}};return e.jsxs("div",{className:"relative",ref:v,children:[e.jsxs("button",{onClick:()=>M(!x),className:"relative p-2.5 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-500 dark:text-slate-400 transition-colors",children:[e.jsx(Ze,{className:"w-5 h-5"}),j>0&&e.jsx("span",{className:"absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full ring-2 ring-white dark:ring-slate-900 animate-pulse"})]}),x&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-96 bg-white dark:bg-slate-900 rounded-2xl shadow-xl border border-slate-100 dark:border-slate-800 overflow-hidden z-50 animate-in fade-in slide-in-from-top-2",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-800 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:"Notifications"}),j>0&&e.jsxs("span",{className:"bg-emerald-100 dark:bg-emerald-500/20 text-emerald-600 dark:text-emerald-400 text-xs font-bold px-2 py-0.5 rounded-full",children:[j," new"]})]}),j>0&&e.jsx("button",{onClick:u,className:"text-xs font-bold text-emerald-600 hover:text-emerald-700 dark:text-emerald-400 dark:hover:text-emerald-300 transition-colors",children:"Mark all read"})]}),e.jsx("div",{className:"max-h-[400px] overflow-y-auto custom-scrollbar",children:C&&D.length===0?e.jsxs("div",{className:"p-8 text-center text-slate-400",children:[e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-emerald-500 border-t-transparent rounded-full mx-auto mb-2"}),e.jsx("p",{className:"text-xs",children:"Loading..."})]}):D.length===0?e.jsxs("div",{className:"p-8 text-center text-slate-400",children:[e.jsx(Ze,{className:"w-8 h-8 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm font-medium",children:"No notifications"})]}):e.jsx("div",{className:"divide-y divide-slate-50 dark:divide-slate-800",children:D.map(n=>e.jsx("div",{className:`p-4 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors relative group ${n.is_read?"":"bg-slate-50/50 dark:bg-slate-800/30"}`,onClick:()=>U(n.id),children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"mt-1 shrink-0",children:b(n.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:`text-sm font-semibold ${n.is_read?"text-slate-600 dark:text-slate-400":"text-slate-900 dark:text-white"}`,children:n.title}),e.jsx("span",{className:"text-[10px] text-slate-400 shrink-0 whitespace-nowrap",children:new Date(n.created_at).toLocaleDateString(void 0,{month:"short",day:"numeric"})})]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1 line-clamp-2",children:n.message})]}),e.jsx("button",{onClick:y=>P(n.id,y),className:"opacity-0 group-hover:opacity-100 p-1 text-slate-400 hover:text-red-500 transition-all absolute top-2 right-2 bg-white dark:bg-slate-900 shadow-sm rounded-lg",children:e.jsx(ee,{className:"w-3 h-3"})})]})},n.id))})}),e.jsx("div",{className:"p-2 border-t border-slate-100 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/50 text-center",children:e.jsx(ze,{to:"/notifications",className:"text-xs font-bold text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200 transition-colors",children:"View All Notifications"})})]})]})}const st=[{id:"overview",label:"Dashboard",icon:e.jsx(Ct,{className:"h-5 w-5"}),section:"Main"},{id:"pos",label:"Point of Sale (POS)",icon:e.jsx(Lt,{className:"h-5 w-5"}),section:"Main"},{id:"messages",label:"Customer Messages",icon:e.jsx(Re,{className:"h-5 w-5"}),section:"Main"},{id:"orders",label:"Orders",icon:e.jsx(ge,{className:"h-5 w-5"}),section:"Shop Management"},{id:"products",label:"Products",icon:e.jsx(Te,{className:"h-5 w-5"}),section:"Shop Management"},{id:"wallet",label:"Wallet Management",icon:e.jsx(oe,{className:"h-5 w-5"}),section:"Shop Management"},{id:"refunds",label:"Refunds",icon:e.jsx(ot,{className:"h-5 w-5"}),section:"Shop Management"},{id:"ads",label:"Ads & Marketing",icon:e.jsx(Ee,{className:"h-5 w-5"}),section:"Shop Management"},{id:"reports",label:"Reports & Analytics",icon:e.jsx(Ce,{className:"h-5 w-5"}),section:"Shop Management"},{id:"packages",label:"Vendor Packages",icon:e.jsx(X,{className:"h-5 w-5"}),section:"Shop Management"},{id:"kyc",label:"KYC Verification",icon:e.jsx(dt,{className:"h-5 w-5"}),section:"Configuration"},{id:"settings",label:"Shop Settings",icon:e.jsx(Et,{className:"h-5 w-5"}),section:"Configuration"}];function Xt({children:r,activeTab:D,onTabChange:R,hasPosAccess:j=!1}){var F;const E=st.filter(w=>!(w.id==="pos"&&!j)),x=Array.from(new Set(E.map(w=>w.section))),M=lt(),{signOut:C,profile:p}=se(),{settings:v}=kt(),[S,U]=a.useState(!1),[u,P]=a.useState(()=>localStorage.getItem("vendor-sidebar-collapsed")==="true"),[b,n]=a.useState(!1),[y,_]=a.useState(""),c=a.useRef(null),d=a.useRef(null);a.useEffect(()=>{const w=T=>{c.current&&!c.current.contains(T.target)&&n(!1)};return b&&document.addEventListener("mousedown",w),()=>{document.removeEventListener("mousedown",w)}},[b]),a.useEffect(()=>{localStorage.setItem("vendor-sidebar-collapsed",u.toString())},[u]),a.useLayoutEffect(()=>{const w=d.current;if(w){const T=sessionStorage.getItem("vendorSidebarScroll");T&&(w.scrollTop=parseInt(T,10))}},[]);const[k,s]=a.useState(null);a.useEffect(()=>{p!=null&&p.id&&m.from("vendor_profiles").select("kyc_status").eq("user_id",p.id).maybeSingle().then(({data:w})=>{w&&s(w.kyc_status)})},[p==null?void 0:p.id]);const o=()=>{d.current&&sessionStorage.setItem("vendorSidebarScroll",d.current.scrollTop.toString())},f=async()=>{await C(),M("/login")},I=st.filter(w=>w.label.toLowerCase().includes(y.toLowerCase())||w.section.toLowerCase().includes(y.toLowerCase())).reduce((w,T)=>(w[T.section]||(w[T.section]=[]),w[T.section].push(T),w),{}),q="bg-[#fcfcfc]",B="bg-white",i="bg-white/80",g="border-slate-200",l="text-slate-900",L="text-slate-500",W="hover:bg-slate-50",z="bg-emerald-50 text-emerald-700";return e.jsxs("div",{className:`min-h-screen ${q} font-sans transition-colors duration-300`,children:[e.jsxs("aside",{ref:d,className:`
          fixed top-0 left-0 bottom-0 z-50
          ${u?"w-20":"w-72"}
          ${B} border-r ${g}
          flex flex-col
          transition-all duration-300 ease-in-out
          ${S?"translate-x-0":"-translate-x-full lg:translate-x-0"}
          shadow-xl lg:shadow-none
        `,children:[e.jsxs("div",{className:`
                    h-20 flex items-center ${u?"justify-center":"justify-between px-6"}
                    border-b ${g}
                `,children:[e.jsx("div",{className:"flex items-center gap-3 overflow-hidden",children:e.jsx("div",{className:`shrink-0 transition-all duration-300 ${u?"w-10 h-10":"w-40 h-12"} flex items-center justify-center`,children:e.jsx("img",{src:v.site_logo,alt:v.site_name,className:"w-full h-full object-contain",onError:w=>{w.currentTarget.src="/zimaio_mineral_edition,_no_background_v1.2.png"}})})}),!u&&e.jsx("button",{onClick:()=>U(!1),className:"lg:hidden p-2 text-slate-400 hover:text-slate-600",children:e.jsx(ee,{className:"w-5 h-5"})})]}),e.jsx("nav",{className:"flex-1 overflow-y-auto py-6 px-3 custom-scrollbar",children:x.map(w=>e.jsxs("div",{className:"mb-8",children:[!u&&e.jsx("h3",{className:`text-[10px] font-bold uppercase tracking-widest ${L} mb-3 px-4`,children:w}),e.jsx("div",{className:"space-y-1",children:E.filter(T=>T.section===w).map(T=>{const G=D===T.id;return e.jsxs("button",{onClick:()=>{R(T.id),U(!1),o()},className:`
                          w-full group flex items-center ${u?"justify-center py-3":"px-4 py-3"}
                          rounded-xl transition-all duration-200
                          ${G?z+" font-semibold":`${L} ${W}`}
                          hover:shadow-sm
                        `,title:u?T.label:"",children:[e.jsx("div",{className:`
                          ${G?"":"group-hover:text-slate-800 dark:group-hover:text-slate-200"}
                          transition-colors duration-200
                        `,children:T.icon}),!u&&e.jsx("span",{className:"ml-3 text-sm truncate",children:T.label}),G&&!u&&e.jsx("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-emerald-500"})]},T.id)})})]},w))}),e.jsx("div",{className:`p-4 border-t ${g}`,children:e.jsxs("button",{onClick:()=>P(!u),className:`
              w-full flex items-center ${u?"justify-center":"justify-center gap-3"}
              p-3 rounded-xl
              bg-gray-50 hover:bg-gray-100
              transition-colors duration-200 text-slate-500 hover:text-slate-700
            `,children:[u?e.jsx(Xe,{className:"w-5 h-5"}):e.jsx(At,{className:"w-5 h-5"}),!u&&e.jsx("span",{className:"text-sm font-semibold",children:"Collapse Sidebar"})]})})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-40 lg:hidden transition-opacity",onClick:()=>U(!1)}),e.jsxs("div",{className:`
        min-h-screen flex flex-col
        transition-all duration-300 ease-in-out
        ${u?"lg:pl-20":"lg:pl-72"}
      `,children:[e.jsxs("header",{className:`
          sticky top-0 z-30
          h-20 px-4 sm:px-8
          ${i} backdrop-blur-md
          border-b ${g}
          flex items-center justify-between
        `,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>U(!0),className:`lg:hidden p-2 rounded-xl ${W} text-slate-500`,children:e.jsx(_t,{className:"w-6 h-6"})}),k!=="approved"&&k!=="pending"&&e.jsxs("div",{className:"hidden xl:flex items-center gap-3 px-4 py-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-900/30 rounded-xl animate-in slide-in-from-left-4 duration-500",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center text-blue-600 dark:text-blue-500",children:e.jsx(dt,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-blue-800 dark:text-blue-400 leading-none",children:"KYC Required"}),e.jsx("p",{className:"text-[9px] font-bold text-blue-700/70 dark:text-blue-500/70 mt-1",children:"Submit documents for full access"})]}),e.jsx("button",{onClick:()=>R("kyc"),className:"ml-2 text-[9px] font-black bg-blue-800 text-white px-3 py-1.5 rounded-lg hover:bg-blue-900 transition-all uppercase tracking-widest active:scale-95",children:"Verify"})]}),e.jsxs("div",{className:"relative",ref:c,children:[e.jsxs("button",{onClick:()=>{n(!b),b||_("")},className:`hidden md:flex items-center gap-2 px-4 py-2.5 rounded-xl bg-emerald-600 dark:bg-emerald-500 text-white hover:bg-emerald-700 dark:hover:bg-emerald-600 transition-all border border-transparent group shadow-lg shadow-emerald-500/20 active:scale-95 ${b?"ring-2 ring-white/50 border-white":""}`,children:[e.jsx(ct,{className:`w-4 h-4 transition-colors ${b?"text-white":"text-white/80 group-hover:text-white"}`}),e.jsx("span",{className:"text-sm font-bold",children:"Quick Actions"}),e.jsx("span",{className:"ml-2 text-[10px] font-mono bg-white/20 px-1.5 py-0.5 rounded text-white/90",children:"âŒ˜K"})]}),b&&e.jsxs("div",{className:"absolute top-full left-0 mt-2 w-80 max-h-[600px] bg-white dark:bg-slate-800 rounded-xl shadow-xl border border-slate-200 dark:border-slate-700 overflow-hidden z-50 animate-in fade-in slide-in-from-top-2",children:[e.jsx("div",{className:"p-3 border-b border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 sticky top-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{autoFocus:!0,type:"text",placeholder:"Search modules...",className:"w-full pl-9 pr-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-emerald-500/50 transition-all",value:y,onChange:w=>_(w.target.value)})]})}),e.jsx("div",{className:"overflow-y-auto max-h-[500px] p-2 custom-scrollbar",children:Object.keys(I).length===0?e.jsx("div",{className:"text-center py-8 text-slate-500",children:e.jsx("p",{className:"text-xs",children:"No matching modules found."})}):Object.entries(I).map(([w,T])=>e.jsxs("div",{className:"mb-4 last:mb-0",children:[e.jsx("h4",{className:"px-2 mb-1.5 text-[10px] font-bold uppercase tracking-wider text-slate-400",children:w}),e.jsx("div",{className:"space-y-0.5",children:T.map(G=>e.jsxs("button",{onClick:()=>{R(G.id),n(!1)},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 text-slate-700 dark:text-slate-300 hover:text-emerald-700 dark:hover:text-emerald-400 transition-colors group",children:[G.icon,e.jsx("span",{className:"text-sm font-medium",children:G.label}),y&&e.jsx(Xe,{className:"w-3 h-3 ml-auto text-slate-300 group-hover:text-emerald-500"})]},G.id))})]},w))})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx(Zt,{}),e.jsxs(ze,{to:"/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-bold text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 transition-all shadow-lg shadow-blue-500/20 border border-transparent active:scale-95",children:[e.jsx(Rt,{className:"w-4 h-4"}),e.jsx("span",{children:"View Site"})]}),e.jsx("div",{className:"h-8 w-[1px] bg-slate-200 mx-1"}),e.jsxs("div",{className:"flex items-center gap-3 pl-1",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:`text-sm font-bold ${l} leading-none`,children:(p==null?void 0:p.full_name)||"Vendor"}),e.jsx("p",{className:`text-xs ${L} mt-0.5`,children:p==null?void 0:p.email})]}),e.jsxs("div",{className:"relative group cursor-pointer",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-tr from-emerald-600 to-green-600 p-[2px]",children:e.jsx("div",{className:`w-full h-full rounded-[10px] ${B} flex items-center justify-center`,children:e.jsx("span",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-tr from-emerald-600 to-green-600",children:((F=p==null?void 0:p.full_name)==null?void 0:F.charAt(0))||"V"})})}),e.jsx("div",{className:`
                    absolute right-0 top-full mt-2 w-48 py-2 rounded-xl shadow-xl
                    ${B} border ${g}
                    opacity-0 invisible group-hover:opacity-100 group-hover:visible
                    transform translate-y-2 group-hover:translate-y-0
                    transition-all duration-200
                  `,children:e.jsxs("button",{onClick:f,className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[e.jsx(St,{className:"w-4 h-4"}),"Sign Out"]})})]})]})]})]}),e.jsx("main",{className:"flex-1 p-6 lg:p-10 overflow-x-hidden",children:e.jsx("div",{className:"max-w-[1600px] mx-auto animate-fadeIn",children:r})})]})]})}function Jt(){const{user:r}=se(),[D,R]=a.useState(""),[j,E]=a.useState(""),[x,M]=a.useState(""),[C,p]=a.useState(""),[v,S]=a.useState(""),[U,u]=a.useState(""),[P,b]=a.useState("USD"),[n,y]=a.useState(!1),[_,c]=a.useState(!1),[d,k]=a.useState(!1),[s,o]=a.useState(null);a.useEffect(()=>{f()},[r]);const f=async()=>{if(!r)return;const{data:i}=await m.from("vendor_profiles").select("shop_name, shop_description, shop_logo_url, shop_banner_url").eq("user_id",r.id).single();i&&(M(i.shop_name||""),p(i.shop_description||""),S(i.shop_logo_url||""),u(i.shop_banner_url||""));const{data:g}=await m.from("profiles").select("currency_code").eq("id",r.id).single();g&&b(g.currency_code||"USD")},A=async(i,g)=>{var W;const l=(W=i.target.files)==null?void 0:W[0];if(!l||!r)return;const L=g==="logo";L?c(!0):k(!0),o(null);try{const z=l.name.split(".").pop(),V=`${r.id}/${g}-${Math.random()}.${z}`,{error:h}=await m.storage.from("shop-assets").upload(V,l);if(h)throw h;const{data:{publicUrl:F}}=m.storage.from("shop-assets").getPublicUrl(V);L?S(F):u(F),o({type:"success",text:`${g==="logo"?"Logo":"Banner"} uploaded. Remember to save changes.`})}catch(z){o({type:"error",text:z.message})}finally{L?c(!1):k(!1)}},I=async i=>{i.preventDefault(),y(!0),o(null);try{const{error:g}=await m.from("vendor_profiles").update({shop_name:x,shop_description:C,shop_logo_url:v,shop_banner_url:U}).eq("user_id",r==null?void 0:r.id);if(g)throw g;const{error:l}=await m.from("profiles").update({currency_code:P}).eq("id",r==null?void 0:r.id);if(l)throw l;o({type:"success",text:"Financial and shop settings updated successfully."})}catch(g){o({type:"error",text:g.message})}finally{y(!1)}},q=async i=>{i.preventDefault(),y(!0),o(null);try{const{error:g}=await m.auth.updateUser({email:D});if(g)throw g;o({type:"success",text:"Confirmation link sent to your new email."})}catch(g){o({type:"error",text:g.message})}finally{y(!1)}},B=async i=>{i.preventDefault(),y(!0),o(null);try{const{error:g}=await m.auth.updateUser({password:j});if(g)throw g;o({type:"success",text:"Password updated successfully."}),E("")}catch(g){o({type:"error",text:g.message})}finally{y(!1)}};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Manage your shop profile and account security."})]}),s&&e.jsxs("div",{className:`p-3 rounded-lg flex items-center gap-2 text-sm ${s.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:[s.type==="success"?e.jsx(J,{className:"w-4 h-4"}):e.jsx(ne,{className:"w-4 h-4"}),s.text]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"bg-emerald-50 p-2 rounded-lg",children:e.jsx(he,{className:"w-4 h-4 text-emerald-600"})}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"Shop Details"})]}),e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5",children:"Shop Name"}),e.jsx("input",{type:"text",required:!0,value:x,onChange:i=>M(i.target.value),className:"w-full px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all",placeholder:"My Awesome Shop"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5",children:"Description"}),e.jsx("textarea",{rows:3,value:C,onChange:i=>p(i.target.value),className:"w-full px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all resize-none",placeholder:"Brief description of your shop..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5 text-emerald-600 uppercase tracking-widest",children:"Shop Logo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-20 h-20 rounded-2xl border-2 border-dashed border-gray-200 bg-gray-50 flex items-center justify-center overflow-hidden group hover:border-emerald-500 transition-colors relative",children:[v?e.jsx("img",{src:v,className:"w-full h-full object-cover"}):e.jsx(Ue,{className:"w-6 h-6 text-gray-300 group-hover:text-emerald-500 transition-colors"}),_&&e.jsx("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center",children:e.jsx("div",{className:"w-5 h-5 border-2 border-emerald-600 border-t-transparent rounded-full animate-spin"})})]}),e.jsxs("label",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer bg-white border border-gray-200 hover:border-emerald-500 px-4 py-2.5 rounded-xl text-sm font-bold text-gray-600 hover:text-emerald-600 shadow-sm transition-all active:scale-95",children:[e.jsx(be,{className:"w-4 h-4"}),_?"Uploading...":"Change Logo"]}),e.jsx("input",{type:"file",accept:"image/*",onChange:i=>A(i,"logo"),disabled:_,className:"hidden"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5 text-emerald-600 uppercase tracking-widest",children:"Shop Banner"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-20 h-20 rounded-2xl border-2 border-dashed border-gray-200 bg-gray-50 flex items-center justify-center overflow-hidden group hover:border-emerald-500 transition-colors relative",children:[U?e.jsx("img",{src:U,className:"w-full h-full object-cover"}):e.jsx(Ue,{className:"w-6 h-6 text-gray-300 group-hover:text-emerald-500 transition-colors"}),d&&e.jsx("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center",children:e.jsx("div",{className:"w-5 h-5 border-2 border-emerald-600 border-t-transparent rounded-full animate-spin"})})]}),e.jsxs("label",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer bg-white border border-gray-200 hover:border-emerald-500 px-4 py-2.5 rounded-xl text-sm font-bold text-gray-600 hover:text-emerald-600 shadow-sm transition-all active:scale-95",children:[e.jsx(be,{className:"w-4 h-4"}),d?"Uploading...":"Change Banner"]}),e.jsx("input",{type:"file",accept:"image/*",onChange:i=>A(i,"banner"),disabled:d,className:"hidden"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsxs("button",{type:"submit",disabled:n,className:"flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white text-sm font-medium px-4 py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(pe,{className:"w-3.5 h-3.5"}),n?"Saving...":"Save Settings"]})})]})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"bg-cyan-50 p-2 rounded-lg",children:e.jsx(ce,{className:"w-4 h-4 text-cyan-600"})}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"Financial Settings"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5 uppercase tracking-widest",children:"Withdrawal & Payout Currency"}),e.jsx("p",{className:"text-[10px] text-gray-400 mb-3 font-bold uppercase tracking-widest leading-relaxed",children:"Select how you want to receive your profits and view your primary balances."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>b("USD"),className:`px-6 py-4 rounded-xl border-2 transition-all flex items-center justify-between ${P==="USD"?"border-cyan-500 bg-cyan-50/50 text-cyan-700":"border-gray-50 bg-gray-50/50 text-gray-400 opacity-50"}`,children:[e.jsxs("div",{className:"text-left font-black uppercase text-xs tracking-widest",children:["United States Dollar",e.jsx("p",{className:"font-bold text-[9px] opacity-60 mt-0.5",children:"International Standard (USD)"})]}),P==="USD"&&e.jsx(J,{size:16})]}),e.jsxs("button",{onClick:()=>b("ZIG"),className:`px-6 py-4 rounded-xl border-2 transition-all flex items-center justify-between ${P==="ZIG"?"border-amber-500 bg-amber-50/50 text-amber-700":"border-gray-50 bg-gray-50/50 text-gray-400 opacity-50"}`,children:[e.jsxs("div",{className:"text-left font-black uppercase text-xs tracking-widest",children:["Zimbabwe Gold",e.jsx("p",{className:"font-bold text-[9px] opacity-60 mt-0.5",children:"Local Stable (ZIG)"})]}),P==="ZIG"&&e.jsx(J,{size:16})]})]})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"bg-blue-50 p-2 rounded-lg",children:e.jsx(Dt,{className:"w-4 h-4 text-blue-600"})}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"Update Email"})]}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5",children:"Current Email"}),e.jsx("input",{type:"text",value:(r==null?void 0:r.email)||"",disabled:!0,className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-500 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5",children:"New Email"}),e.jsx("input",{type:"email",required:!0,value:D,onChange:i=>R(i.target.value),className:"w-full px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",placeholder:"new@example.com"})]}),e.jsxs("button",{type:"submit",disabled:n||!D,className:"w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed mt-2",children:[e.jsx(pe,{className:"w-3.5 h-3.5"}),n?"Updating...":"Update Email"]})]})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"bg-purple-50 p-2 rounded-lg",children:e.jsx(Ut,{className:"w-4 h-4 text-purple-600"})}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"Change Password"})]}),e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5",children:"New Password"}),e.jsx("input",{type:"password",required:!0,minLength:6,value:j,onChange:i=>E(i.target.value),className:"w-full px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 outline-none transition-all",placeholder:"Min 6 chars"})]}),e.jsxs("div",{className:"pt-[52px]",children:[" ",e.jsxs("button",{type:"submit",disabled:n||!j,className:"w-full flex items-center justify-center gap-2 bg-purple-600 hover:bg-purple-700 text-white text-sm font-medium py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(pe,{className:"w-3.5 h-3.5"}),n?"Updating...":"Update Password"]})]})]})]})]})]})}function es(){var Qe;a.useEffect(()=>{console.log("VendorProductManagement MOUNTED")},[]);const[r,D]=nt(),[R,j]=a.useState([]),[E,x]=a.useState([]),[M,C]=a.useState([]),[p,v]=a.useState(!0),[S,U]=a.useState(""),[u,P]=a.useState("all"),[b,n]=a.useState("all"),[y,_]=a.useState("all"),[c,d]=a.useState("table"),[k,s]=a.useState(null),[o,f]=a.useState(null),[A,I]=a.useState(!1),[q,B]=a.useState(!1),[i,g]=a.useState({name:"",base_price:"",stock_quantity:"",category_id:"",brand_id:"",is_featured:!1,sku:"",description:"",images:[],attributes:{colors:[]}}),[l,L]=a.useState(null),[W,z]=a.useState(!1),[V,h]=a.useState(!1),[F,w]=a.useState(!1),[T,G]=a.useState(""),[Q,ae]=a.useState("");a.useEffect(()=>{if(ft(),r.get("add")==="true"){I(!0);const t=new URLSearchParams(r);t.delete("add"),D(t)}},[]);const re=async(t,N)=>{const $=t.target.files;if(!(!$||$.length===0)){if(!o){s({type:"error",text:"Error: Vendor profile not found. Please refresh the page."});return}w(!0);try{const O=Array.from($);for(const K of O){const Y=URL.createObjectURL(K);N?L(H=>H?{...H,images:[...H.images||[],Y].slice(0,5)}:null):g(H=>({...H,images:[...H.images||[],Y].slice(0,5)}));const De=K.name.split(".").pop()||"jpg",me=`${o}/${Date.now()}-${Math.random().toString(36).substring(2,7)}.${De}`,{error:je}=await m.storage.from("product-images").upload(me,K,{cacheControl:"3600",upsert:!1});if(je){console.error("SUPABASE STORAGE ERROR:",je),console.error("Bucket: product-images, Path:",me),N?L(Z=>{if(!Z)return null;const qe=(Z.images||[]).filter(Nt=>Nt!==Y);return{...Z,images:qe}}):g(Z=>({...Z,images:(Z.images||[]).filter(qe=>qe!==Y)}));const H=je.message||JSON.stringify(je);throw new Error(`Upload precision failed: ${H}`)}const{data:Pe}=m.storage.from("product-images").getPublicUrl(me),we=Pe==null?void 0:Pe.publicUrl;if(!we)throw new Error("Failed to generate public URL for uploaded image");N?L(H=>H?{...H,images:(H.images||[]).map(Z=>Z===Y?we:Z)}:null):g(H=>({...H,images:H.images.map(Z=>Z===Y?we:Z)})),console.log("Image uploaded successfully:",we)}}catch(O){console.error("Final Image upload error:",O),s({type:"error",text:O.message||"Image upload failed"})}finally{w(!1),t.target.value=""}}},xe=(t,N)=>{N&&l?L({...l,images:l.images.filter(($,O)=>O!==t)}):g({...i,images:i.images.filter(($,O)=>O!==t)})},le=t=>{if(!t)return"";const N=t.split(" ").map(O=>O.substring(0,3).toUpperCase()).join("-").replace(/[^\w-]/g,""),$=Math.random().toString(36).substring(2,6).toUpperCase();return`${N}-${$}`},ft=async()=>{var t;v(!0);try{const{data:{user:N}}=await m.auth.getUser();if(!N)return;const[$,O,K,Y]=await Promise.all([m.from("products").select("*, category:categories(name)").order("created_at",{ascending:!1}),m.from("categories").select("id, name").eq("is_active",!0),m.from("brands").select("id, name").eq("is_active",!0),m.from("vendor_profiles").select("id").eq("user_id",N.id).single()]);if(Y.data){f(Y.data.id);const De=((t=$.data)==null?void 0:t.filter(me=>me.vendor_id===Y.data.id))||[];j(De)}x(O.data||[]),C(K.data||[])}catch(N){console.error("Error fetching products:",N)}finally{v(!1)}},yt=async t=>{if(t.preventDefault(),!!o){B(!0);try{const N=i.name.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),{data:$,error:O}=await m.from("products").insert([{...i,base_price:parseFloat(i.base_price),stock_quantity:parseInt(i.stock_quantity),vendor_id:o,brand_id:i.brand_id||null,is_featured:i.is_featured,slug:N,is_active:!0}]).select("*, category:categories(name)").single();if(O)throw O;j(K=>[$,...K]),I(!1),g({name:"",base_price:"",stock_quantity:"",category_id:"",brand_id:"",is_featured:!1,sku:"",description:"",images:[],attributes:{colors:[]}}),h(!1),s({type:"success",text:"Product added successfully!"})}catch(N){s({type:"error",text:N.message})}finally{B(!1)}}},jt=async t=>{if(t.preventDefault(),!!l){B(!0);try{const N=l.name.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),{data:$,error:O}=await m.from("products").update({name:l.name,base_price:parseFloat(l.base_price),stock_quantity:parseInt(l.stock_quantity),category_id:l.category_id,brand_id:l.brand_id||null,is_featured:l.is_featured,sku:l.sku,slug:N,description:l.description,images:l.images,attributes:l.attributes||{colors:[]}}).eq("id",l.id).select("*, category:categories(name)").single();if(O)throw O;j(K=>K.map(Y=>Y.id===$.id?$:Y)),z(!1),L(null),s({type:"success",text:"Product updated successfully!"})}catch(N){s({type:"error",text:N.message})}finally{B(!1)}}},wt=async(t,N)=>{try{const{error:$}=await m.from("products").update({is_active:!N}).eq("id",t);if($)throw $;j(O=>O.map(K=>K.id===t?{...K,is_active:!N}:K)),s({type:"success",text:`Product ${N?"deactivated":"activated"} successfully.`})}catch($){s({type:"error",text:$.message})}},We=async(t,N)=>{try{if(N<0)return;const{error:$}=await m.from("products").update({stock_quantity:N}).eq("id",t);if($)throw $;j(O=>O.map(K=>K.id===t?{...K,stock_quantity:N}:K)),s({type:"success",text:"Stock updated successfully."})}catch($){s({type:"error",text:$.message})}},Ke=async t=>{if(confirm("Are you sure you want to delete this product?"))try{const{error:N}=await m.from("products").delete().eq("id",t);if(N)throw N;j($=>$.filter(O=>O.id!==t)),s({type:"success",text:"Product deleted successfully."})}catch(N){s({type:"error",text:N.message})}},fe=t=>{var N,$;if(!(!Q||!Q.startsWith("#"))){if(t==="add"){const O=((N=i.attributes)==null?void 0:N.colors)||[];O.includes(Q)||g({...i,attributes:{...i.attributes,colors:[...O,Q]}})}else{const O=(($=l.attributes)==null?void 0:$.colors)||[];O.includes(Q)||L({...l,attributes:{...l.attributes,colors:[...O,Q]}})}ae("")}},Ge=(t,N)=>{var $,O;if(N==="add"){const K=(($=i.attributes)==null?void 0:$.colors)||[];g({...i,attributes:{...i.attributes,colors:K.filter(Y=>Y!==t)}})}else{const K=((O=l.attributes)==null?void 0:O.colors)||[];L({...l,attributes:{...l.attributes,colors:K.filter(Y=>Y!==t)}})}},Ye=t=>{L({...t,images:Array.isArray(t.images)?t.images:[],base_price:t.base_price.toString(),stock_quantity:t.stock_quantity.toString(),brand_id:t.brand_id||"",is_featured:t.is_featured||!1,attributes:t.attributes||{colors:[]}}),z(!0)},ye=R.filter(t=>{var Y;const N=t.name.toLowerCase().includes(S.toLowerCase())||(((Y=t.sku)==null?void 0:Y.toLowerCase())||"").includes(S.toLowerCase()),$=u==="all"||u==="active"&&t.is_active||u==="inactive"&&!t.is_active,O=b==="all"||b==="low"&&t.stock_quantity>0&&t.stock_quantity<=10||b==="out"&&t.stock_quantity===0,K=y==="all"||t.category_id===y;return N&&$&&O&&K}),He=t=>t===0?{label:"Out of Stock",color:"text-red-600 bg-red-50 border-red-100",icon:e.jsx(te,{className:"w-3 h-3"})}:t<=10?{label:"Low Stock",color:"text-amber-600 bg-amber-50 border-amber-100",icon:e.jsx(ue,{className:"w-3 h-3"})}:{label:"In Stock",color:"text-emerald-600 bg-emerald-50 border-emerald-100",icon:e.jsx(J,{className:"w-3 h-3"})};return p?e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"}),e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Loading your inventory..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Product Management"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Manage your shop inventory, stock levels and visibility."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"bg-white p-1 rounded-xl border border-gray-200 flex shadow-sm",children:[e.jsx("button",{onClick:()=>d("table"),className:`p-2 rounded-lg transition-all ${c==="table"?"bg-emerald-50 text-emerald-600":"text-gray-400 hover:text-gray-600"}`,children:e.jsx(It,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>d("grid"),className:`p-2 rounded-lg transition-all ${c==="grid"?"bg-emerald-50 text-emerald-600":"text-gray-400 hover:text-gray-600"}`,children:e.jsx(et,{className:"w-4 h-4"})})]}),e.jsxs("button",{onClick:()=>I(!0),className:"flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2.5 rounded-xl text-sm font-bold transition-all shadow-lg shadow-emerald-600/20 active:scale-95",children:[e.jsx(_e,{className:"w-4 h-4"}),"Add Product"]})]})]}),k&&e.jsxs("div",{className:`p-3 rounded-xl flex items-center gap-3 text-sm font-medium animate-in fade-in slide-in-from-top-2 ${k.type==="success"?"bg-green-50 text-green-700 border border-green-100":"bg-red-50 text-red-700 border border-red-100"}`,children:[k.type==="success"?e.jsx(J,{className:"w-4 h-4"}):e.jsx(ue,{className:"w-4 h-4"}),k.text,e.jsx("button",{onClick:()=>s(null),className:"ml-auto text-gray-400 hover:text-gray-600",children:e.jsx(Ft,{className:"w-4 h-4 rotate-90"})})]}),e.jsx("div",{className:"bg-white border border-gray-100 rounded-2xl p-4 shadow-sm space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1 group",children:[e.jsx(ie,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 group-focus-within:text-emerald-500 transition-colors"}),e.jsx("input",{type:"text",placeholder:"Search by product name, SKU...",value:S,onChange:t=>U(t.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 border border-transparent rounded-xl text-sm focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"relative group",children:[e.jsx(xt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400"}),e.jsxs("select",{value:u,onChange:t=>P(t.target.value),className:"pl-8 pr-10 py-2.5 bg-gray-50 border border-transparent rounded-xl text-sm font-medium focus:bg-white focus:border-emerald-500 outline-none transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsx(ve,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(X,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400"}),e.jsxs("select",{value:b,onChange:t=>n(t.target.value),className:"pl-8 pr-10 py-2.5 bg-gray-50 border border-transparent rounded-xl text-sm font-medium focus:bg-white focus:border-emerald-500 outline-none transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"Stock Levels"}),e.jsx("option",{value:"low",children:"Low Stock"}),e.jsx("option",{value:"out",children:"Out of Stock"})]}),e.jsx(ve,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(et,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400"}),e.jsxs("select",{value:y,onChange:t=>_(t.target.value),className:"pl-8 pr-10 py-2.5 bg-gray-50 border border-transparent rounded-xl text-sm font-medium focus:bg-white focus:border-emerald-500 outline-none transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"Categories"}),E.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(ve,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]}),(S||u!=="all"||b!=="all"||y!=="all")&&e.jsx("button",{onClick:()=>{U(""),P("all"),n("all"),_("all")},className:"text-xs font-bold text-red-500 hover:text-red-600 transition-colors uppercase tracking-widest px-2",children:"Reset"})]})]})}),c==="table"?e.jsx("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50/50 border-b border-gray-100",children:[e.jsx("th",{className:"px-4 py-2.5 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Product"}),e.jsx("th",{className:"px-4 py-2.5 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Category"}),e.jsx("th",{className:"px-4 py-2.5 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Price"}),e.jsx("th",{className:"px-4 py-2.5 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Stock"}),e.jsx("th",{className:"px-4 py-2.5 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Status"}),e.jsx("th",{className:"px-4 py-2.5 text-[10px] font-black text-gray-400 uppercase tracking-widest text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:ye.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-20 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center",children:e.jsx(X,{className:"w-8 h-8 text-gray-200"})}),e.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"No products found matching your criteria"})]})})}):ye.map(t=>{var $,O;const N=He(t.stock_quantity);return e.jsxs("tr",{className:"hover:bg-gray-50/30 group transition-all",children:[e.jsx("td",{className:"px-4 py-2.5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg overflow-hidden shadow-sm shrink-0",children:($=t.images)!=null&&$[0]?e.jsx("img",{src:t.images[0],alt:t.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(X,{className:"w-5 h-5 text-gray-300"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-black text-gray-900 leading-none group-hover:text-emerald-600 transition-colors uppercase tracking-tight line-clamp-1",children:t.name}),e.jsxs("p",{className:"text-[10px] text-gray-400 font-bold mt-0.5 uppercase tracking-tighter",children:["SKU: ",t.sku||"N/A"]})]})]})}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsx("span",{className:"text-[10px] font-black text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full uppercase tracking-widest truncate max-w-[100px] inline-block",children:((O=t.category)==null?void 0:O.name)||"Uncategorized"})}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsxs("span",{className:"text-xs font-black text-gray-900",children:["$",t.base_price.toFixed(2)]})}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-black text-gray-900",children:t.stock_quantity}),e.jsxs("div",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded-full border text-[9px] font-black uppercase tracking-widest ${N.color}`,children:[N.icon,N.label]})]}),e.jsxs("div",{className:"flex gap-1 group-hover:opacity-100 opacity-50 transition-opacity",children:[e.jsx("button",{onClick:()=>We(t.id,t.stock_quantity-1),className:"w-5 h-5 border border-gray-200 rounded flex items-center justify-center hover:bg-red-50 hover:text-red-500 hover:border-red-200 transition-all text-xs",children:"-"}),e.jsx("button",{onClick:()=>We(t.id,t.stock_quantity+1),className:"w-5 h-5 border border-gray-200 rounded flex items-center justify-center hover:bg-emerald-50 hover:text-emerald-500 hover:border-emerald-200 transition-all text-xs",children:"+"})]})]})}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsxs("button",{onClick:()=>wt(t.id,t.is_active),className:`flex items-center gap-1.5 px-2 py-1 rounded-lg transition-all ${t.is_active?"bg-emerald-50 text-emerald-600 hover:bg-emerald-100":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,children:[t.is_active?e.jsx(Se,{className:"w-3 h-3"}):e.jsx(Je,{className:"w-3 h-3"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:t.is_active?"Active":"Inactive"})]})}),e.jsx("td",{className:"px-4 py-2.5 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx("button",{onClick:()=>Ye(t),className:"p-1.5 text-gray-400 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-all",title:"Edit Product",children:e.jsx(Ie,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>Ke(t.id),className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all",title:"Delete Product",children:e.jsx(Oe,{className:"w-3.5 h-3.5"})})]})})]},t.id)})})]})})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:ye.length===0?e.jsxs("div",{className:"col-span-full py-20 text-center bg-white rounded-2xl border border-gray-100",children:[e.jsx(X,{className:"w-12 h-12 text-gray-100 mx-auto mb-4"}),e.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase tracking-widest",children:"No products found"})]}):ye.map(t=>{var $,O;const N=He(t.stock_quantity);return e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl overflow-hidden shadow-sm hover:shadow-xl hover:shadow-gray-100 transition-all group",children:[e.jsxs("div",{className:"h-48 relative overflow-hidden bg-gray-50",children:[($=t.images)!=null&&$[0]?e.jsx("img",{src:t.images[0],alt:t.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(X,{className:"w-12 h-12 text-gray-200"})}),e.jsxs("div",{className:"absolute top-3 left-3 flex flex-col gap-2",children:[e.jsxs("div",{className:`flex items-center gap-1.5 px-2.5 py-1 rounded-full border text-[9px] font-black uppercase tracking-widest shadow-sm backdrop-blur-md ${N.color} border-opacity-50`,children:[N.icon,N.label]}),e.jsxs("div",{className:`flex items-center gap-1.5 px-2.5 py-1 rounded-full border text-[9px] font-black uppercase tracking-widest shadow-sm backdrop-blur-md border-opacity-50 ${t.is_active?"bg-emerald-50/80 text-emerald-600 border-emerald-100":"bg-gray-100/80 text-gray-400 border-gray-200"}`,children:[t.is_active?e.jsx(Se,{className:"w-3 h-3"}):e.jsx(Je,{className:"w-3 h-3"}),t.is_active?"Visible":"Hidden"]})]})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-emerald-600 uppercase tracking-widest mb-1",children:((O=t.category)==null?void 0:O.name)||"Uncategorized"}),e.jsx("h4",{className:"text-sm font-black text-gray-900 uppercase tracking-tight line-clamp-1",children:t.name})]}),e.jsxs("p",{className:"text-lg font-black text-gray-900 leading-none",children:["$",t.base_price]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 mt-4 border-t border-gray-50",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:["STOCK: ",t.stock_quantity]})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>Ye(t),className:"p-2 text-gray-400 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-all",children:e.jsx(Ie,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>Ke(t.id),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all",children:e.jsx(Oe,{className:"w-3.5 h-3.5"})})]})]})]})]},t.id)})}),R.some(t=>t.stock_quantity>0&&t.stock_quantity<=10)&&e.jsxs("div",{className:"bg-amber-50 border border-amber-100 rounded-2xl p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center",children:e.jsx(ue,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-amber-900 uppercase tracking-tight",children:"Low Stock Alert"}),e.jsx("p",{className:"text-xs text-amber-700 font-medium",children:"Some of your products are running low. Consider restocking soon to avoid lost sales."})]})]}),e.jsx("button",{onClick:()=>n("low"),className:"text-xs font-black text-amber-600 hover:text-amber-700 uppercase tracking-widest px-4 py-2 bg-white rounded-xl shadow-sm border border-amber-200 transition-all hover:shadow-md",children:"Review Items"})]}),A&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[24px] shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200 flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b border-gray-50 flex items-center justify-between bg-gray-50/50 shrink-0",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-black text-gray-900 uppercase tracking-tight",children:"Add New Product"}),e.jsx("p",{className:"text-[9px] text-gray-400 font-bold uppercase tracking-wider",children:"List a new item in your store inventory"})]}),e.jsx("button",{onClick:()=>I(!1),className:"p-1.5 hover:bg-gray-100 rounded-lg transition-all",children:e.jsx(te,{className:"w-5 h-5 text-gray-300"})})]}),e.jsxs("form",{onSubmit:yt,className:"flex flex-col overflow-hidden",children:[e.jsx("div",{className:"p-5 overflow-y-auto space-y-3 custom-scrollbar",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Name *"}),e.jsx("input",{required:!0,type:"text",value:i.name,onChange:t=>{const N=t.target.value;g($=>({...$,name:N,sku:V?$.sku:le(N)}))},className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all",placeholder:"e.g. Wireless Headphones"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"SKU (Auto-generated)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:i.sku,onChange:t=>{g({...i,sku:t.target.value}),h(!0)},className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all font-mono",placeholder:"WH-001"}),e.jsx("button",{type:"button",onClick:()=>{g({...i,sku:le(i.name)}),h(!1)},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 text-emerald-600 hover:bg-emerald-50 rounded-lg transition-all",title:"Regenerate SKU",children:e.jsx(_e,{className:"w-3.5 h-3.5 rotate-45"})})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Base Price ($) *"}),e.jsx("input",{required:!0,type:"number",step:"0.01",value:i.base_price,onChange:t=>g({...i,base_price:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all",placeholder:"29.99"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Stock Quantity *"}),e.jsx("input",{required:!0,type:"number",value:i.stock_quantity,onChange:t=>g({...i,stock_quantity:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all",placeholder:"100"})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Category *"}),e.jsxs("div",{className:"relative group",children:[e.jsx(ie,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search category...",className:"pl-7 pr-3 py-1 bg-gray-100 border-none rounded-lg text-[10px] focus:ring-0 w-32 font-bold placeholder:text-gray-300 transition-all focus:w-48",value:T,onChange:t=>G(t.target.value)})]})]}),e.jsxs("select",{required:!0,value:i.category_id,onChange:t=>g({...i,category_id:t.target.value}),className:"w-full px-3 py-2.5 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all appearance-none cursor-pointer font-bold text-gray-700",children:[e.jsx("option",{value:"",children:"Select Category"}),E.filter(t=>t.name.toLowerCase().includes(T.toLowerCase())).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Brand"}),e.jsxs("select",{value:i.brand_id,onChange:t=>g({...i,brand_id:t.target.value}),className:"w-full px-3 py-2.5 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all appearance-none cursor-pointer font-bold text-gray-700",children:[e.jsx("option",{value:"",children:"Select Brand (Optional)"}),M.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"col-span-full space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Description"}),e.jsx("textarea",{rows:3,value:i.description,onChange:t=>g({...i,description:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all resize-none",placeholder:"Tell customers about your product..."})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Colors (Hex codes)"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(i.attributes.colors||[]).map((t,N)=>e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg border border-gray-100 bg-white shadow-sm transition-all hover:border-emerald-200 group",children:[e.jsx("div",{className:"w-3 h-3 rounded-full shadow-inner",style:{backgroundColor:t}}),e.jsx("span",{className:"text-[10px] font-bold text-gray-600 font-mono tracking-tighter",children:t}),e.jsx("button",{type:"button",onClick:()=>Ge(t,"add"),className:"p-0.5 text-gray-400 hover:text-red-500 rounded transition-colors",children:e.jsx(ee,{className:"w-2.5 h-2.5"})})]},N))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1 group",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border border-gray-200",style:{backgroundColor:Q}}),e.jsx("input",{type:"text",value:Q,onChange:t=>ae(t.target.value),onKeyDown:t=>t.key==="Enter"&&(t.preventDefault(),fe("add")),placeholder:"#FF5733",className:"w-full pl-9 pr-4 py-2 bg-gray-50 border border-transparent rounded-xl text-[12px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all font-mono"})]}),e.jsx("button",{type:"button",onClick:()=>fe("add"),className:"px-4 py-2 bg-emerald-600 text-white rounded-xl text-xs font-bold hover:bg-emerald-700 transition-all shadow-lg shadow-emerald-600/10",children:"Add"})]})]}),e.jsx("div",{className:"col-span-full py-2 border-t border-gray-50 mt-2",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group w-fit",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:i.is_featured,onChange:t=>g({...i,is_featured:t.target.checked})}),e.jsx("div",{className:`w-10 h-5 rounded-full transition-all duration-300 ${i.is_featured?"bg-emerald-500 shadow-lg shadow-emerald-200":"bg-gray-200"}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-3 h-3 bg-white rounded-full transition-transform duration-300 ${i.is_featured?"translate-x-5":""}`})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-black text-gray-700 uppercase tracking-widest block leading-none",children:"Featured Product"}),e.jsx("span",{className:"text-[8px] text-gray-400 font-bold uppercase tracking-tighter",children:"Show this in featured products sections"})]})]})}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Images (up to 5)"}),e.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[i.images.map((t,N)=>e.jsxs("div",{className:"relative aspect-square rounded-xl overflow-hidden group border border-gray-100 shadow-sm",children:[e.jsx("img",{src:t,className:"w-full h-full object-cover",alt:""}),e.jsx("button",{type:"button",onClick:()=>xe(N,!1),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(ee,{className:"w-2.5 h-2.5"})})]},N)),i.images.length<5&&e.jsxs("label",{className:"relative aspect-square rounded-xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center gap-1 cursor-pointer hover:border-emerald-500 hover:bg-emerald-50/30 transition-all group",children:[e.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.svg,.webp,.gif",multiple:!0,className:"hidden",onChange:t=>re(t,!1),disabled:F}),F?e.jsx("div",{className:"w-4 h-4 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"w-4 h-4 text-gray-400 group-hover:text-emerald-500 transition-colors"}),e.jsx("span",{className:"text-[8px] font-black text-gray-400 uppercase group-hover:text-emerald-500 transition-colors",children:"Upload"}),e.jsx("span",{className:"text-[7px] text-gray-300 font-bold uppercase mt-0.5",children:"800x800px"})]})]})]})]})]})}),e.jsxs("div",{className:"p-4 bg-gray-50/50 border-t border-gray-50 flex gap-3 shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>I(!1),className:"flex-1 px-4 py-2 bg-white text-gray-500 font-bold rounded-xl hover:bg-gray-100 transition-all uppercase tracking-widest text-[9px] border border-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:q||F,className:"flex-[2] px-4 py-2 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-700 transition-all uppercase tracking-widest text-[9px] shadow-lg shadow-emerald-200 disabled:opacity-50 flex items-center justify-center gap-2",children:q?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Saving..."]}):F?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Uploading Images..."]}):"Create Product"})]})]})]})}),W&&l&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[24px] shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200 flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b border-gray-50 flex items-center justify-between bg-gray-50/50 shrink-0",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-black text-gray-900 uppercase tracking-tight",children:"Edit Product"}),e.jsx("p",{className:"text-[9px] text-gray-400 font-bold uppercase tracking-wider",children:"Update your product information"})]}),e.jsx("button",{onClick:()=>z(!1),className:"p-1.5 hover:bg-gray-100 rounded-lg transition-all",children:e.jsx(te,{className:"w-5 h-5 text-gray-300"})})]}),e.jsxs("form",{onSubmit:jt,className:"flex flex-col overflow-hidden",children:[e.jsx("div",{className:"p-5 overflow-y-auto space-y-3 custom-scrollbar",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Name *"}),e.jsx("input",{required:!0,type:"text",value:l.name,onChange:t=>L({...l,name:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"SKU"}),e.jsx("input",{type:"text",value:l.sku,onChange:t=>L({...l,sku:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all font-mono"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Base Price ($) *"}),e.jsx("input",{required:!0,type:"number",step:"0.01",value:l.base_price,onChange:t=>L({...l,base_price:parseFloat(t.target.value)}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Stock Quantity *"}),e.jsx("input",{required:!0,type:"number",value:l.stock_quantity,onChange:t=>L({...l,stock_quantity:parseInt(t.target.value)}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all"})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Category *"}),e.jsxs("div",{className:"relative group",children:[e.jsx(ie,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search category...",className:"pl-7 pr-3 py-1 bg-gray-100 border-none rounded-lg text-[10px] focus:ring-0 w-32 font-bold placeholder:text-gray-300 transition-all focus:w-48",value:T,onChange:t=>G(t.target.value)})]})]}),e.jsxs("select",{required:!0,value:l.category_id,onChange:t=>L({...l,category_id:t.target.value}),className:"w-full px-3 py-2.5 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all appearance-none cursor-pointer font-bold text-gray-700",children:[e.jsx("option",{value:"",children:"Select Category"}),E.filter(t=>t.name.toLowerCase().includes(T.toLowerCase())).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Brand"}),e.jsxs("select",{value:l.brand_id,onChange:t=>L({...l,brand_id:t.target.value}),className:"w-full px-3 py-2.5 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all appearance-none cursor-pointer font-bold text-gray-700",children:[e.jsx("option",{value:"",children:"Select Brand (Optional)"}),M.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsx("div",{className:"col-span-full py-2 border-t border-gray-50 mt-2",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group w-fit",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:l.is_featured,onChange:t=>L({...l,is_featured:t.target.checked})}),e.jsx("div",{className:`w-10 h-5 rounded-full transition-all duration-300 ${l.is_featured?"bg-emerald-500 shadow-lg shadow-emerald-200":"bg-gray-200"}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-3 h-3 bg-white rounded-full transition-transform duration-300 ${l.is_featured?"translate-x-5":""}`})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-black text-gray-700 uppercase tracking-widest block leading-none",children:"Featured Product"}),e.jsx("span",{className:"text-[8px] text-gray-400 font-bold uppercase tracking-tighter",children:"Show this in featured products sections"})]})]})}),e.jsxs("div",{className:"col-span-full space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Description"}),e.jsx("textarea",{rows:3,value:l.description,onChange:t=>L({...l,description:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all resize-none"})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Colors (Hex codes)"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(((Qe=l.attributes)==null?void 0:Qe.colors)||[]).map((t,N)=>e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg border border-gray-100 bg-white shadow-sm transition-all hover:border-emerald-200 group",children:[e.jsx("div",{className:"w-3 h-3 rounded-full shadow-inner",style:{backgroundColor:t}}),e.jsx("span",{className:"text-[10px] font-bold text-gray-600 font-mono tracking-tighter",children:t}),e.jsx("button",{type:"button",onClick:()=>Ge(t,"edit"),className:"p-0.5 text-gray-400 hover:text-red-500 rounded transition-colors",children:e.jsx(ee,{className:"w-2.5 h-2.5"})})]},N))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1 group",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border border-gray-200",style:{backgroundColor:Q}}),e.jsx("input",{type:"text",value:Q,onChange:t=>ae(t.target.value),onKeyDown:t=>t.key==="Enter"&&(t.preventDefault(),fe("edit")),placeholder:"#FF5733",className:"w-full pl-9 pr-4 py-2 bg-gray-50 border border-transparent rounded-xl text-[12px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all font-mono"})]}),e.jsx("button",{type:"button",onClick:()=>fe("edit"),className:"px-4 py-2 bg-emerald-600 text-white rounded-xl text-xs font-bold hover:bg-emerald-700 transition-all shadow-lg shadow-emerald-600/10",children:"Add"})]})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Images (up to 5)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-[8px] font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full uppercase tracking-tighter",children:"Recommended: 800x800px"}),e.jsx("span",{className:"text-[8px] font-bold text-gray-400 bg-gray-50 px-2 py-0.5 rounded-full uppercase tracking-tighter",children:"JPG, PNG, SVG, WEBP"})]})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[(l.images||[]).map((t,N)=>e.jsxs("div",{className:"relative aspect-square rounded-xl overflow-hidden group border border-gray-100 shadow-sm bg-gray-50",children:[e.jsx("img",{src:t,className:"w-full h-full object-cover",alt:"",onError:$=>{$.target.src="https://placehold.co/400x400/f3f4f6/9ca3af?text=Image+Load+Error"}}),e.jsx("button",{type:"button",onClick:()=>xe(N,!0),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity shadow-lg",children:e.jsx(ee,{className:"w-2.5 h-2.5"})})]},N)),(l.images||[]).length<5&&e.jsxs("label",{className:"relative aspect-square rounded-xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center gap-1 cursor-pointer hover:border-emerald-500 hover:bg-emerald-50/30 transition-all group",children:[e.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.svg,.webp,.gif",multiple:!0,className:"hidden",onChange:t=>re(t,!0),disabled:F}),F?e.jsx("div",{className:"w-4 h-4 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"w-4 h-4 text-gray-400 group-hover:text-emerald-500 transition-colors"}),e.jsx("span",{className:"text-[8px] font-black text-gray-400 uppercase group-hover:text-emerald-500 transition-colors",children:"Upload"})]})]})]})]})]})}),e.jsxs("div",{className:"p-4 bg-gray-50/50 border-t border-gray-50 flex gap-3 shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>z(!1),className:"flex-1 px-4 py-2 bg-white text-gray-500 font-bold rounded-xl hover:bg-gray-100 transition-all uppercase tracking-widest text-[9px] border border-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:q||F,className:"flex-[2] px-4 py-2 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-700 transition-all uppercase tracking-widest text-[9px] shadow-lg shadow-emerald-200 disabled:opacity-50 flex items-center justify-center gap-2",children:q?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Updating..."]}):F?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Uploading Images..."]}):"Save Changes"})]})]})]})})]})}function ts(){var d,k,s,o,f,A,I,q,B,i,g;const[r,D]=a.useState([]),[R,j]=a.useState(!0),[E,x]=a.useState(""),[M,C]=a.useState("all"),[p,v]=a.useState(null),[S,U]=a.useState(!1),[u,P]=a.useState(null);a.useEffect(()=>{b()},[]);const b=async()=>{j(!0);try{const{data:{user:l}}=await m.auth.getUser();if(!l)return;const{data:L}=await m.from("vendor_profiles").select("id").eq("user_id",l.id).single();if(L){const{data:W,error:z}=await m.from("orders").select("*, customer:profiles(full_name, email, phone)").eq("vendor_id",L.id).order("created_at",{ascending:!1});if(z)throw z;D(W||[])}}catch(l){console.error("Error fetching orders:",l),P({type:"error",text:l.message})}finally{j(!1)}},n=async(l,L)=>{U(!0);try{const{error:W}=await m.from("orders").update({status:L}).eq("id",l);if(W)throw W;D(z=>z.map(V=>V.id===l?{...V,status:L}:V)),(p==null?void 0:p.id)===l&&v(z=>z?{...z,status:L}:null),P({type:"success",text:`Order status updated to ${L}`})}catch(W){P({type:"error",text:W.message})}finally{U(!1)}},y=r.filter(l=>{var z;const L=l.order_number.toLowerCase().includes(E.toLowerCase())||(((z=l.customer)==null?void 0:z.full_name)||"").toLowerCase().includes(E.toLowerCase()),W=M==="all"||l.status===M;return L&&W}),_=l=>{switch(l){case"pending":return"bg-amber-50 text-amber-700 border-amber-100";case"processing":return"bg-blue-50 text-blue-700 border-blue-100";case"shipped":return"bg-indigo-50 text-indigo-700 border-indigo-100";case"delivered":return"bg-emerald-50 text-emerald-700 border-emerald-100";case"cancelled":return"bg-red-50 text-red-700 border-red-100";default:return"bg-gray-50 text-gray-700 border-gray-100"}},c=l=>{switch(l){case"pending":return e.jsx(mt,{className:"w-3 h-3"});case"processing":return e.jsx(X,{className:"w-3 h-3"});case"shipped":return e.jsx(Vt,{className:"w-3 h-3"});case"delivered":return e.jsx(J,{className:"w-3 h-3"});case"cancelled":return e.jsx(te,{className:"w-3 h-3"});default:return e.jsx(de,{className:"w-3 h-3"})}};return R?e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"}),e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Fetching your orders..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Order Management"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Manage and track all customer orders directed to your shop."})]}),e.jsxs("button",{onClick:b,className:"flex items-center gap-2 bg-white hover:bg-gray-50 text-gray-700 px-4 py-2 rounded-xl text-sm font-bold border border-gray-200 transition-all active:scale-95",children:[e.jsx(Be,{className:"w-4 h-4"}),"Refresh List"]})]}),e.jsx("div",{className:"bg-white border border-gray-100 rounded-2xl p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ie,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by Order ID or Customer Name...",value:E,onChange:l=>x(l.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 border border-transparent rounded-xl text-sm focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(xt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400"}),e.jsxs("select",{value:M,onChange:l=>C(l.target.value),className:"pl-8 pr-10 py-2.5 bg-gray-50 border border-transparent rounded-xl text-sm font-medium focus:bg-white focus:border-emerald-500 outline-none transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsx(ve,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]})})]})}),u&&e.jsxs("div",{className:`p-4 rounded-xl flex items-center justify-between animate-in fade-in slide-in-from-top-2 ${u.type==="success"?"bg-green-50 text-green-700 border border-green-100":"bg-red-50 text-red-700 border border-red-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[u.type==="success"?e.jsx(J,{className:"w-5 h-5"}):e.jsx(te,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:u.text})]}),e.jsx("button",{onClick:()=>P(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(te,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm overflow-hidden text-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50/50 border-b border-gray-100",children:[e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Order Details"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Customer"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Total Amount"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-20 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center",children:e.jsx(ge,{className:"w-8 h-8 text-gray-200"})}),e.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"No orders found matching your criteria"})]})})}):y.map(l=>{var L,W,z,V;return e.jsxs("tr",{className:"hover:bg-gray-50/30 group transition-all",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-black text-gray-900 group-hover:text-emerald-600 transition-colors uppercase tabular-nums",children:["#",l.order_number]}),e.jsxs("span",{className:"text-[10px] text-gray-400 font-bold mt-0.5",children:[new Date(l.created_at).toLocaleDateString()," at ",new Date(l.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-gray-400 font-bold text-xs uppercase",children:((W=(L=l.customer)==null?void 0:L.full_name)==null?void 0:W.charAt(0))||"U"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-gray-900 uppercase text-[11px] tracking-tight",children:((z=l.customer)==null?void 0:z.full_name)||"Anonymous"}),e.jsx("span",{className:"text-[10px] text-gray-400",children:(V=l.customer)==null?void 0:V.email})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-black text-gray-900",children:["$",l.total.toFixed(2)]}),e.jsx("span",{className:"text-[10px] text-emerald-600 font-bold uppercase tracking-widest",children:l.payment_status})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full border text-[10px] font-black uppercase tracking-widest ${_(l.status)}`,children:[c(l.status),l.status]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>v(l),className:"p-2 text-gray-400 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-all",title:"View Details",children:e.jsx(Se,{className:"w-4 h-4"})})})]},l.id)})})]})})}),p&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white w-full max-w-4xl rounded-3xl shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200 flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 border-b border-gray-50 flex items-center justify-between bg-gray-50/50 shrink-0",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs font-black text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full uppercase tracking-widest",children:"ORDER DETAIL"}),e.jsxs("h3",{className:"text-lg font-black text-gray-900 tabular-nums",children:["#",p.order_number]})]}),e.jsxs("p",{className:"text-[10px] text-gray-400 font-bold mt-1 uppercase tracking-wider",children:["Placed on ",new Date(p.created_at).toLocaleString()]})]}),e.jsx("button",{onClick:()=>v(null),className:"p-2 hover:bg-gray-100 rounded-xl transition-all",children:e.jsx(te,{className:"w-6 h-6 text-gray-300"})})]}),e.jsxs("div",{className:"p-8 overflow-y-auto space-y-8",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-8 text-sm font-medium",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600",children:[e.jsx(it,{className:"w-4 h-4"}),e.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest",children:"Customer Information"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 border border-gray-100 space-y-3",children:[e.jsx("p",{className:"font-black text-gray-900 uppercase",children:(d=p.customer)==null?void 0:d.full_name}),e.jsx("p",{className:"text-gray-500 font-bold text-xs",children:(k=p.customer)==null?void 0:k.email}),e.jsx("p",{className:"text-gray-500 font-bold text-xs",children:(s=p.customer)==null?void 0:s.phone})]})]}),e.jsxs("div",{className:"space-y-4 text-sm font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600",children:[e.jsx(Pt,{className:"w-4 h-4"}),e.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest",children:"Shipping Address"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 border border-gray-100 min-h-[100px] text-xs font-bold text-gray-600 space-y-1",children:[e.jsx("p",{className:"text-gray-900 font-black",children:(o=p.shipping_address)==null?void 0:o.full_name}),e.jsx("p",{children:(f=p.shipping_address)==null?void 0:f.address_line1}),e.jsxs("p",{children:[(A=p.shipping_address)==null?void 0:A.city,", ",(I=p.shipping_address)==null?void 0:I.state]}),e.jsxs("p",{children:[(q=p.shipping_address)==null?void 0:q.country,", ",(B=p.shipping_address)==null?void 0:B.zip_code]})]})]}),e.jsxs("div",{className:"space-y-4 text-sm font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600",children:[e.jsx(oe,{className:"w-4 h-4"}),e.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest",children:"Payment & Status"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 border border-gray-100 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] text-gray-400 font-black uppercase tracking-widest",children:"Method:"}),e.jsx("span",{className:"font-black text-gray-900 uppercase text-[11px]",children:p.payment_method||"Direct Payment"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] text-gray-400 font-black uppercase tracking-widest",children:"Status:"}),e.jsx("span",{className:"font-black text-emerald-600 uppercase text-[11px]",children:p.payment_status})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] text-gray-400 font-black uppercase tracking-widest",children:"Order:"}),e.jsx("div",{className:`px-2 py-0.5 rounded-full border text-[9px] font-black uppercase tracking-widest ${_(p.status)}`,children:p.status})]})]})]})]}),e.jsxs("div",{className:"space-y-4 text-sm font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600",children:[e.jsx(X,{className:"w-4 h-4"}),e.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest",children:"Order Items"})]}),e.jsx("div",{className:"border border-gray-100 rounded-2xl overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Product"}),e.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Qty"}),e.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-gray-400 uppercase tracking-widest text-right",children:"Total"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50 font-bold",children:p.items.map((l,L)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg overflow-hidden shrink-0",children:l.image?e.jsx("img",{src:l.image,alt:l.name,className:"w-full h-full object-cover"}):e.jsx(X,{className:"w-5 h-5 text-gray-300 m-2.5"})}),e.jsx("span",{className:"text-xs text-gray-900 uppercase line-clamp-1",children:l.name})]})}),e.jsxs("td",{className:"px-6 py-4 text-gray-600",children:["$",l.price.toFixed(2)]}),e.jsxs("td",{className:"px-6 py-4 text-gray-600",children:["x",l.quantity]}),e.jsxs("td",{className:"px-6 py-4 text-right text-gray-900 font-black tabular-nums",children:["$",(l.price*l.quantity).toFixed(2)]})]},L))}),e.jsxs("tfoot",{className:"bg-gray-50/50",children:[e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"px-6 py-3 text-right text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Subtotal"}),e.jsxs("td",{className:"px-6 py-3 text-right font-black text-gray-900 tabular-nums",children:["$",((i=p.subtotal)==null?void 0:i.toFixed(2))||(p.total-p.shipping_fee).toFixed(2)]})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"px-6 py-3 text-right text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Shipping"}),e.jsxs("td",{className:"px-6 py-3 text-right font-black text-gray-900 tabular-nums",children:["$",((g=p.shipping_fee)==null?void 0:g.toFixed(2))||"0.00"]})]}),e.jsxs("tr",{className:"border-t border-gray-200",children:[e.jsx("td",{colSpan:3,className:"px-6 py-4 text-right text-xs font-black text-gray-900 uppercase tracking-widest",children:"Grand Total"}),e.jsxs("td",{className:"px-6 py-4 text-right text-xl font-black text-emerald-600 tabular-nums",children:["$",p.total.toFixed(2)]})]})]})]})})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-100 bg-gray-50/30 flex flex-col md:flex-row items-center justify-between gap-4 shrink-0 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Update Order Status:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["processing","shipped","delivered","cancelled"].map(l=>e.jsx("button",{onClick:()=>n(p.id,l),disabled:S||p.status===l,className:`px-3 py-1.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${p.status===l?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-white border border-gray-200 text-gray-700 hover:border-emerald-600 hover:text-emerald-600 shadow-sm"}`,children:l},l))})]}),e.jsx("button",{onClick:()=>v(null),className:"bg-gray-900 text-white px-8 py-3 rounded-2xl text-[10px] font-black uppercase tracking-widest hover:bg-black transition-all shadow-lg shadow-gray-200 active:scale-95",children:"Close Detail"})]})]})})]})}function ss(){var _;const r=lt(),[D,R]=a.useState([]),[j,E]=a.useState(null),[x,M]=a.useState(!0),[C,p]=a.useState(null),[v,S]=a.useState(null),[U,u]=a.useState(null);a.useEffect(()=>{P()},[]);const P=async()=>{M(!0);try{const{data:c,error:d}=await m.from("vendor_packages").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(d)throw d;R(c||[]);const{data:{user:k}}=await m.auth.getUser();if(!k)return;const{data:s}=await m.from("vendor_profiles").select("id").eq("user_id",k.id).single();if(s){S(k.id);const{data:o}=await m.from("vendor_subscriptions").select("package_id").eq("vendor_id",k.id).maybeSingle();o&&E(o.package_id)}}catch(c){console.error("Error fetching data:",c)}finally{M(!1)}},b=c=>{const d=c.toLowerCase();return d.includes("starter")?"emerald":d.includes("pro")?"blue":d.includes("elite")?"purple":"gray"},n=c=>{const d=[];return c.product_limit>=999999?d.push("Unlimited Products"):d.push(`Up to ${c.product_limit} Products`),c.has_priority_support?d.push("24/7 Dedicated Support"):d.push("Standard Support"),c.has_analytics_access&&d.push("Advanced Analytics"),c.has_ads_access&&d.push("Ads Access"),c.has_pos_access&&d.push("POS Access"),c.has_wallet_management&&d.push("Wallet Management"),c.has_withdraw_management&&d.push("Fast Withdrawals"),c.has_promotion_access&&d.push("Product Promotions"),d},y=async c=>{if(c===j)return;const d=D.find(k=>k.id===c);if(d){if(d.price_monthly>0){r(`/vendor/payment?packageId=${c}&plan=${d.name}`);return}p(c);try{const{error:k}=await m.from("vendor_subscriptions").upsert({vendor_id:v,package_id:c,status:"active",billing_cycle:"monthly"},{onConflict:"vendor_id"});if(k)throw k;E(c),u({type:"success",text:`Successfully switched to ${d.name}.`})}catch(k){u({type:"error",text:k.message})}finally{p(null)}}};return x?e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"}),e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Syncing packages..."})]}):e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900 uppercase tracking-tight",children:"Vendor Packages"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the plan that best fits your business growth."})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-emerald-50 px-4 py-2 rounded-xl text-emerald-700 text-[10px] font-black uppercase tracking-widest border border-emerald-100",children:[e.jsx(ct,{className:"w-3 h-3"}),((_=D.find(c=>c.id===j))==null?void 0:_.price_monthly)===0?e.jsx("span",{children:"Lifetime Access"}):e.jsxs("span",{children:["Next Billing: ",new Date(new Date().setMonth(new Date().getMonth()+1)).toLocaleDateString()]})]})]}),U&&e.jsxs("div",{className:`p-4 rounded-2xl flex items-center justify-between ${U.type==="success"?"bg-green-50 text-green-700 border border-green-100":"bg-red-50 text-red-700 border border-red-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Me,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-bold",children:U.text})]}),e.jsx("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(te,{})})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:D.map(c=>{const d=j===c.id,k=b(c.name),s=n(c);return e.jsxs("div",{className:`relative bg-white rounded-[32px] border transition-all duration-500 overflow-hidden flex flex-col p-8 ${d?"border-emerald-500 ring-4 ring-emerald-500/10 shadow-xl":"border-gray-100 hover:border-emerald-200 hover:shadow-2xl hover:shadow-gray-200/50"}`,children:[c.sort_order===2&&e.jsx("div",{className:"absolute top-0 right-0 bg-emerald-600 text-white px-6 py-2 rounded-bl-3xl text-[10px] font-black uppercase tracking-widest",children:"Best Value"}),d&&e.jsx("div",{className:"mb-6 flex",children:e.jsx("span",{className:"bg-emerald-50 text-emerald-600 px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest border border-emerald-100",children:"Current active plan"})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:c.name.split(" ")[0]}),e.jsx("h3",{className:"text-2xl font-black text-gray-900 tracking-tight",children:c.name}),e.jsxs("div",{className:"mt-4 flex items-baseline gap-1",children:[e.jsxs("span",{className:"text-4xl font-black text-gray-900 tabular-nums",children:["$",c.price_monthly]}),e.jsx("span",{className:"text-gray-400 text-sm font-bold uppercase tracking-widest",children:"/ Month"})]})]}),e.jsxs("div",{className:"space-y-4 mb-10 flex-1",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-300 uppercase tracking-widest",children:"What's included:"}),s.map((o,f)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center shrink-0 ${d?"bg-emerald-100 text-emerald-600":"bg-gray-50 text-gray-300"}`,children:e.jsx(Me,{className:"w-3 h-3",strokeWidth:3})}),e.jsx("span",{className:"text-xs font-bold text-gray-600",children:o})]},f))]}),e.jsx("button",{disabled:d||C===c.id,onClick:()=>y(c.id),className:`w-full py-4 rounded-2xl text-[11px] font-black uppercase tracking-widest transition-all ${d?"bg-gray-50 text-gray-400 cursor-not-allowed border border-gray-100":k==="blue"?"bg-emerald-600 text-white hover:bg-emerald-700 shadow-lg shadow-emerald-200 active:scale-95":"bg-gray-900 text-white hover:bg-black shadow-lg shadow-gray-200 active:scale-95"}`,children:C===c.id?"Processing...":d?"Active Plan":"Select Plan"})]},c.id)})})]})}function as(){const{profile:r}=se(),[D,R]=a.useState(!0),[j,E]=a.useState(!1),[x,M]=a.useState(null),[C,p]=a.useState("none"),[v,S]=a.useState(null),[U,u]=a.useState(!1),[P,b]=a.useState(!1),[n,y]=a.useState([]);a.useEffect(()=>{_()},[r]);const _=async()=>{var s;if(r!=null&&r.id)try{const{data:o}=await m.from("vendor_profiles").select("kyc_status, kyc_details").eq("user_id",r.id).maybeSingle();o&&(p(o.kyc_status||"none"),M(o.kyc_details),y(((s=o.kyc_details)==null?void 0:s.documents)||[]))}catch(o){console.error("Error fetching KYC:",o)}finally{R(!1)}},c=async s=>{var f;if(!s.target.files||!(r!=null&&r.id))return;const o=Array.from(s.target.files);u(!0),S(null);try{const{data:A}=await m.from("vendor_profiles").select("id").eq("user_id",r.id).single();if(!A)throw new Error("Vendor profile not found");const I=[];for(const q of o){const i=`kyc/${`${A.id}/${Date.now()}-${q.name.replace(/\s+/g,"_")}`}`,{error:g}=await m.storage.from("shop-assets").upload(i,q);if(g)throw console.error("Upload error:",g),g.statusCode==="404"||(f=g.message)!=null&&f.includes("not found")?new Error('Storage bucket "shop-assets" not found. Please create it in Supabase dashboard.'):g;const{data:{publicUrl:l}}=m.storage.from("shop-assets").getPublicUrl(i);I.push({name:q.name,url:l,path:i,type:q.type,size:q.size,submitted_at:new Date().toISOString()})}y(q=>[...q,...I]),S({type:"success",text:`${o.length} document(s) prepared successfully.`})}catch(A){console.error("File upload failed:",A),S({type:"error",text:`Upload failed: ${A.message}`})}finally{u(!1),s.target.value=""}},d=s=>{y(o=>o.filter((f,A)=>A!==s))},k=async s=>{var o;if(s.preventDefault(),E(!0),S(null),!!(r!=null&&r.id))try{const{data:f}=await m.from("vendor_profiles").select("id").eq("user_id",r.id).single();if(!f)throw new Error("Vendor profile not found");const A=new FormData(s.target),I={full_name:A.get("full_name"),id_number:A.get("id_number"),business_reg:A.get("business_reg"),tax_number:A.get("tax_number"),address:A.get("address"),submitted_at:new Date().toISOString(),documents:n,storage_path:(o=n[0])!=null&&o.path?n[0].path.split("/").slice(0,-1).join("/"):"kyc"},{error:q}=await m.from("vendor_profiles").update({kyc_status:"pending",kyc_details:I}).eq("user_id",r==null?void 0:r.id);if(q)throw q;const{data:B}=await m.from("profiles").select("id").eq("role","admin");if(B&&B.length>0){const i=(x==null?void 0:x.shop_name)||(r==null?void 0:r.full_name)||"A Vendor",g=B.map(l=>({user_id:l.id,type:"info",title:"New KYC Submission",message:`Shop "${i}" has submitted KYC documents for review.`,data:{vendor_id:f.id,type:"kyc_submission"},is_read:!1}));await m.from("notifications").insert(g)}p("pending"),M(I),y(n),b(!1),S({type:"success",text:"KYC documents submitted successfully for review."})}catch(f){S({type:"error",text:f.message})}finally{E(!1)}};return D?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"})}):e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4 pb-2 border-b border-gray-100",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900 uppercase tracking-tighter",children:"Business Verification"}),e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest",children:"Trust & Security â€¢ Identity Management â€¢ Compliance"})]}),e.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-[0.15em] border transition-all shadow-sm ${C==="approved"?"bg-emerald-50 text-emerald-700 border-emerald-100":C==="pending"?"bg-blue-50 text-blue-700 border-blue-100":C==="rejected"?"bg-red-50 text-red-700 border-red-100":"bg-gray-50 text-gray-500 border-gray-100"}`,children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full animate-pulse ${C==="approved"?"bg-emerald-500":C==="pending"?"bg-blue-500":C==="rejected"?"bg-red-500":"bg-gray-400"}`}),C==="none"?"Verification Required":C]})]}),v&&e.jsx("div",{className:`p-4 rounded-xl flex items-center justify-between animate-in zoom-in duration-300 ${v.type==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-100":"bg-red-50 text-red-800 border border-red-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[v.type==="success"?e.jsx(J,{className:"w-5 h-5"}):e.jsx(ne,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-black uppercase tracking-tight",children:v.text})]})}),C==="approved"?e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-10 text-center space-y-6 shadow-sm",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto text-emerald-600 shadow-inner",children:e.jsx(ke,{size:32})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-black text-gray-900 tracking-tight uppercase",children:"Identity Verified"}),e.jsx("p",{className:"text-gray-500 max-w-sm mx-auto font-bold text-sm",children:"Your business has cleared all compliance checks. You now have priority access to all gateway features."})]})]}):(C==="pending"||C==="rejected")&&!P?e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-10 text-center space-y-6 shadow-sm",children:[e.jsx("div",{className:`w-16 h-16 ${C==="pending"?"bg-blue-100 text-blue-600 animate-pulse":"bg-red-100 text-red-600"} rounded-2xl flex items-center justify-center mx-auto shadow-inner`,children:C==="pending"?e.jsx(mt,{size:32}):e.jsx(ne,{size:32})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-black text-gray-900 tracking-tight uppercase",children:C==="pending"?"Review in Progress":"Verification Rejected"}),e.jsx("p",{className:"text-gray-500 max-w-sm mx-auto font-bold tracking-tight text-sm",children:C==="pending"?"Our compliance officers are verifying your documents. This typically takes 24 business hours.":(x==null?void 0:x.rejection_reason)||"Information provided was insufficient or invalid. Please update and resubmit."})]}),e.jsxs("div",{className:"pt-8 border-t border-gray-50 max-w-2xl mx-auto grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] mb-4 text-left",children:"Transmission Snapshot"}),e.jsx("div",{className:"space-y-2 text-left bg-gray-50 p-6 rounded-xl border border-gray-100",children:[{label:"Primary Contact",value:x==null?void 0:x.full_name},{label:"ID/Passport",value:x==null?void 0:x.id_number},{label:"Entity ID",value:x==null?void 0:x.business_reg},{label:"Tax ID (BP#)",value:x==null?void 0:x.tax_number}].map((s,o)=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest",children:s.label}),e.jsx("span",{className:"text-xs font-black text-gray-900",children:s.value||"N/A"})]},o))}),e.jsx("button",{onClick:()=>b(!0),className:"w-full py-3 bg-gray-900 text-white rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-black transition-all shadow-sm",children:"Edit KYC Details"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] mb-4 text-left",children:"Submitted Documents"}),e.jsx("div",{className:"space-y-2",children:n.length>0?n.map((s,o)=>e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-white border border-gray-100 rounded-xl hover:border-blue-500 transition-colors group",children:[e.jsx("div",{className:"p-2 bg-blue-50 text-blue-600 rounded-lg group-hover:bg-blue-600 group-hover:text-white transition-colors",children:e.jsx(de,{size:16})}),e.jsxs("div",{className:"flex-1 text-left min-w-0",children:[e.jsx("p",{className:"text-xs font-black text-gray-900 truncate uppercase tracking-tighter",children:s.name}),e.jsxs("p",{className:"text-[9px] text-gray-400 font-bold uppercase",children:[(s.size/1024).toFixed(1)," KB"]})]})]},o)):e.jsxs("div",{className:"p-10 border-2 border-dashed border-gray-100 rounded-2xl flex flex-col items-center justify-center text-gray-300",children:[e.jsx(de,{size:32,className:"mb-2 opacity-20"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest",children:"No Documents Found"})]})})]})]})]}):e.jsxs("form",{onSubmit:k,className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm transition-all",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center gap-4 bg-gray-50/50",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center text-blue-600 border border-gray-100",children:e.jsx(de,{size:24,strokeWidth:2.5})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-black text-gray-900 tracking-tighter uppercase",children:"Legal Disclosure"}),e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mt-0.5",children:"Submit authentic documents to enable withdrawals."})]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] ml-1",children:"Representative Name"}),e.jsxs("div",{className:"relative group",children:[e.jsx(it,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-300 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{name:"full_name",required:!0,defaultValue:x==null?void 0:x.full_name,placeholder:"Legal Representative Name",className:"w-full bg-gray-50 border-gray-200 border focus:border-blue-500 focus:bg-white rounded-xl py-2.5 pl-10 pr-4 text-sm font-bold transition-all outline-none placeholder:font-medium"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] ml-1",children:"Government ID Number"}),e.jsxs("div",{className:"relative group",children:[e.jsx(ke,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-300 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{name:"id_number",required:!0,defaultValue:x==null?void 0:x.id_number,placeholder:"National ID / Passport #",className:"w-full bg-gray-50 border-gray-200 border focus:border-blue-500 focus:bg-white rounded-xl py-2.5 pl-10 pr-4 text-sm font-bold transition-all outline-none placeholder:font-medium"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] ml-1",children:"Business Registration"}),e.jsxs("div",{className:"relative group",children:[e.jsx(he,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-300 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{name:"business_reg",required:!0,defaultValue:x==null?void 0:x.business_reg,placeholder:"Certificate Number",className:"w-full bg-gray-50 border-gray-200 border focus:border-blue-500 focus:bg-white rounded-xl py-2.5 pl-10 pr-4 text-sm font-bold transition-all outline-none placeholder:font-medium"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] ml-1",children:"Tax Identification (TIN)"}),e.jsxs("div",{className:"relative group",children:[e.jsx(de,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-300 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{name:"tax_number",required:!0,defaultValue:x==null?void 0:x.tax_number,placeholder:"BP# / TIN#",className:"w-full bg-gray-50 border-gray-200 border focus:border-blue-500 focus:bg-white rounded-xl py-2.5 pl-10 pr-4 text-sm font-bold transition-all outline-none placeholder:font-medium"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] ml-1",children:"Physical Trading Address"}),e.jsx("textarea",{name:"address",required:!0,rows:2,defaultValue:x==null?void 0:x.address,placeholder:"Headquarters physical address...",className:"w-full bg-gray-50 border-gray-200 border focus:border-blue-500 focus:bg-white rounded-xl p-4 text-sm font-bold transition-all outline-none resize-none placeholder:font-medium"})]}),e.jsxs("div",{className:"bg-blue-50/50 rounded-2xl border border-blue-100/50 p-6 flex flex-col items-center text-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center text-blue-600 border border-blue-50",children:e.jsx(be,{size:20})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"text-base font-black text-gray-900 uppercase tracking-tighter",children:"Document Transmission"}),e.jsx("p",{className:"text-xs text-gray-500 max-w-sm mx-auto font-bold uppercase tracking-tight",children:"Upload ID scan, Business Registration, and Tax certificate."})]}),e.jsx("input",{type:"file",className:"hidden",id:"kyc-files",multiple:!0,onChange:c,disabled:U,accept:".pdf,.zip,.jpg,.jpeg,.png"}),e.jsx("label",{htmlFor:"kyc-files",className:`cursor-pointer bg-white border border-gray-200 px-8 py-3 rounded-xl text-[10px] font-black uppercase tracking-[0.2em] hover:border-blue-500 hover:text-blue-600 transition-all shadow-sm text-gray-700 ${U?"opacity-50 cursor-not-allowed":""}`,children:U?"Uploading...":"Select Documents"}),n.length>0&&e.jsxs("div",{className:"w-full mt-4 space-y-2",children:[e.jsxs("h5",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-left mb-2",children:["Uploaded Assets (",n.length,")"]}),n.map((s,o)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-100 rounded-xl group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 text-blue-600 rounded-lg group-hover:bg-blue-600 group-hover:text-white transition-colors",children:e.jsx(de,{size:16})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-700 uppercase truncate max-w-[200px]",children:s.name}),e.jsxs("p",{className:"text-[8px] font-bold text-gray-400 uppercase",children:[(s.size/1024).toFixed(1)," KB â€¢ ",s.path||"Managed"]})]})]}),e.jsx("button",{type:"button",onClick:()=>d(o),className:"p-1 hover:text-red-500 transition-colors",children:e.jsx(ne,{size:14})})]},o))]}),U&&e.jsxs("div",{className:"w-full mt-4 flex items-center justify-center py-4 bg-blue-50/30 rounded-xl border border-dashed border-blue-200",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent mr-2"}),e.jsx("span",{className:"text-[10px] font-black text-blue-600 uppercase tracking-widest",children:"Transmitting to Secure Storage..."})]})]})]}),e.jsxs("div",{className:"p-6 bg-white border-t border-gray-100 flex flex-col sm:flex-row justify-between items-center gap-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[P&&e.jsx("button",{type:"button",onClick:()=>b(!1),className:"px-6 py-4 border border-gray-200 rounded-xl text-[11px] font-black uppercase tracking-widest hover:bg-gray-50 transition-all",children:"Cancel Edit"}),e.jsxs("div",{className:"flex items-start gap-2 max-w-sm text-center sm:text-left",children:[e.jsx(ke,{className:"w-4 h-4 text-gray-300 shrink-0 mt-0.5"}),e.jsx("p",{className:"text-[10px] font-bold text-gray-400 leading-relaxed uppercase tracking-widest",children:"Compliance Statement: I certify that the information provided is legally binding and accurate."})]})]}),e.jsx("button",{type:"submit",disabled:j||U||n.length===0,className:"w-full sm:w-auto bg-gray-900 text-white px-10 py-4 rounded-xl text-[11px] font-black uppercase tracking-[0.25em] hover:bg-black transition-all shadow-lg shadow-gray-200 flex items-center justify-center gap-3 active:scale-95 disabled:opacity-50",children:j?"Propagating Documents...":e.jsxs(e.Fragment,{children:[P?"Update & Re-Submit":"Verify Shop Identity",e.jsx(qt,{size:16})]})})]})]})]})}function rs(){const{profile:r}=se(),[D,R]=a.useState([]),[j,E]=a.useState(!0),[x,M]=a.useState(null),[C,p]=a.useState("all"),[v,S]=a.useState("");a.useEffect(()=>{U()},[r]);const U=async()=>{if(r!=null&&r.id)try{const{data:n}=await m.from("vendor_profiles").select("id").eq("user_id",r.id).single();if(!n)return;const{data:y,error:_}=await m.from("order_refunds").select(`
          *,
          orders (
            order_number
          ),
          profiles:customer_id (
            full_name,
            email
          )
        `).eq("vendor_id",n.id).order("created_at",{ascending:!1});if(_)throw _;R(y||[])}catch(n){console.error("Error fetching refunds:",n)}finally{E(!1)}},u=async(n,y)=>{M(n);try{const{error:_}=await m.from("order_refunds").update({status:y}).eq("id",n);if(_)throw _;R(c=>c.map(d=>d.id===n?{...d,status:y}:d))}catch(_){console.error("Error updating refund status:",_),alert("Failed to update refund status")}finally{M(null)}},P=D.filter(n=>{var c,d,k;const y=C==="all"||n.status===C,_=((c=n.orders)==null?void 0:c.order_number.toLowerCase().includes(v.toLowerCase()))||((d=n.profiles)==null?void 0:d.full_name.toLowerCase().includes(v.toLowerCase()))||((k=n.profiles)==null?void 0:k.email.toLowerCase().includes(v.toLowerCase()));return y&&_}),b=n=>{switch(n){case"approved":return"bg-emerald-50 text-emerald-700 border-emerald-100";case"processed":return"bg-emerald-50 text-emerald-700 border-emerald-100";case"rejected":return"bg-red-50 text-red-700 border-red-100";case"pending":return"bg-amber-50 text-amber-700 border-amber-100";default:return"bg-gray-50 text-gray-700 border-gray-100"}};return j?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"})}):e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900 uppercase tracking-tight",children:"Refund Management"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 uppercase tracking-wider",children:"Process and track customer refund requests."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search order or customer...",value:v,onChange:n=>S(n.target.value),className:"pl-9 pr-4 py-2 bg-white border border-gray-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none w-64"})]}),e.jsxs("select",{value:C,onChange:n=>p(n.target.value),className:"px-4 py-2 bg-white border border-gray-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending Review"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]})]}),e.jsx("div",{className:"bg-white rounded-3xl border border-gray-100 shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50/50 border-b border-gray-100",children:[e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Request Details"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Customer"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Reason"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Amount"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:P.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-400",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-50 rounded-2xl flex items-center justify-center mb-3",children:e.jsx(ot,{className:"w-6 h-6"})}),e.jsx("p",{className:"text-sm font-bold",children:"No refund requests found"})]})})}):P.map(n=>{var y,_,c,d;return e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center text-gray-500 font-bold shrink-0",children:((y=n.orders)==null?void 0:y.order_number.slice(-4))||"####"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-black text-gray-900 uppercase tracking-wide",children:["#",(_=n.orders)==null?void 0:_.order_number]}),e.jsx("p",{className:"text-[10px] text-gray-400 font-bold mt-0.5",children:new Date(n.created_at).toLocaleDateString()})]})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-xs font-bold text-gray-900",children:((c=n.profiles)==null?void 0:c.full_name)||"Unknown"}),e.jsx("div",{className:"text-[10px] text-gray-400 font-medium",children:(d=n.profiles)==null?void 0:d.email})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-xs font-medium text-gray-600 max-w-xs",children:n.reason})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"text-sm font-black text-gray-900 tabular-nums",children:["$",n.amount.toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-lg text-[10px] font-black uppercase tracking-widest border ${b(n.status)}`,children:n.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:n.status==="pending"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>u(n.id,"approved"),disabled:x===n.id,className:"p-2 bg-emerald-50 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors disabled:opacity-50",title:"Approve Refund",children:e.jsx(J,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>u(n.id,"rejected"),disabled:x===n.id,className:"p-2 bg-red-50 text-red-600 hover:bg-red-100 rounded-lg transition-colors disabled:opacity-50",title:"Reject Refund",children:e.jsx(te,{className:"w-4 h-4"})})]}):e.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:n.status==="approved"?"Completed":"Review Closed"})})})]},n.id)})})]})})})]})}function ls({onTabChange:r}){const{profile:D}=se(),[R,j]=a.useState([]),[E,x]=a.useState(!0),[M,C]=a.useState(!1),[p,v]=a.useState(!1),[S,U]=a.useState(null),[u,P]=a.useState(null),[b,n]=a.useState({title:"",image_url:"",link_url:"",ad_type:"banner",start_date:"",end_date:""});a.useEffect(()=>{D&&y()},[D]);const y=async()=>{var s,o;try{const{data:f,error:A}=await m.from("vendor_profiles").select(`
          *,
          vendor_subscriptions (
            vendor_packages (has_ads_access)
          )
        `).eq("user_id",D==null?void 0:D.id).single();if(A)throw A;const I=((o=(s=f.vendor_subscriptions)==null?void 0:s.vendor_packages)==null?void 0:o.has_ads_access)||!1;C(I),I&&_(f.id)}catch(f){console.error("Error checking ads access:",f)}finally{x(!1)}},_=async s=>{const{data:o,error:f}=await m.from("vendor_ads").select("*").eq("vendor_id",s).order("created_at",{ascending:!1});!f&&o&&j(o)},c=async s=>{var o;s.preventDefault(),x(!0);try{const f=(o=(await m.from("vendor_profiles").select("id").eq("user_id",D==null?void 0:D.id).single()).data)==null?void 0:o.id;if(!f)throw new Error("Vendor not found");const A={vendor_id:f,title:b.title,image_url:b.image_url,link_url:b.link_url,ad_type:b.ad_type,start_date:b.start_date,end_date:b.end_date,status:"active"};if(S){const{error:I}=await m.from("vendor_ads").update(A).eq("id",S.id);if(I)throw I;P({type:"success",text:"Ad updated successfully"})}else{const{error:I}=await m.from("vendor_ads").insert(A);if(I)throw I;P({type:"success",text:"Ad created successfully"})}v(!1),_(f),k()}catch(f){P({type:"error",text:f.message})}finally{x(!1)}},d=async s=>{var o;if(confirm("Are you sure you want to delete this ad?"))try{const{error:f}=await m.from("vendor_ads").delete().eq("id",s);if(f)throw f;const A=(o=(await m.from("vendor_profiles").select("id").eq("user_id",D==null?void 0:D.id).single()).data)==null?void 0:o.id;A&&_(A),P({type:"success",text:"Ad deleted successfully"})}catch(f){P({type:"error",text:f.message})}},k=()=>{U(null),n({title:"",image_url:"",link_url:"",ad_type:"banner",start_date:"",end_date:""})};return E?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading ads module..."}):M?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900",children:"Ads Management"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage your promotional campaigns"})]}),e.jsxs("button",{onClick:()=>{k(),v(!0)},className:"bg-purple-600 text-white px-4 py-2 rounded-xl font-bold hover:bg-purple-700 transition flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4"}),"Create Campaign"]})]}),u&&e.jsxs("div",{className:`p-4 rounded-xl flex items-center gap-3 ${u.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:[u.type==="success"?e.jsx(Me,{className:"w-5 h-5"}):e.jsx(ne,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:u.text})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:[R.map(s=>e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm hover:shadow-md transition overflow-hidden group",children:[e.jsxs("div",{className:"aspect-video bg-gray-100 relative",children:[e.jsx("img",{src:s.image_url,alt:s.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide border shadow-sm ${s.status==="active"?"bg-green-100 text-green-700 border-green-200":s.status==="pending"?"bg-amber-100 text-amber-700 border-amber-200":"bg-gray-100 text-gray-600 border-gray-200"}`,children:s.status})})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900 line-clamp-1",children:s.title}),e.jsx("p",{className:"text-xs text-gray-500 uppercase font-medium",children:s.ad_type})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{U(s),n(s),v(!0)},className:"p-2 hover:bg-gray-50 rounded-lg text-gray-500 hover:text-blue-600 transition",children:e.jsx(Ie,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>d(s.id),className:"p-2 hover:bg-gray-50 rounded-lg text-gray-500 hover:text-red-600 transition",children:e.jsx(Oe,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs font-bold uppercase mb-1",children:[e.jsx(Se,{className:"w-3 h-3"})," Views"]}),e.jsx("div",{className:"text-lg font-black text-gray-900",children:s.impressions.toLocaleString()})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs font-bold uppercase mb-1",children:[e.jsx(Ot,{className:"w-3 h-3"})," Clicks"]}),e.jsx("div",{className:"text-lg font-black text-gray-900",children:s.clicks.toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(Be,{className:"w-3 h-3"}),e.jsxs("span",{children:[new Date(s.start_date).toLocaleDateString()," - ",new Date(s.end_date).toLocaleDateString()]})]})]})]},s.id)),R.length===0&&e.jsxs("div",{className:"col-span-full border-2 border-dashed border-gray-200 rounded-3xl p-12 text-center text-gray-400",children:[e.jsx(Ee,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"No active campaigns"}),e.jsx("p",{className:"text-sm",children:"Start promoting your products today"})]})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl w-full max-w-lg p-8 shadow-2xl overflow-y-auto max-h-[90vh]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-black text-gray-900",children:S?"Edit Campaign":"New Campaign"}),e.jsx("button",{onClick:()=>v(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(ee,{className:"w-6 h-6 text-gray-500"})})]}),e.jsxs("form",{onSubmit:c,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Campaign Title"}),e.jsx("input",{required:!0,type:"text",value:b.title,onChange:s=>n({...b,title:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none",placeholder:"Summer Sale 2024"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Ad Type"}),e.jsxs("select",{value:b.ad_type,onChange:s=>n({...b,ad_type:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none",children:[e.jsx("option",{value:"banner",children:"Main Banner"}),e.jsx("option",{value:"sidebar",children:"Sidebar Ad"}),e.jsx("option",{value:"popup",children:"Popup Modal"}),e.jsx("option",{value:"featured",children:"Featured Spot"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Target URL"}),e.jsx("input",{type:"text",value:b.link_url,onChange:s=>n({...b,link_url:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none",placeholder:"https://..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Image URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{required:!0,type:"text",value:b.image_url,onChange:s=>n({...b,image_url:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none",placeholder:"https://..."}),e.jsx("button",{type:"button",className:"px-4 bg-gray-100 rounded-xl font-bold text-gray-600 hover:bg-gray-200",children:e.jsx(Ue,{className:"w-5 h-5"})})]}),b.image_url&&e.jsx("img",{src:b.image_url,alt:"Preview",className:"mt-2 h-32 w-full object-cover rounded-xl border border-gray-200"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{required:!0,type:"datetime-local",value:b.start_date?new Date(b.start_date).toISOString().slice(0,16):"",onChange:s=>n({...b,start_date:new Date(s.target.value).toISOString()}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{required:!0,type:"datetime-local",value:b.end_date?new Date(b.end_date).toISOString().slice(0,16):"",onChange:s=>n({...b,end_date:new Date(s.target.value).toISOString()}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",disabled:E,className:"w-full bg-purple-600 text-white font-bold py-4 rounded-xl hover:bg-purple-700 transition shadow-lg shadow-purple-200 active:scale-95 disabled:opacity-50",children:E?"Saving...":"Save Campaign"})})]})]})})]}):e.jsx("div",{className:"max-w-2xl mx-auto text-center py-12 px-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-100 to-indigo-50 p-8 rounded-3xl border border-purple-100 shadow-xl",children:[e.jsx("div",{className:"w-20 h-20 bg-white rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-sm",children:e.jsx(Ee,{className:"w-10 h-10 text-purple-600"})}),e.jsx("h2",{className:"text-3xl font-black text-gray-900 mb-4",children:"Boost Your Sales with Ads!"}),e.jsxs("p",{className:"text-gray-600 mb-8 text-lg leading-relaxed",children:["Unlock the power of targeted advertising. Create banners, popups, and featured listings to reach more customers. This feature is exclusively available for ",e.jsx("span",{className:"font-bold text-purple-600",children:"Premium & Gold"})," partners."]}),e.jsx("button",{onClick:()=>r==null?void 0:r("packages"),className:"bg-purple-600 text-white px-8 py-4 rounded-xl font-bold hover:bg-purple-700 transition shadow-lg shadow-purple-200 active:scale-95",children:"Upgrade My Package"})]})})}const at=["#8B5CF6","#10B981","#F59E0B","#EF4444","#3B82F6"];function Ne({title:r,value:D,trend:R,icon:j,color:E}){return e.jsxs("div",{className:"bg-white p-5 rounded-[2rem] border border-gray-100 shadow-sm hover:translate-y-[-2px] transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:`p-2.5 rounded-xl ${E}`,children:j}),R!==void 0&&e.jsxs("div",{className:`flex items-center gap-0.5 text-[9px] font-black ${R>=0?"text-green-600":"text-red-600"} uppercase tracking-widest`,children:[R>=0?e.jsx(Ae,{className:"w-3 h-3"}):e.jsx(Mt,{className:"w-3 h-3"}),Math.abs(R),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-gray-400 uppercase tracking-[0.2em] mb-1",children:r}),e.jsx("h3",{className:"text-xl font-black text-gray-900 tracking-tight",children:D})]})]})}function ns(){const{profile:r}=se(),[D,R]=a.useState(!0),[j,E]=a.useState("USD"),[x,M]=a.useState("30days"),[C,p]=a.useState(""),[v,S]=a.useState(""),[U,u]=a.useState({totalRevenue:0,totalOrders:0,avgOrderValue:0,growth:12.5}),[P,b]=a.useState([]),[n,y]=a.useState([]);a.useEffect(()=>{r&&_()},[r,j,x,C,v]);const _=async()=>{R(!0);try{const c=(await m.from("vendor_profiles").select("id").eq("user_id",r==null?void 0:r.id).single()).data;if(!c)return;let d,k=new Date().toISOString();if(x==="custom"&&C&&v)d=new Date(C).toISOString(),k=new Date(new Date(v).setHours(23,59,59)).toISOString();else{let i=new Date;x==="7days"?i.setDate(i.getDate()-7):x==="30days"?i.setDate(i.getDate()-30):x==="90days"&&i.setDate(i.getDate()-90),d=i.toISOString()}const{data:s,error:o}=await m.from("orders").select("total, currency_code, created_at, items").eq("vendor_id",c.id).eq("currency_code",j).gte("created_at",d).lte("created_at",k).order("created_at",{ascending:!0});if(o)throw o;const f=s,A=f.reduce((i,g)=>i+Number(g.total),0);u({totalRevenue:A,totalOrders:f.length,avgOrderValue:f.length>0?A/f.length:0,growth:12.5});const I={};f.forEach(i=>{const g=new Date(i.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"});I[g]=(I[g]||0)+Number(i.total)}),b(Object.entries(I).map(([i,g])=>({date:i,total:g})));const q={};f.forEach(i=>{i.items.forEach(g=>{const l=g.id||g.product_id;q[l]||(q[l]={name:g.name,count:0,revenue:0}),q[l].count+=g.quantity||1,q[l].revenue+=(g.price||0)*(g.quantity||1)})});const B=Object.values(q).sort((i,g)=>g.count-i.count).slice(0,5);y(B)}catch(c){console.error("Error fetching reports:",c)}finally{R(!1)}};return D?e.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-purple-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 font-black uppercase tracking-widest text-[10px]",children:"Processing Intelligence..."})]})}):e.jsxs("div",{className:"space-y-10 animate-in fade-in duration-700",children:[e.jsxs("div",{className:"flex flex-col xl:flex-row xl:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900 tracking-tighter uppercase",children:"Intelligence Center"}),e.jsx("p",{className:"text-gray-500 font-bold uppercase tracking-widest text-[9px]",children:"Advanced revenue & behavior analytics"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"bg-white p-1 rounded-xl border border-gray-100 flex gap-1 shadow-sm",children:["USD","ZWL","ZAR"].map(c=>e.jsx("button",{onClick:()=>E(c),className:`px-3 py-1.5 rounded-lg text-[10px] font-black transition-all ${j===c?"bg-purple-600 text-white":"text-gray-400 hover:bg-gray-50"}`,children:c},c))}),e.jsxs("select",{value:x,onChange:c=>M(c.target.value),className:"bg-white px-3 py-2 rounded-xl border border-gray-100 shadow-sm text-[10px] font-black uppercase tracking-widest outline-none focus:ring-1 focus:ring-purple-500",children:[e.jsx("option",{value:"7days",children:"7 Days"}),e.jsx("option",{value:"30days",children:"30 Days"}),e.jsx("option",{value:"90days",children:"90 Days"}),e.jsx("option",{value:"custom",children:"Custom Range"})]}),x==="custom"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:C,onChange:c=>p(c.target.value),className:"bg-white px-3 py-2 rounded-xl border border-gray-100 text-[10px] font-bold outline-none ring-purple-500/20 focus:ring-2"}),e.jsx("span",{className:"text-gray-400 font-black text-[10px]",children:"TO"}),e.jsx("input",{type:"date",value:v,onChange:c=>S(c.target.value),className:"bg-white px-3 py-2 rounded-xl border border-gray-100 text-[10px] font-bold outline-none ring-purple-500/20 focus:ring-2"})]}),e.jsx("button",{className:"p-2.5 bg-gray-900 text-white rounded-xl hover:bg-black transition-all active:scale-95 shadow-sm",children:e.jsx(tt,{className:"w-3.5 h-3.5"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(Ne,{title:"Gross Revenue",value:`${j==="USD"?"$":j} ${U.totalRevenue.toLocaleString()}`,trend:15.2,icon:e.jsx(ce,{className:"w-4 h-4 text-purple-600"}),color:"bg-purple-50"}),e.jsx(Ne,{title:"Volume",value:U.totalOrders.toString(),trend:4.1,icon:e.jsx(ge,{className:"w-4 h-4 text-blue-600"}),color:"bg-blue-50"}),e.jsx(Ne,{title:"AOV",value:`${j==="USD"?"$":j} ${U.avgOrderValue.toFixed(1)}`,icon:e.jsx(Ce,{className:"w-4 h-4 text-green-600"}),color:"bg-green-50"}),e.jsx(Ne,{title:"Growth",value:"+12.5%",icon:e.jsx(Be,{className:"w-4 h-4 text-amber-600"}),color:"bg-amber-50"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-[2rem] border border-gray-100 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-black text-gray-900 uppercase tracking-tight",children:"Revenue Matrix"}),e.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Growth performance trend"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-600 rounded-full"}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-gray-500",children:"Gross Sales"})]})]}),e.jsx("div",{className:"h-[280px] w-full",children:e.jsx(Fe,{width:"100%",height:"100%",children:e.jsxs(ut,{data:P,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorTotal",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#8B5CF6",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#8B5CF6",stopOpacity:0})]})}),e.jsx(pt,{strokeDasharray:"3 3",vertical:!1,stroke:"#F8FAFC"}),e.jsx(gt,{dataKey:"date",axisLine:!1,tickLine:!1,tick:{fontSize:9,fontWeight:900,fill:"#94A3B8"},dy:10}),e.jsx(ht,{axisLine:!1,tickLine:!1,tick:{fontSize:9,fontWeight:900,fill:"#94A3B8"},tickFormatter:c=>`${c>=1e3?(c/1e3).toFixed(1)+"k":c}`}),e.jsx(Ve,{contentStyle:{borderRadius:"0.75rem",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)",fontWeight:900,fontSize:"10px"}}),e.jsx(bt,{type:"monotone",dataKey:"total",stroke:"#8B5CF6",strokeWidth:3,fillOpacity:1,fill:"url(#colorTotal)"})]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-black text-gray-900 uppercase tracking-tight mb-6",children:"Top Assets"}),e.jsxs("div",{className:"space-y-4",children:[n.map((c,d)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl hover:bg-gray-50 transition-colors group",children:[e.jsxs("div",{className:"w-9 h-9 rounded-xl bg-purple-600 text-white flex items-center justify-center font-black text-xs shadow-md shrink-0",children:["#",d+1]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-black text-[11px] text-gray-900 uppercase tracking-tight truncate group-hover:text-purple-600 transition-colors",children:c.name}),e.jsxs("p",{className:"text-[8px] font-bold text-gray-400 uppercase tracking-widest",children:[c.count," Sold"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-black text-[11px] text-gray-900",children:["$",c.revenue.toLocaleString()]})})]},d)),n.length===0&&e.jsxs("div",{className:"text-center py-10",children:[e.jsx(X,{className:"w-8 h-8 text-gray-200 mx-auto mb-2"}),e.jsx("p",{className:"text-[9px] font-bold text-gray-300 uppercase",children:"No data"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-black text-gray-900 uppercase tracking-tight mb-6",children:"Revenue Mix"}),e.jsx("div",{className:"h-[200px]",children:e.jsx(Fe,{width:"100%",height:"100%",children:e.jsxs(zt,{children:[e.jsx(Bt,{data:n,cx:"50%",cy:"50%",innerRadius:45,outerRadius:65,paddingAngle:5,dataKey:"revenue",nameKey:"name",children:n.map((c,d)=>e.jsx(Wt,{fill:at[d%at.length]},`cell-${d}`))}),e.jsx(Ve,{})]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-gray-100 shadow-sm flex flex-col justify-center text-center",children:[e.jsx("div",{className:"w-14 h-14 bg-purple-50 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(tt,{className:"w-6 h-6 text-purple-600"})}),e.jsx("h4",{className:"text-lg font-black text-gray-900 uppercase tracking-tight",children:"Export Intel"}),e.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest px-8 mt-1",children:"Download raw transactional data for custom auditing."}),e.jsx("button",{className:"mt-6 mx-auto px-6 py-3 bg-purple-600 text-white rounded-xl font-black uppercase tracking-widest text-[10px] hover:bg-purple-700 transition shadow-md active:scale-95",children:"Download CSV Report"})]})]})]})}function is(){var k;const{profile:r}=se(),[D,R]=a.useState([]),[j,E]=a.useState(null),[x,M]=a.useState([]),[C,p]=a.useState(""),[v,S]=a.useState(!0),[U,u]=a.useState(!1),P=a.useRef(null);a.useEffect(()=>{r!=null&&r.id&&(y(),n())},[r==null?void 0:r.id]),a.useEffect(()=>{j&&(_(j.id),c(j.id))},[j]),a.useEffect(()=>{b()},[x]);const b=()=>{var s;(s=P.current)==null||s.scrollIntoView({behavior:"smooth"})},n=()=>{const s=m.channel("chat_changes").on("postgres_changes",{event:"*",schema:"public",table:"chat_messages"},o=>{j&&o.new&&o.new.conversation_id===j.id&&M(f=>[...f,o.new]),y()}).subscribe();return()=>{m.removeChannel(s)}},y=async()=>{try{const{data:s,error:o}=await m.from("chat_conversations").select(`
          *,
          chat_messages(count)
        `).contains("participant_ids",[r==null?void 0:r.id]).order("last_message_at",{ascending:!1});if(o)throw o;const f=await Promise.all((s||[]).map(async A=>{const I=A.participant_ids.find(i=>i!==(r==null?void 0:r.id)),{data:q}=await m.from("profiles").select("full_name, avatar_url").eq("id",I).single(),{count:B}=await m.from("chat_messages").select("*",{count:"exact",head:!0}).eq("conversation_id",A.id).eq("is_read",!1).neq("sender_id",r==null?void 0:r.id);return{...A,customer_name:(q==null?void 0:q.full_name)||"Anonymous Customer",customer_avatar:q==null?void 0:q.avatar_url,unread_count:B||0}}));R(f)}catch(s){console.error("Error fetching conversations:",s)}finally{S(!1)}},_=async s=>{try{const{data:o,error:f}=await m.from("chat_messages").select("*").eq("conversation_id",s).order("created_at",{ascending:!0});if(f)throw f;M(o||[])}catch(o){console.error("Error fetching messages:",o)}},c=async s=>{await m.from("chat_messages").update({is_read:!0}).eq("conversation_id",s).neq("sender_id",r==null?void 0:r.id),R(o=>o.map(f=>f.id===s?{...f,unread_count:0}:f))},d=async s=>{if(s.preventDefault(),!(!C.trim()||!j||!(r!=null&&r.id))){u(!0);try{const o={conversation_id:j.id,sender_id:r.id,message:C.trim()},{error:f}=await m.from("chat_messages").insert(o).select().single();if(f)throw f;await m.from("chat_conversations").update({last_message:C.trim(),last_message_at:new Date().toISOString()}).eq("id",j.id),p("")}catch(o){console.error("Error sending message:",o)}finally{u(!1)}}};return v?e.jsx("div",{className:"flex items-center justify-center p-20",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"})}):e.jsxs("div",{className:"bg-white rounded-[2.5rem] border border-gray-100 shadow-sm overflow-hidden flex h-[700px]",children:[e.jsxs("div",{className:"w-80 border-r border-gray-50 flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-50",children:[e.jsx("h3",{className:"text-sm font-black text-gray-900 uppercase tracking-widest mb-4",children:"Customer Messages"}),e.jsxs("div",{className:"relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search conversations...",className:"w-full pl-10 pr-4 py-2 bg-gray-50 border-none rounded-xl text-xs focus:ring-2 focus:ring-emerald-500 outline-none"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:D.length===0?e.jsxs("div",{className:"p-10 text-center",children:[e.jsx(Re,{className:"h-10 w-10 text-gray-200 mx-auto mb-4"}),e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"No conversations yet"})]}):e.jsx("div",{className:"divide-y divide-gray-50",children:D.map(s=>{var o;return e.jsxs("button",{onClick:()=>E(s),className:`w-full p-6 flex items-start gap-4 hover:bg-gray-50 transition-all text-left ${(j==null?void 0:j.id)===s.id?"bg-emerald-50/50 border-r-4 border-emerald-500":""}`,children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-2xl flex items-center justify-center shrink-0 uppercase font-black text-emerald-700 shadow-sm",children:(o=s.customer_name)==null?void 0:o[0]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"text-xs font-black text-gray-900 uppercase truncate",children:s.customer_name}),s.unread_count&&s.unread_count>0?e.jsx("span",{className:"w-5 h-5 bg-emerald-600 text-white text-[9px] font-black rounded-full flex items-center justify-center shadow-lg animate-bounce",children:s.unread_count}):e.jsx("span",{className:"text-[8px] font-black text-gray-400 uppercase tracking-tighter",children:new Date(s.last_message_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("p",{className:"text-[10px] font-bold text-gray-500 truncate italic",children:s.last_message})]})]},s.id)})})})]}),e.jsx("div",{className:"flex-1 flex flex-col bg-gray-50/30",children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-6 bg-white border-b border-gray-50 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center uppercase font-black text-emerald-700",children:(k=j.customer_name)==null?void 0:k[0]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-black text-gray-900 uppercase",children:j.customer_name}),e.jsxs("p",{className:"text-[8px] font-black text-emerald-600 uppercase tracking-widest flex items-center gap-1.5",children:[e.jsx(Kt,{className:"w-1.5 h-1.5 fill-current"})," Active Now"]})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-8 space-y-4 custom-scrollbar",children:[x.map(s=>e.jsx("div",{className:`flex ${s.sender_id===(r==null?void 0:r.id)?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[70%] p-4 rounded-3xl text-sm ${s.sender_id===(r==null?void 0:r.id)?"bg-emerald-600 text-white shadow-xl shadow-emerald-200 rounded-tr-none":"bg-white text-gray-700 border border-gray-100 shadow-sm rounded-tl-none"}`,children:[e.jsx("p",{className:"font-bold leading-relaxed",children:s.message}),e.jsx("p",{className:`text-[8px] font-black uppercase tracking-widest mt-2 ${s.sender_id===(r==null?void 0:r.id)?"text-emerald-100":"text-gray-400"}`,children:new Date(s.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},s.id)),e.jsx("div",{ref:P})]}),e.jsx("div",{className:"p-6 bg-white border-t border-gray-50",children:e.jsxs("form",{onSubmit:d,className:"flex items-center gap-4",children:[e.jsx("input",{type:"text",value:C,onChange:s=>p(s.target.value),placeholder:"Type your message...",className:"flex-1 bg-gray-50 border-none rounded-2xl px-6 py-4 text-sm focus:ring-2 focus:ring-emerald-500 outline-none transition-all placeholder:font-bold"}),e.jsx("button",{type:"submit",disabled:U||!C.trim(),className:"p-4 bg-emerald-600 text-white rounded-2xl hover:bg-emerald-700 transition shadow-lg shadow-emerald-200 disabled:opacity-50 active:scale-95 group",children:e.jsx(Gt,{className:"h-5 w-5 transition-transform group-hover:translate-x-1 group-hover:-translate-y-1"})})]})})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-20 text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-white rounded-[2rem] flex items-center justify-center shadow-2xl shadow-emerald-900/10 mb-8",children:e.jsx(Re,{className:"h-12 w-12 text-emerald-600"})}),e.jsx("h3",{className:"text-xl font-black text-gray-900 uppercase tracking-tight mb-2",children:"Select a Conversation"}),e.jsx("p",{className:"text-xs text-gray-500 font-bold max-w-xs uppercase tracking-widest leading-loose",children:"Choose a customer from the left to start chatting and managing inquiries."})]})})]})}function Hs(){var _,c;const{profile:r,signOut:D}=se(),[R,j]=nt(),E=R.get("tab")||"overview",[x,M]=a.useState(E),[C,p]=a.useState(!0);a.useEffect(()=>{const d=R.get("tab");d&&d!==x&&M(d)},[R]);const v=d=>{const[k,s]=d.split("?");M(k);const o={tab:k};s&&new URLSearchParams(s).forEach((A,I)=>{o[I]=A}),j(o)},[S,U]=a.useState({totalSales:0,totalOrders:0,totalProducts:0,pendingOrders:0,walletBalance:0,rating:0,lowStockItems:0,outOfStockItems:0,dailyRevenue:[]}),[u,P]=a.useState(null),[b,n]=a.useState([]),y=async()=>{var d;if(r!=null&&r.id){p(!0);try{const{data:k,error:s}=await m.from("vendor_profiles").select("*").eq("user_id",r.id).maybeSingle();if(s)throw s;if(k){P(k);const{data:o}=await m.from("vendor_subscriptions").select("*, vendor_packages(*)").eq("vendor_id",r.id).maybeSingle(),[f,A,I]=await Promise.all([m.from("orders").select("*").eq("vendor_id",k.id).order("created_at",{ascending:!1}),m.from("products").select("*").eq("vendor_id",k.id),m.from("wallets").select("balance").eq("user_id",r.id).maybeSingle()]),q=f.data||[],B=A.data||[];o!=null&&o.vendor_packages&&P(V=>V?{...V,vendor_packages:o.vendor_packages}:null);const i=q.filter(V=>V.status!=="cancelled").reduce((V,h)=>V+Number(h.total),0),g=q.filter(V=>["pending","processing"].includes(V.status)).length,l=B.filter(V=>V.stock_quantity>0&&V.stock_quantity<=10).length,L=B.filter(V=>V.stock_quantity===0).length,W=new Date;W.setDate(W.getDate()-30);const z={};q.filter(V=>new Date(V.created_at)>=W).forEach(V=>{const h=new Date(V.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"});z[h]=(z[h]||0)+Number(V.total)}),U({totalSales:i,totalOrders:q.length,totalProducts:B.length,pendingOrders:g,walletBalance:((d=I.data)==null?void 0:d.balance)||0,rating:k.rating||0,lowStockItems:l,outOfStockItems:L,dailyRevenue:Object.entries(z).map(([V,h])=>({date:V,total:h}))}),n(q.slice(0,5))}}catch(k){console.error("Error fetching vendor data",k)}finally{p(!1)}}};return a.useEffect(()=>{r!=null&&r.id&&y()},[r==null?void 0:r.id]),C?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"})}):u?e.jsx(Xt,{activeTab:x,onTabChange:v,shopName:u==null?void 0:u.shop_name,hasPosAccess:((_=u==null?void 0:u.vendor_packages)==null?void 0:_.has_pos_access)||Array.isArray(u==null?void 0:u.vendor_packages)&&((c=u.vendor_packages[0])==null?void 0:c.has_pos_access),children:e.jsxs("div",{className:"max-w-6xl mx-auto pb-10",children:[x==="overview"&&e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900 uppercase tracking-tight",children:"Dashboard Overview"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Snapshot of your shop's performance and inventory health."})]}),(u==null?void 0:u.kyc_status)!=="approved"&&(u==null?void 0:u.kyc_status)!=="pending"&&e.jsxs("div",{className:"flex-1 max-w-xl bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-900/30 rounded-2xl p-4 flex items-center justify-between gap-4 animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3 text-blue-800 dark:text-blue-400",children:[e.jsx(ke,{size:20,className:"shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-black uppercase tracking-wider",children:"KYC Verification Required"}),e.jsx("p",{className:"text-[10px] font-bold opacity-80",children:"Submit your documents to unlock full platform trust and faster payouts."})]})]}),e.jsx("button",{onClick:()=>v("kyc"),className:"whitespace-nowrap bg-blue-800 text-white text-[9px] font-black uppercase tracking-widest px-4 py-2 rounded-lg hover:bg-blue-900 transition-colors",children:"Submit Now"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:y,className:"p-2.5 bg-white border border-gray-100 rounded-xl text-gray-400 hover:text-emerald-600 hover:border-emerald-100 transition-all shadow-sm",children:e.jsx(X,{className:"w-5 h-5"})}),e.jsxs("button",{onClick:()=>v("products?add=true"),className:"flex items-center gap-2 bg-emerald-600 text-white px-5 py-2.5 rounded-xl text-xs font-black uppercase tracking-widest hover:bg-emerald-700 transition shadow-lg shadow-emerald-200 active:scale-95",children:[e.jsx(_e,{className:"w-4 h-4"}),"Add Product"]})]})]}),(S.lowStockItems>0||S.outOfStockItems>0||S.pendingOrders>0)&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[S.pendingOrders>0&&e.jsxs("div",{className:"bg-blue-50 border border-blue-100 p-4 rounded-2xl flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center shrink-0",children:e.jsx(ge,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] font-black text-blue-400 uppercase tracking-widest leading-none mb-1",children:"Attention Required"}),e.jsxs("p",{className:"text-xs font-bold text-blue-900",children:[S.pendingOrders," Orders need processing"]})]}),e.jsx("button",{onClick:()=>v("orders"),className:"text-[10px] font-black text-blue-600 uppercase tracking-widest hover:underline whitespace-nowrap",children:"View"})]}),S.lowStockItems>0&&e.jsxs("div",{className:"bg-amber-50 border border-amber-100 p-4 rounded-2xl flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center shrink-0",children:e.jsx(ne,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] font-black text-amber-400 uppercase tracking-widest leading-none mb-1",children:"Stock Warning"}),e.jsxs("p",{className:"text-xs font-bold text-amber-900",children:[S.lowStockItems," Items running low"]})]}),e.jsx("button",{onClick:()=>v("products"),className:"text-[10px] font-black text-amber-600 uppercase tracking-widest hover:underline whitespace-nowrap",children:"Restock"})]}),S.outOfStockItems>0&&e.jsxs("div",{className:"bg-red-50 border border-red-100 p-4 rounded-2xl flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center shrink-0",children:e.jsx(Te,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] font-black text-red-400 uppercase tracking-widest leading-none mb-1",children:"Critical Alert"}),e.jsxs("p",{className:"text-xs font-bold text-red-900",children:[S.outOfStockItems," Products out of stock"]})]}),e.jsx("button",{onClick:()=>v("products"),className:"text-[10px] font-black text-red-600 uppercase tracking-widest hover:underline whitespace-nowrap",children:"Check"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm relative overflow-hidden group hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-emerald-50 rounded-full -mr-12 -mt-12 group-hover:scale-150 transition-transform duration-700"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"bg-emerald-50 w-12 h-12 rounded-2xl flex items-center justify-center mb-6 shadow-sm border border-emerald-100",children:e.jsx(ce,{className:"w-6 h-6 text-emerald-600"})}),e.jsxs("div",{className:"text-3xl font-black text-gray-900 tracking-tight tabular-nums",children:["$",S.totalSales.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mt-2",children:"Gross Revenue"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm relative overflow-hidden group hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-blue-50 rounded-full -mr-12 -mt-12 group-hover:scale-150 transition-transform duration-700"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"bg-blue-50 w-12 h-12 rounded-2xl flex items-center justify-center mb-6 shadow-sm border border-blue-100",children:e.jsx(ge,{className:"w-6 h-6 text-blue-600"})}),e.jsx("div",{className:"text-3xl font-black text-gray-900 tracking-tight tabular-nums",children:S.totalOrders}),e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mt-2",children:"Lifetime Orders"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm relative overflow-hidden group hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-purple-50 rounded-full -mr-12 -mt-12 group-hover:scale-150 transition-transform duration-700"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"bg-purple-50 w-12 h-12 rounded-2xl flex items-center justify-center mb-6 shadow-sm border border-purple-100",children:e.jsx(Te,{className:"w-6 h-6 text-purple-600"})}),e.jsx("div",{className:"text-3xl font-black text-gray-900 tracking-tight tabular-nums",children:S.totalProducts}),e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mt-2",children:"Active Catalog"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm relative overflow-hidden group hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-amber-50 rounded-full -mr-12 -mt-12 group-hover:scale-150 transition-transform duration-700"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"bg-amber-50 w-12 h-12 rounded-2xl flex items-center justify-center mb-6 shadow-sm border border-amber-100",children:e.jsx(oe,{className:"w-6 h-6 text-amber-600"})}),e.jsxs("div",{className:"text-3xl font-black text-gray-900 tracking-tight tabular-nums",children:["$",S.walletBalance.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mt-2",children:"Withdrawable Funds"})]})]})]}),e.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-gray-900 uppercase tracking-tight",children:"Financial Performance"}),e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"Revenue trend for the past 30 days"})]}),e.jsxs("button",{onClick:()=>v("reports"),className:"flex items-center gap-2 text-[10px] font-black text-emerald-600 uppercase tracking-widest hover:underline",children:["View Full Report ",e.jsx(Ce,{className:"w-3 h-3"})]})]}),e.jsx("div",{className:"h-[300px] w-full",children:e.jsx(Fe,{width:"100%",height:"100%",children:e.jsxs(ut,{data:S.dailyRevenue,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"dashboardRevenue",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]})}),e.jsx(pt,{strokeDasharray:"3 3",vertical:!1,stroke:"#F1F5F9"}),e.jsx(gt,{dataKey:"date",axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:900,fill:"#94A3B8"},dy:10}),e.jsx(ht,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:900,fill:"#94A3B8"},tickFormatter:d=>`$${d}`}),e.jsx(Ve,{contentStyle:{borderRadius:"1rem",border:"none",boxShadow:"0 20px 25px -5px rgb(0 0 0 / 0.1)",fontWeight:900}}),e.jsx(bt,{type:"monotone",dataKey:"total",stroke:"#10B981",strokeWidth:4,fillOpacity:1,fill:"url(#dashboardRevenue)"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-3xl border border-gray-100 shadow-sm overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1.5 h-6 bg-emerald-600 rounded-full"}),e.jsx("h3",{className:"font-black text-gray-900 text-sm uppercase tracking-tight",children:"Recent Orders"})]}),e.jsx("button",{onClick:()=>v("orders"),className:"text-[10px] font-black text-emerald-600 hover:text-emerald-700 uppercase tracking-widest",children:"See All Orders"})]}),e.jsx("div",{className:"overflow-x-auto flex-1",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50/30",children:[e.jsx("th",{className:"px-6 py-4 text-[9px] font-black text-gray-400 uppercase tracking-widest",children:"Order ID"}),e.jsx("th",{className:"px-6 py-4 text-[9px] font-black text-gray-400 uppercase tracking-widest",children:"Total"}),e.jsx("th",{className:"px-6 py-4 text-[9px] font-black text-gray-400 uppercase tracking-widest",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-[9px] font-black text-gray-400 uppercase tracking-widest text-right",children:"Activity"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-6 py-12 text-center text-[11px] font-bold text-gray-400 uppercase",children:"No recent transactions"})}):b.map(d=>e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors group",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"font-black text-gray-900 tabular-nums group-hover:text-emerald-600 transition-colors uppercase",children:["#",d.order_number]}),e.jsx("div",{className:"text-[9px] text-gray-400 font-bold uppercase mt-0.5",children:new Date(d.created_at).toLocaleDateString()})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"text-xs font-black text-gray-900 tabular-nums",children:["$",d.total]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-[9px] font-black uppercase tracking-widest bg-gray-100 text-gray-600 border border-gray-200",children:d.status})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("div",{className:"text-[9px] font-black text-emerald-600 uppercase tracking-widest bg-emerald-50 px-2 py-0.5 rounded-full inline-block",children:"Active"})})]},d.id))})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-3xl p-6 text-gray-900 shadow-xl shadow-gray-200 relative overflow-hidden border border-gray-100",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-5",children:e.jsx(he,{className:"w-24 h-24"})}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h3",{className:"text-xl font-black uppercase tracking-tight mb-2",children:"Shop Profile"}),e.jsxs("p",{className:"text-xs text-gray-500 font-medium mb-6",children:["Your store's visibility: ",e.jsx("span",{className:"text-emerald-500 font-black",children:"HIGH"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-2xl border border-gray-200",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Support Rating"}),e.jsxs("span",{className:"text-sm font-black text-emerald-600",children:[S.rating.toFixed(1),"/5.0"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-2xl border border-gray-200",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Join Date"}),e.jsx("span",{className:"text-xs font-bold text-gray-900",children:new Date(u.created_at).toLocaleDateString(void 0,{month:"short",year:"numeric"})})]})]}),e.jsx("button",{onClick:()=>v("settings"),className:"w-full mt-6 bg-emerald-600 hover:bg-emerald-700 text-white font-black uppercase tracking-widest text-[10px] py-4 rounded-2xl transition-all shadow-lg shadow-emerald-200",children:"Edit Shop Profile"})]})]}),e.jsxs("div",{className:"bg-emerald-50 rounded-3xl p-6 border border-emerald-100",children:[e.jsx("h4",{className:"text-[10px] font-black text-emerald-600 uppercase tracking-widest mb-4",children:"Quick Tip"}),e.jsx("p",{className:"text-xs text-emerald-900 font-bold leading-relaxed italic",children:'"Updating your product stock regularly helps improve your visibility in customer search results."'})]})]})]})]}),x==="wallet"&&e.jsx(Qt,{}),x==="products"&&e.jsx(es,{}),x==="orders"&&e.jsx(ts,{}),x==="settings"&&e.jsx(Jt,{}),x==="packages"&&e.jsx(ss,{}),x==="pos"&&e.jsx(Tt,{onTabChange:v}),x==="kyc"&&e.jsx(as,{}),x==="refunds"&&e.jsx(rs,{}),x==="ads"&&e.jsx(ls,{onTabChange:v}),x==="reports"&&e.jsx(ns,{}),x==="messages"&&e.jsx(is,{})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-slate-900 rounded-2xl shadow-xl p-8 text-center border border-gray-100 dark:border-slate-800",children:[e.jsx(he,{className:"w-16 h-16 mx-auto text-emerald-600 mb-6"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Vendor Setup Required"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-8",children:"Your vendor profile is not fully set up. Please complete your registration to access the dashboard."}),e.jsx(ze,{to:"/vendor/setup",className:"block w-full bg-emerald-600 text-white font-bold py-3 rounded-xl hover:bg-emerald-700 transition shadow-lg shadow-emerald-500/20 active:scale-95",children:"Complete Setup"}),e.jsx("button",{onClick:D,className:"mt-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-sm",children:"Sign Out"})]})})}export{Hs as VendorDashboard};
