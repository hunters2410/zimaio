import{g as z,r as l,h as Q,i as T,b as U,a as V,j as e,C as v,d as N,L as C,H as G,s as d}from"./index-T9wcIP7k.js";import{F as S}from"./funnel-DSb2S8Kf.js";import{S as _}from"./shopping-bag-BM34hV8d.js";function X(){const[h,u]=z(),g=h.get("category"),[P,L]=l.useState([]),[b,F]=l.useState([]),[i,A]=l.useState(null),[$,q]=l.useState(!0),[o,p]=l.useState(null),[f,D]=l.useState(""),{formatPrice:R}=Q(),{calculatePrice:k}=T(),[x,n]=l.useState(!1),{isInWishlist:y,toggleWishlist:W}=U(),{addToCart:H}=V();l.useEffect(()=>{(async()=>{const[t,s,r]=await Promise.all([d.from("products").select("*").eq("is_active",!0).order("created_at",{ascending:!1}),d.from("categories").select("*").order("name"),d.from("vendor_ads").select("*").eq("status","active").eq("ad_type","sidebar").lte("start_date",new Date().toISOString()).gte("end_date",new Date().toISOString()).limit(1).maybeSingle()]);if(s.data&&(F(s.data),g)){const c=s.data.find(O=>O.slug===g);c&&p(c.id)}t.data&&L(t.data),r.data&&(A(r.data),await d.rpc("increment_ad_impressions",{ad_ids:[r.data.id]})),q(!1)})()},[g]);const m=(a,t)=>{p(a),u(t?{category:t}:{})},w=h.get("search"),j=P.filter(a=>o&&a.category_id!==o?!1:w?w.toLowerCase().trim().split(/\s+/).filter(r=>r.length>0).every(r=>{if(a.name.toLowerCase().includes(r)||a.slug&&a.slug.toLowerCase().includes(r)||a.description&&a.description.toLowerCase().includes(r))return!0;if(a.tags){if(Array.isArray(a.tags)){if(a.tags.some(c=>c.toLowerCase().includes(r)))return!0}else if(typeof a.tags=="string"&&a.tags.toLowerCase().includes(r))return!0}return!1}):!0),B=b.filter(a=>a.name.toLowerCase().includes(f.toLowerCase())),E=async a=>{await d.rpc("increment_ad_clicks",{ad_id:a})},I=a=>{const t=b.find(s=>s.id===a);t&&m(t.id,t.slug)};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-900 transition-colors duration-300",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 border-b border-gray-100 dark:border-slate-700 transition-colors duration-300",children:e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsx("h1",{className:"text-2xl font-black text-gray-900 dark:text-white mb-1 uppercase tracking-tight",children:"All Products"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium uppercase tracking-widest",children:"Browse our entire collection"})]})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("div",{className:"lg:hidden mb-4",children:e.jsxs("button",{onClick:()=>n(!x),className:"w-full flex items-center justify-between px-4 py-3 bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 rounded-xl shadow-sm text-sm font-bold text-gray-700 dark:text-gray-200 active:scale-[0.99] transition-transform",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"h-4 w-4 text-emerald-600 dark:text-emerald-400"}),"Filters & Categories"]}),e.jsx(v,{className:`h-4 w-4 transition-transform duration-300 ${x?"rotate-180":""}`})]})}),e.jsxs("aside",{className:`lg:w-64 space-y-6 lg:block ${x?"block":"hidden"}`,children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-3xl border border-gray-100 dark:border-slate-700 shadow-sm transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-sm font-black text-gray-900 dark:text-white uppercase tracking-widest flex items-center",children:[e.jsx(S,{className:"h-4 w-4 mr-2 text-emerald-600 dark:text-emerald-400"}),"Filter by Category"]}),e.jsx("button",{onClick:()=>n(!1),className:"lg:hidden text-gray-400 hover:text-gray-600",children:e.jsx(v,{className:"h-4 w-4 rotate-180"})})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(N,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-400 dark:text-gray-500"}),e.jsx("input",{type:"text",placeholder:"Find a category...",className:"w-full pl-9 pr-3 py-2 bg-gray-50 dark:bg-slate-700 border-none rounded-xl text-[10px] font-black uppercase tracking-widest focus:ring-2 focus:ring-emerald-500 outline-none transition-all text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500",value:f,onChange:a=>D(a.target.value)})]}),e.jsxs("div",{className:"space-y-1 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:[e.jsx("button",{onClick:()=>{m(null),n(!1)},className:`w-full text-left px-4 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${o===null?"bg-emerald-600 text-white shadow-lg shadow-emerald-200 dark:shadow-emerald-900/20":"text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:"All Products"}),B.map(a=>e.jsx("button",{onClick:()=>{m(a.id,a.slug),n(!1)},className:`w-full text-left px-4 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${o===a.id?"bg-emerald-600 text-white shadow-lg shadow-emerald-200 dark:shadow-emerald-900/20":"text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:a.name},a.id))]})]}),i&&e.jsxs("a",{href:i.link_url,target:"_blank",rel:"noopener noreferrer",onClick:()=>E(i.id),className:"block bg-white dark:bg-slate-800 p-2 rounded-xl shadow-sm border border-gray-100 dark:border-slate-700 group overflow-hidden",children:[e.jsxs("div",{className:"relative aspect-[4/5] rounded-lg overflow-hidden mb-3",children:[e.jsx("img",{src:i.image_url,alt:i.title,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}),e.jsx("div",{className:"absolute top-2 right-2 px-2 py-1 bg-black/50 backdrop-blur-md rounded text-white text-[8px] font-black uppercase tracking-widest",children:"Sponsored"})]}),e.jsx("h4",{className:"font-bold text-gray-900 dark:text-white text-sm line-clamp-1 px-2 mb-1 uppercase tracking-tight",children:i.title}),e.jsx("p",{className:"text-[10px] text-green-600 dark:text-green-400 font-black px-2 uppercase tracking-widest",children:"Shop Now"})]})]}),e.jsxs("main",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("p",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-bold uppercase tracking-[0.2em]",children:[j.length," Premium results found"]}),e.jsxs("select",{className:"px-4 py-2 border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-gray-700 dark:text-gray-200 rounded-xl text-[10px] font-black uppercase tracking-widest focus:ring-2 focus:ring-emerald-500 outline-none",children:[e.jsx("option",{children:"Sort by: Featured"}),e.jsx("option",{children:"Price: Low to High"}),e.jsx("option",{children:"Price: High to Low"}),e.jsx("option",{children:"Newest"}),e.jsx("option",{children:"Best Rating"})]})]}),$?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-5 gap-4",children:[...Array(10)].map((a,t)=>e.jsx("div",{className:"bg-gray-100 dark:bg-slate-800 rounded-2xl h-64 animate-pulse border border-gray-50 dark:border-slate-700"},t))}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-6",children:j.map(a=>{var t;return e.jsxs("div",{className:"group bg-white dark:bg-slate-800 rounded-3xl border border-gray-100 dark:border-slate-700 p-3 hover:shadow-2xl hover:shadow-emerald-900/5 transition-all duration-500 hover:-translate-y-1 relative",children:[e.jsx(C,{to:`/products/${a.slug}`,className:"block",children:e.jsxs("div",{className:"relative aspect-square rounded-xl overflow-hidden bg-gray-50 dark:bg-slate-700 mb-3",children:[(t=a.images)!=null&&t[0]?e.jsx("img",{src:a.images[0],alt:a.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(_,{className:"w-8 h-8 text-gray-200 dark:text-slate-500"})}),e.jsx("button",{onClick:s=>{s.preventDefault(),s.stopPropagation(),W(a.id)},className:`absolute top-2 right-2 p-1.5 rounded-full backdrop-blur-md transition-all z-10 ${y(a.id)?"bg-rose-500 text-white shadow-lg":"bg-white/80 dark:bg-slate-800/80 text-gray-400 hover:text-rose-500 border border-gray-100 dark:border-slate-700"}`,children:e.jsx(G,{className:`w-3 h-3 ${y(a.id)?"fill-current":""}`})})]})}),e.jsxs("div",{className:"px-1 pb-1",children:[e.jsx(C,{to:`/products/${a.slug}`,children:e.jsx("h3",{className:"text-[11px] font-bold text-gray-900 dark:text-white group-hover:text-emerald-600 transition-colors line-clamp-1 uppercase tracking-tight mb-2",children:a.name})}),e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-50 dark:border-slate-700 pt-2",children:[e.jsx("span",{className:"text-sm font-black text-emerald-600 dark:text-emerald-400",children:R(k(a.base_price).total,a.currency_code||"USD")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:s=>{s.preventDefault(),I(a.category_id)},title:"Find similar products",className:"p-1 px-2 border border-gray-100 dark:border-slate-600 rounded-lg hover:bg-emerald-600 hover:text-white dark:text-gray-400 dark:hover:text-white transition-all",children:e.jsx(N,{className:"h-3 w-3"})}),e.jsx("button",{onClick:s=>{var r;s.preventDefault(),H({id:a.id,name:a.name,price:k(a.base_price).total,image:((r=a.images)==null?void 0:r[0])||"",vendor_id:a.vendor_id,vendor:"Vendor",base_price:a.base_price,quantity:1})},className:"p-1 px-2 border border-gray-100 dark:border-slate-600 rounded-lg group-hover:bg-emerald-600 group-hover:text-white dark:text-gray-400 transition-all",children:e.jsx(_,{className:"h-3 w-3"})})]})]})]})]},a.id)})})]})]})})]})}export{X as ProductsPage};
