import{b as y,r as d,s as h,j as e,D as _}from"./index-BktnpWS0.js";import{R as S}from"./refresh-ccw-CeFNCSic.js";import{T as D}from"./trending-up-wuknMfwd.js";import{C as f}from"./clock-Ep4hhKF1.js";import{C}from"./check-t-U1Tl8Z.js";import{X as E}from"./x-Be8cuiWM.js";function A(){const{user:s}=y(),[r,w]=d.useState(null),[b,k]=d.useState([]),[o,n]=d.useState(!0),[j,x]=d.useState(!1),[W,p]=d.useState(null),[a,c]=d.useState({amount:"",currency:"USD",method:"",details:""});d.useEffect(()=>{s&&m()},[s]);const m=async()=>{n(!0);try{const{data:t,error:l}=await h.from("wallets").select("*").eq("user_id",s==null?void 0:s.id).single();t&&w({id:t.id,balance_usd:Number(t.balance_usd)||0,balance_zig:Number(t.balance_zig)||0,total_earned:Number(t.total_earned)||0,total_withdrawn:Number(t.total_withdrawn)||0});const{data:u,error:i}=await h.from("withdrawal_requests").select("*").eq("vendor_id",s==null?void 0:s.id).order("requested_at",{ascending:!1});if(i)throw i;k(u||[])}catch(t){console.error(t)}finally{n(!1)}},N=async t=>{if(t.preventDefault(),!!r){n(!0);try{const l=parseFloat(a.amount),u=a.currency==="USD"?r.balance_usd:r.balance_zig;if(l>u)throw new Error("Insufficient funds");if(l<10)throw new Error("Minimum withdrawal is 10");const i=l*.02,v=l-i,{error:g}=await h.from("withdrawal_requests").insert([{vendor_id:s==null?void 0:s.id,amount:l,currency:a.currency,withdrawal_charges:i,net_amount:v,payment_method:a.method,account_details:{details:a.details},status:"pending"}]);if(g)throw g;p({type:"success",text:"Request submitted for audit"}),x(!1),m()}catch(l){p({type:"error",text:l.message})}finally{n(!1)}}};return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-10 pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-black text-slate-900 dark:text-white uppercase tracking-tighter",children:"Logistics Wallet"}),e.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-xs mt-1",children:"Earnings & Settlement Manager"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:m,className:"p-3 bg-white dark:bg-slate-800 border-2 border-slate-100 rounded-2xl shadow-sm",children:e.jsx(S,{className:`w-5 h-5 ${o?"animate-spin":""}`})}),e.jsx("button",{onClick:()=>x(!0),className:"px-8 py-4 bg-slate-900 text-white dark:bg-white dark:text-slate-900 rounded-2xl font-black text-xs uppercase tracking-[0.2em] hover:scale-105 active:scale-95 transition-all shadow-xl",children:"Withdraw Funds"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-indigo-950 to-slate-900 rounded-[2.5rem] p-10 text-white shadow-2xl relative overflow-hidden group border-4 border-white/10",children:e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-8",children:[e.jsx("div",{className:"p-2 bg-white/10 rounded-xl",children:e.jsx(_,{className:"w-5 h-5 text-indigo-400"})}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-indigo-300",children:"Available USD"})]}),e.jsxs("span",{className:"text-5xl font-black tracking-tighter",children:["$",r==null?void 0:r.balance_usd.toLocaleString(void 0,{minimumFractionDigits:2})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-[2.5rem] p-10 border-2 border-slate-50 dark:border-slate-700 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-8",children:[e.jsx("div",{className:"p-2 bg-emerald-50 dark:bg-emerald-900/20 rounded-xl",children:e.jsx(D,{className:"w-5 h-5 text-emerald-600"})}),e.jsx("span",{className:"text-[10px] font-black text-slate-400 tracking-widest uppercase",children:"Lifetime Earnings"})]}),e.jsxs("span",{className:"text-4xl font-black text-slate-900 dark:text-white tracking-tighter",children:["$",r==null?void 0:r.total_earned.toLocaleString()]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-[2.5rem] p-10 border-2 border-slate-50 dark:border-slate-700 shadow-sm relative",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-8",children:[e.jsx("div",{className:"p-2 bg-amber-50 dark:bg-amber-900/20 rounded-xl",children:e.jsx(f,{className:"w-5 h-5 text-amber-600"})}),e.jsx("span",{className:"text-[10px] font-black text-slate-400 tracking-widest uppercase",children:"Pending Clearance"})]}),e.jsxs("span",{className:"text-4xl font-black text-slate-900 dark:text-white tracking-tighter",children:["0.00 ",e.jsx("span",{className:"text-xs",children:"USD"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-[3rem] border-2 border-slate-50 dark:border-slate-700 shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"p-10 border-b-2 border-slate-50 dark:border-slate-800 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xs font-black text-slate-900 dark:text-white uppercase tracking-[0.3em]",children:"Withdrawal Queue & History"}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-slate-50 dark:bg-slate-900 rounded-full text-[9px] font-black uppercase tracking-widest text-slate-400",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"}),"Live Updates"]})]}),e.jsxs("div",{className:"divide-y-2 divide-slate-50 dark:divide-slate-800",children:[b.map(t=>e.jsxs("div",{className:"p-8 flex items-center justify-between group hover:bg-slate-50/50 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:`p-4 rounded-2xl shadow-sm ${t.status==="completed"?"bg-emerald-50 text-emerald-600":"bg-amber-50 text-amber-600"}`,children:t.status==="completed"?e.jsx(C,{size:20}):e.jsx(f,{size:20})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsxs("span",{className:"text-lg font-black text-slate-900 dark:text-white tracking-tight",children:["$",t.amount," ",t.currency]}),e.jsx("span",{className:`text-[8px] font-black uppercase tracking-widest px-2 py-0.5 rounded-md ${t.status==="completed"?"bg-emerald-100 text-emerald-700":"bg-amber-100 text-amber-700"}`,children:t.status})]}),e.jsxs("p",{className:"text-[9px] font-bold text-slate-400 uppercase tracking-widest",children:["Requested on ",new Date(t.requested_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Settlement Net"}),e.jsxs("p",{className:"text-sm font-black text-slate-900 dark:text-white tracking-tight",children:["$",t.net_amount.toFixed(2)]})]})]},t.id)),b.length===0&&e.jsx("div",{className:"p-20 text-center",children:e.jsx("p",{className:"text-[10px] font-black text-slate-300 uppercase tracking-[0.5em]",children:"No settlement history found"})})]})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-slate-950/40 backdrop-blur-md flex items-center justify-center z-50 p-6 animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-[3rem] shadow-2xl max-w-lg w-full overflow-hidden border border-white/20",children:[e.jsxs("div",{className:"p-10 border-b border-slate-100 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-900/50 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-slate-900 dark:text-white uppercase tracking-tighter",children:"Withdraw Earnings"}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1",children:"Funds will be audited before transmission"})]}),e.jsx("button",{onClick:()=>x(!1),className:"p-2 hover:bg-red-50 text-slate-400 hover:text-red-500 rounded-full transition-colors",children:e.jsx(E,{})})]}),e.jsxs("form",{onSubmit:N,className:"p-10 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Asset"}),e.jsxs("select",{required:!0,value:a.currency,onChange:t=>c({...a,currency:t.target.value}),className:"w-full bg-slate-50 dark:bg-slate-900 border-2 border-slate-100 dark:border-slate-800 p-4 rounded-2xl font-black text-xs uppercase focus:border-indigo-500 outline-none",children:[e.jsx("option",{value:"USD",children:"USD ($)"}),e.jsx("option",{value:"ZIG",children:"ZIG"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Amount"}),e.jsx("input",{type:"number",required:!0,placeholder:"0.00",value:a.amount,onChange:t=>c({...a,amount:t.target.value}),className:"w-full bg-slate-50 dark:bg-slate-900 border-2 border-slate-100 dark:border-slate-800 p-4 rounded-2xl font-black text-sm focus:border-indigo-500 outline-none"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Settlement Path"}),e.jsxs("select",{required:!0,value:a.method,onChange:t=>c({...a,method:t.target.value}),className:"w-full bg-slate-50 dark:bg-slate-900 border-2 border-slate-100 dark:border-slate-800 p-4 rounded-2xl font-black text-xs uppercase focus:border-indigo-500 outline-none",children:[e.jsx("option",{value:"",children:"Select Method"}),e.jsx("option",{value:"ecocash",children:"EcoCash / Mobile Money"}),e.jsx("option",{value:"bank",children:"Direct Bank Transfer"}),e.jsx("option",{value:"innbucks",children:"Innbucks"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Destination Details"}),e.jsx("textarea",{required:!0,rows:3,placeholder:"Account number, phone number, or IBAN...",value:a.details,onChange:t=>c({...a,details:t.target.value}),className:"w-full bg-slate-50 dark:bg-slate-900 border-2 border-slate-100 dark:border-slate-800 p-4 rounded-2xl font-medium text-sm focus:border-indigo-500 outline-none resize-none"})]}),e.jsx("button",{type:"submit",disabled:o||!a.amount,className:"w-full py-5 bg-slate-900 text-white dark:bg-white dark:text-slate-900 rounded-3xl font-black text-xs uppercase tracking-[0.3em] hover:scale-105 active:scale-95 transition-all shadow-xl disabled:opacity-50",children:o?"Submitting...":"Commit Withdrawal"})]})]})})]})}export{A as LogisticWallet};
