import{e as j,r,s as d,j as e,o as c}from"./index-T9wcIP7k.js";import{P as x}from"./plus-B2DFtXvD.js";import{C as f}from"./clock-Hzc8pPp_.js";import{C as N}from"./circle-check-big-BYTb-izI.js";function T(){const{user:t,profile:v}=j(),[i,m]=r.useState([]),[u,n]=r.useState(!1),[a,l]=r.useState({subject:"",category:"general",message:""}),[h,g]=r.useState(!0);r.useEffect(()=>{t&&o()},[t]);const o=async()=>{const{data:s}=await d.from("support_tickets").select("*").eq("user_id",t==null?void 0:t.id).order("created_at",{ascending:!1});s&&m(s),g(!1)},p=async s=>{if(s.preventDefault(),!t)return;const b="TKT-"+Math.random().toString(36).substr(2,9).toUpperCase(),{error:y}=await d.from("support_tickets").insert({user_id:t.id,ticket_number:b,subject:a.subject,category:a.category,status:"open",priority:"medium"});y||(l({subject:"",category:"general",message:""}),n(!1),o())};return t?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-cyan-600 to-green-600 text-white py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Support Center"}),e.jsx("p",{className:"text-cyan-100",children:"We're here to help you"})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"My Support Tickets"}),e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center px-4 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 transition",children:[e.jsx(x,{className:"h-5 w-5 mr-2"}),"New Ticket"]})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full p-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Create Support Ticket"}),e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:a.subject,onChange:s=>l({...a,subject:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),e.jsxs("select",{value:a.category,onChange:s=>l({...a,category:s.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",children:[e.jsx("option",{value:"general",children:"General Inquiry"}),e.jsx("option",{value:"order",children:"Order Issue"}),e.jsx("option",{value:"payment",children:"Payment Issue"}),e.jsx("option",{value:"technical",children:"Technical Support"}),e.jsx("option",{value:"account",children:"Account Issue"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message"}),e.jsx("textarea",{value:a.message,onChange:s=>l({...a,message:s.target.value}),rows:6,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-cyan-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{type:"submit",className:"flex-1 py-3 bg-cyan-600 text-white rounded-lg font-semibold hover:bg-cyan-700 transition",children:"Submit Ticket"}),e.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-semibold hover:bg-gray-300 transition",children:"Cancel"})]})]})]})}),h?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-600"})}):i.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[e.jsx(c,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Support Tickets"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You haven't created any support tickets yet."}),e.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center px-6 py-3 bg-cyan-600 text-white rounded-lg hover:bg-cyan-700 transition",children:[e.jsx(x,{className:"h-5 w-5 mr-2"}),"Create Your First Ticket"]})]}):e.jsx("div",{className:"space-y-4",children:i.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:s.subject}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Ticket #",s.ticket_number]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[s.status==="open"&&e.jsxs("span",{className:"flex items-center px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm",children:[e.jsx(f,{className:"h-4 w-4 mr-1"}),"Open"]}),s.status==="in_progress"&&e.jsxs("span",{className:"flex items-center px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-sm",children:[e.jsx(c,{className:"h-4 w-4 mr-1"}),"In Progress"]}),s.status==="resolved"&&e.jsxs("span",{className:"flex items-center px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm",children:[e.jsx(N,{className:"h-4 w-4 mr-1"}),"Resolved"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["Category: ",s.category]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Priority: ",s.priority]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Created: ",new Date(s.created_at).toLocaleDateString()]})]})]},s.id))})]})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 max-w-md text-center",children:[e.jsx(c,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Sign In Required"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Please sign in to access support tickets and submit requests."}),e.jsx("a",{href:"/login",className:"inline-block px-6 py-3 bg-cyan-600 text-white rounded-lg font-semibold hover:bg-cyan-700 transition",children:"Sign In"})]})})}export{T as SupportPage};
