import{v as q,r as t,s as g,j as e,P as k,S as z,U as w,n as U,l as F}from"./index-BktnpWS0.js";import{A as V}from"./AdminLayout-C6Mn2_Yu.js";import{T as h}from"./truck-CO3939ut.js";import{C as y}from"./clock-Ep4hhKF1.js";import{C as _}from"./circle-check-big-DQYFJHkd.js";import{B as X}from"./building-2-tmLThGPL.js";import{E as Z}from"./ellipsis-vertical-ZD8ril7W.js";import{Z as K}from"./zap-CpGj1Zaf.js";import{X as O}from"./x-Be8cuiWM.js";import{C as W}from"./circle-x-Cwk9QA9x.js";import"./chevron-left-AWoZAuKB.js";import"./triangle-alert-HMuOKNOn.js";import"./chevron-right-peYPGYwP.js";import"./maximize-DSH1SQuK.js";import"./store-DDL7ZG_8.js";import"./users-vNuzB1jC.js";import"./shield-QBrICIHj.js";import"./file-text-DIHdwLby.js";import"./globe-CdXxteOx.js";import"./credit-card-BMxorgaG.js";import"./settings-D3GsvmJN.js";import"./trending-up-wuknMfwd.js";function ge(){const{theme:C}=q(),i=C==="dark",[c,$]=t.useState([]),[S,D]=t.useState([]),[A,f]=t.useState(!0),[n,L]=t.useState("all"),[d,T]=t.useState(""),[E,o]=t.useState(!1),[a,P]=t.useState(null),[x,I]=t.useState(""),m=i?"bg-slate-800":"bg-white",r=i?"border-slate-700":"border-slate-200",l=i?"text-slate-100":"text-slate-900",u=i?"text-slate-400":"text-slate-500";t.useEffect(()=>{v(),R()},[n]);const v=async()=>{f(!0);let s=g.from("deliveries").select(`
        id,
        tracking_number,
        delivery_status,
        delivery_address,
        customer_phone,
        created_at,
        driver_id,
        customer:profiles!deliveries_customer_id_fkey(full_name, email),
        vendor:profiles!deliveries_vendor_id_fkey(full_name),
        driver:delivery_drivers!deliveries_driver_id_fkey(driver_name)
      `).order("created_at",{ascending:!1});n!=="all"&&(s=s.eq("delivery_status",n));const{data:b}=await s;$(b||[]),f(!1)},R=async()=>{const{data:s}=await g.from("delivery_drivers").select("id, driver_name");D(s||[])},B=async()=>{if(!a||!x)return;const{error:s}=await g.from("deliveries").update({driver_id:x,delivery_status:"assigned"}).eq("id",a.id);s||(o(!1),v())},M=s=>{switch(s){case"delivered":return e.jsx(_,{className:"h-4 w-4"});case"in_transit":return e.jsx(h,{className:"h-4 w-4"});case"picked_up":return e.jsx(k,{className:"h-4 w-4"});case"cancelled":return e.jsx(W,{className:"h-4 w-4"});default:return e.jsx(y,{className:"h-4 w-4"})}},j=s=>{switch(s){case"delivered":return"bg-emerald-500/10 text-emerald-600 border-emerald-500/20";case"in_transit":return"bg-blue-500/10 text-blue-600 border-blue-500/20";case"picked_up":return"bg-violet-500/10 text-violet-600 border-violet-500/20";case"pending":return"bg-amber-500/10 text-amber-600 border-amber-500/20";case"cancelled":return"bg-rose-500/10 text-rose-600 border-rose-500/20";default:return"bg-slate-500/10 text-slate-600 border-slate-500/20"}},p={total:c.length,pending:c.filter(s=>s.delivery_status==="pending").length,in_transit:c.filter(s=>["in_transit","picked_up"].includes(s.delivery_status)).length,delivered:c.filter(s=>s.delivery_status==="delivered").length},N=c.filter(s=>s.tracking_number.toLowerCase().includes(d.toLowerCase())||s.customer.full_name.toLowerCase().includes(d.toLowerCase())||s.delivery_address.toLowerCase().includes(d.toLowerCase()));return e.jsxs(V,{children:[e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-cyan-600 rounded-2xl flex items-center justify-center shadow-lg shadow-cyan-500/20",children:e.jsx(h,{className:"h-6 w-6 text-white"})}),e.jsx("h1",{className:`text-4xl font-black tracking-tight ${l}`,children:"DELIVERY TRACKER"})]}),e.jsx("p",{className:`${u} font-medium`,children:"Real-time monitoring and logistics intelligence dashboard."})]}),e.jsx("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1.5 rounded-[20px] border border-slate-200 dark:border-slate-700",children:["all","pending","in_transit","delivered"].map(s=>e.jsx("button",{onClick:()=>L(s),className:`px-6 py-2.5 rounded-[14px] text-[10px] font-black uppercase tracking-widest transition-all ${n===s?"bg-white dark:bg-slate-700 text-cyan-600 shadow-sm":"text-slate-400 hover:text-slate-600"}`,children:s},s))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[{label:"Total Shipments",value:p.total,icon:k,color:"text-indigo-600",bg:"bg-indigo-50 dark:bg-indigo-900/20"},{label:"Waitlist",value:p.pending,icon:y,color:"text-amber-600",bg:"bg-amber-50 dark:bg-amber-900/20"},{label:"Live Transit",value:p.in_transit,icon:h,color:"text-blue-600",bg:"bg-blue-50 dark:bg-blue-900/20"},{label:"Success Ops",value:p.delivered,icon:_,color:"text-emerald-600",bg:"bg-emerald-50 dark:bg-emerald-900/20"}].map((s,b)=>e.jsxs("div",{className:`${m} p-6 rounded-[32px] border ${r} shadow-sm group hover:scale-[1.02] transition-all`,children:[e.jsx("div",{className:`w-10 h-10 ${s.bg} ${s.color} rounded-xl flex items-center justify-center mb-4`,children:e.jsx(s.icon,{className:"h-5 w-5"})}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:s.label}),e.jsx("h4",{className:`text-2xl font-black ${l} tracking-tighter`,children:s.value})]},b))}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:`absolute left-4 top-1/2 -translate-y-1/2 ${u} h-5 w-5`}),e.jsx("input",{type:"text",placeholder:"Search by ID, Customer, or Address...",value:d,onChange:s=>T(s.target.value),className:`w-full pl-12 pr-6 py-4 ${m} border ${r} rounded-2xl focus:ring-4 focus:ring-cyan-500/10 outline-none font-bold text-sm ${l} placeholder:text-slate-400 shadow-sm`})]}),e.jsx("div",{className:`${m} rounded-[40px] border ${r} shadow-sm overflow-hidden`,children:A?e.jsxs("div",{className:"p-20 flex flex-col items-center justify-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 border-4 border-cyan-600/20 border-t-cyan-600 rounded-full animate-spin"}),e.jsx("p",{className:"text-xs font-bold text-slate-400",children:"Fetching Live Stream..."})]}):N.length===0?e.jsxs("div",{className:"p-20 text-center flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 bg-slate-50 dark:bg-slate-700 rounded-full flex items-center justify-center mb-6",children:e.jsx(h,{className:"h-8 w-8 text-slate-300"})}),e.jsx("h3",{className:"font-bold text-slate-900 dark:text-gray-100",children:"No matching deliveries"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Try adjusting your search or filters."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:`${i?"bg-slate-700/50":"bg-slate-50"} border-b ${r}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-6 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Status & Tracking"}),e.jsx("th",{className:"p-6 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Entity Pair"}),e.jsx("th",{className:"p-6 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Courier Assignment"}),e.jsx("th",{className:"p-6 text-[10px] font-black text-slate-400 uppercase tracking-widest text-right",children:"Actions"})]})}),e.jsx("tbody",{className:`divide-y ${r}`,children:N.map(s=>e.jsxs("tr",{className:"hover:bg-cyan-500/5 transition-colors group",children:[e.jsx("td",{className:"p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center border ${j(s.delivery_status)}`,children:M(s.delivery_status)}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-mono text-[11px] font-black text-cyan-600 tracking-tighter",children:["#",s.tracking_number]}),e.jsx("span",{className:`inline-block mt-1 px-2 py-0.5 rounded-md text-[9px] font-black uppercase tracking-wider border ${j(s.delivery_status)}`,children:s.delivery_status.replace("_"," ")})]})]})}),e.jsx("td",{className:"p-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-3 w-3 text-slate-400"}),e.jsx("p",{className:`text-xs font-bold ${l}`,children:s.customer.full_name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-3 w-3 text-slate-400"}),e.jsx("p",{className:`text-[10px] font-bold ${u}`,children:s.vendor.full_name})]})]})}),e.jsx("td",{className:"p-6",children:s.driver?e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-100 dark:bg-slate-700 rounded-lg flex items-center justify-center",children:e.jsx(w,{className:"h-4 w-4 text-slate-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:`text-xs font-bold ${l}`,children:s.driver.driver_name}),e.jsx("span",{className:"text-[9px] font-black text-emerald-500 uppercase tracking-widest",children:"Authorized Courier"})]})]}):e.jsxs("div",{className:"flex items-center gap-2 text-rose-500/50 italic text-[10px] font-bold",children:[e.jsx(U,{className:"h-3 w-3"}),"Unassigned"]})}),e.jsx("td",{className:"p-6 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",children:e.jsx(Z,{className:"h-4 w-4 text-slate-400"})}),s.delivery_status==="pending"&&e.jsx("button",{onClick:()=>{P(s),o(!0)},className:"px-4 py-2 bg-slate-900 dark:bg-white text-white dark:text-slate-900 rounded-xl text-[10px] font-black uppercase tracking-widest hover:scale-105 active:scale-95 transition-all shadow-sm",children:"Dispatch"})]})})]},s.id))})]})})})]}),E&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in zoom-in-95 duration-200",children:e.jsxs("div",{className:`${m} rounded-[32px] shadow-2xl max-w-md w-full p-8 border ${r}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-cyan-100 dark:bg-cyan-900/30 rounded-xl flex items-center justify-center text-cyan-600",children:e.jsx(K,{className:"h-5 w-5"})}),e.jsx("h3",{className:`text-xl font-black uppercase tracking-tight ${l}`,children:"Dispatch Assignment"})]}),e.jsx("button",{onClick:()=>o(!1),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full",children:e.jsx(O,{className:"h-5 w-5 text-slate-400"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900/40 rounded-2xl border ${borderColor}",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Target Package"}),e.jsxs("p",{className:`text-sm font-bold ${l}`,children:["#",a==null?void 0:a.tracking_number]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(F,{className:"h-3 w-3 text-slate-400"}),e.jsx("p",{className:"text-[10px] text-slate-500 truncate",children:a==null?void 0:a.delivery_address})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 block mb-2 ml-1",children:"Select Courier Personnel"}),e.jsxs("select",{value:x,onChange:s=>I(s.target.value),className:`w-full px-4 py-3 rounded-2xl border ${r} outline-none focus:ring-2 focus:ring-cyan-500/20 ${i?"bg-slate-800 text-gray-100":"bg-slate-50"} font-bold text-sm`,children:[e.jsx("option",{value:"",children:"Choose an available driver..."}),S.map(s=>e.jsx("option",{value:s.id,children:s.driver_name},s.id))]})]}),e.jsxs("div",{className:"flex gap-3 mt-8",children:[e.jsx("button",{onClick:()=>o(!1),className:"flex-1 px-6 py-4 rounded-2xl text-[10px] font-black uppercase tracking-widest border ${borderColor} hover:bg-slate-50 dark:hover:bg-slate-800 transition-all",children:"Cancel"}),e.jsx("button",{onClick:B,disabled:!x,className:"flex-1 px-6 py-4 bg-cyan-600 text-white rounded-2xl text-[10px] font-black uppercase tracking-widest hover:scale-105 active:scale-95 transition-all shadow-lg shadow-cyan-500/20 disabled:opacity-50",children:"Confirm Dispatch"})]})]})]})})]})}export{ge as DeliveryManagement};
