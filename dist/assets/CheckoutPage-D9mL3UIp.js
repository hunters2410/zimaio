import{n as Se,e as Oe,a as De,h as Ie,i as Me,f as qe,u as Ae,r as c,j as e,U as ue,M as pe,k as $e,c as Te,s as w}from"./index-T9wcIP7k.js";import{p as G}from"./paymentService-BqYZQt0v.js";import{L as ge}from"./lock-DR4ROgcT.js";import{C as Ve}from"./check-CtKt80mY.js";import{C as R}from"./credit-card-DbXuWlg0.js";import{S as X,L as ze}from"./smartphone-ChSB_H3g.js";import{W as Fe}from"./wallet-C7uK7jSh.js";import{T as Le}from"./truck-CI4bnO7s.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ge=Se("copy",Ye);function Xe(){const{user:v}=Oe(),{cartItems:O,clearCart:D}=De(),{formatPrice:C}=Ie(),{calculatePrice:W,settings:j}=Me();qe();const z=Ae(),[ee,F]=c.useState(!1),[ye,be]=c.useState([]),[a,I]=c.useState(null),[L,he]=c.useState([]),[g,M]=c.useState(""),[q,re]=c.useState(""),[A,ae]=c.useState(""),[te,se]=c.useState(""),[u,B]=c.useState({pan:"",expiry:"",cvv:""}),[Z,fe]=c.useState(""),[ke,oe]=c.useState(!1),[Re,le]=c.useState(""),[we,de]=c.useState(!1),[ie,ve]=c.useState(""),[je,Ne]=c.useState(""),[ne,ce]=c.useState(!1),_e=O.reduce((r,t)=>r+t.base_price*t.quantity,0),{totalTax:Pe,totalWithTax:U}=O.reduce((r,t)=>{const s=W(t.base_price);return{totalTax:r.totalTax+s.vat*t.quantity,totalWithTax:r.totalWithTax+s.total*t.quantity}},{totalTax:0,totalWithTax:0}),[b,J]=c.useState({street:"",city:"",state:"",zip:"",country:"Zimbabwe"}),$=a?a.base_cost:0,N=U+$,T=ye.filter(r=>{const t=r.min_order_total||0,s=r.max_order_total;return U>=t&&(s==null||U<=s)});c.useEffect(()=>{T.length>0?(!a||a.id!=="pickup"&&!T.find(r=>r.id===a.id))&&I(T[0]):(!a||a.id!=="pickup")&&I({id:"pickup",display_name:"Store Pickup",base_cost:0,delivery_time_min:0,delivery_time_max:0})},[T,a]),c.useEffect(()=>{const r=async()=>{const{data:s}=await w.from("shipping_methods").select("*").eq("is_active",!0);s&&(be(s),I({id:"pickup",display_name:"Store Pickup",base_cost:0,delivery_time_min:0,delivery_time_max:0}))},t=async()=>{const s=await G.getActiveGateways();he(s),s.length>0&&(s.some(n=>n.gateway_type==="iveri")?M("iveri_card"):M(s[0].gateway_type))};r(),t(),v&&(re(v.email||""),(async()=>{const{data:n}=await w.from("profiles").select("*").eq("id",v.id).single();n&&(ae(n.full_name||""),se(n.phone||""))})())},[v]);const me=async()=>{const r=Math.random().toString(36).slice(-8)+"Aa1!",{data:t,error:s}=await w.auth.signUp({email:q,password:r,options:{data:{full_name:A,phone:te,role:"customer"}}});if(s)throw s;return{user:t.user,password:r}};c.useEffect(()=>{g==="paypal"&&(async()=>{var s;const t=L.find(n=>n.gateway_type==="paypal");if(!(!t||!((s=t.configuration)!=null&&s.client_id)))if(document.getElementById("paypal-sdk"))xe();else{const n=document.createElement("script");n.id="paypal-sdk",n.src=`https://www.paypal.com/sdk/js?client-id=${t.configuration.client_id}&currency=USD`,n.onload=xe,document.body.appendChild(n)}})()},[g,L]);const xe=()=>{if(window.paypal){const r=document.getElementById("paypal-button-container");r&&(r.innerHTML=""),window.paypal.Buttons({createOrder:async(t,s)=>{try{return s.order.create({purchase_units:[{amount:{value:N.toFixed(2)},description:`Order from ${(j==null?void 0:j.site_name)||"ZimAIO"}`}]})}catch(n){return console.error("PayPal Create Error",n),null}},onApprove:async(t,s)=>{const n=await s.order.capture();await Ce(n)},onError:t=>{console.error("PayPal Error",t),alert("PayPal payment failed")}}).render("#paypal-button-container")}},Ce=async r=>{F(!0);try{let t=v;if(!t){if(!q)throw new Error("Email is required for receipt.");const{user:h,password:y}=await me();t=h}if(!t)throw new Error("Authentication failed during order creation.");const s=O.reduce((h,y)=>(h[y.vendor_id]||(h[y.vendor_id]=[]),h[y.vendor_id].push(y),h),{}),n=Object.entries(s).map(async([h,y])=>{var S;const H=y.reduce((x,k)=>x+k.base_price*k.quantity,0),o=y.reduce((x,k)=>{const _=W(k.base_price);return{total:x.total+_.total*k.quantity,tax:x.tax+_.vat*k.quantity,comm:x.comm+_.commission*k.quantity}},{tax:0,comm:0,total:0}),l=o.total+$/Object.keys(s).length,m=(a==null?void 0:a.id)==="pickup",i=m?{street:"Store Pickup",city:"Store Pickup",state:"Store Pickup",country:"Zimbabwe",zip:"0000"}:b,p=m?null:a==null?void 0:a.id,E=`ORD-${Date.now()}-${Math.floor(Math.random()*1e3)}`,{data:V,error:Y}=await w.from("orders").insert({order_number:E,customer_id:t.id,vendor_id:h,status:"processing",payment_status:"paid",payment_method:"paypal",shipping_method_id:p,shipping_address:i,subtotal:H,tax_total:o.tax,shipping_total:$/Object.keys(s).length,total:l,commission_amount:o.comm,items:y}).select().single();if(Y)throw Y;const Q=y.map(x=>({order_id:V.id,product_id:x.id,quantity:x.quantity,unit_price:x.price,total_price:x.price*x.quantity}));return await w.from("order_items").insert(Q),await w.from("payment_transactions").insert({order_id:V.id,user_id:t.id,gateway_id:(S=L.find(x=>x.gateway_type==="paypal"))==null?void 0:S.id,gateway_type:"paypal",amount:l,currency:"USD",status:"completed",transaction_reference:r.id,metadata:{paypal_payer:r.payer}}),V}),d=await Promise.all(n);D(),z(`/orders/${d[0].id}?payment=success`)}catch(t){console.error("Order Finalization Error",t),alert("Payment received but order creation failed. Please contact support.")}finally{F(!1)}},Ee=async()=>{var r,t,s,n;F(!0),console.log("Starting order placement...");try{let d=v;if(!d){if(console.log("No user logged in, attempting guest signup..."),!q)throw new Error("Email is required for guest checkout.");const{user:o,password:l}=await me();if(d=o,console.log("Guest signup successful:",d==null?void 0:d.id),d){if((a==null?void 0:a.id)!=="pickup"){const{error:m}=await w.from("profiles").update({city:b.city,country:b.country}).eq("id",d.id);m&&console.error("Profile update error:",m)}ve(l),Ne(q),de(!0)}}if(!d)throw new Error("Authentication failed.");if((a==null?void 0:a.id)!=="pickup"&&(!b.street||!b.city||!b.state))throw new Error("Please enter a valid shipping address.");const h=O.reduce((o,l)=>(o[l.vendor_id]||(o[l.vendor_id]=[]),o[l.vendor_id].push(l),o),{}),y=Object.entries(h).map(async([o,l])=>{const m=l.reduce((f,P)=>f+P.base_price*P.quantity,0),i=l.reduce((f,P)=>{const K=W(P.base_price);return{tax:f.tax+K.vat*P.quantity,comm:f.comm+K.commission*P.quantity,total:f.total+K.total*P.quantity}},{tax:0,comm:0,total:0}),p=i.total+$/Object.keys(h).length,E=(a==null?void 0:a.id)==="pickup",V=E?{street:"Store Pickup",city:"Store Pickup",state:"Store Pickup",country:"Zimbabwe",zip:"0000"}:b,Y=E?null:a==null?void 0:a.id,Q=`ORD-${Date.now()}-${Math.floor(Math.random()*1e3)}`;console.log(`Creating order for vendor ${o}...`);const{data:S,error:x}=await w.from("orders").insert({order_number:Q,customer_id:d.id,vendor_id:o,status:"pending",payment_status:"pending",payment_method:g,shipping_method_id:Y,shipping_address:V,subtotal:m,tax_total:i.tax,shipping_total:$/Object.keys(h).length,total:p,commission_amount:i.comm,items:l}).select().single();if(x)throw console.error("Order Insert Error:",x),x;console.log("Order created:",S.id);const k=l.map(f=>({order_id:S.id,product_id:f.id,quantity:f.quantity,unit_price:f.price,total_price:f.price*f.quantity}));console.log("Inserting order items...");const{error:_}=await w.from("order_items").insert(k);if(_)throw console.error("Order Items Insert Error:",_),_;return console.log("Order items inserted successfully."),{data:S}}),H=await Promise.all(y);if(["paynow","paypal"].includes(g)){const o=(r=H[0])==null?void 0:r.data;if(!o)throw new Error("Order creation failed");console.log("Initiating payment for order:",o.id);const l=await G.initiatePayment({order_id:o.id,gateway_type:g,amount:N,currency:"USD",return_url:`${window.location.origin}/orders/${o.id}?payment=success`,metadata:{customer_name:A||(d==null?void 0:d.email),full_cart_payment:!0}});if(l.redirect_url){window.location.href=l.redirect_url,D();return}}else if(g==="iveri_card"){const o=(t=(await Promise.all(y))[0])==null?void 0:t.data;if(!o)throw new Error("Order creation failed");if(!u.pan||!u.expiry||!u.cvv)throw new Error("Please enter valid card details.");const l=u.pan.replace(/\s/g,"");if(l.length<13||l.length>19)throw new Error("Invalid card number. Please enter a valid 13-19 digit card number.");if(u.expiry.length!==4||!/^\d{4}$/.test(u.expiry))throw new Error("Invalid expiry date. Please use MMYY format (e.g., 1225).");console.log("=== iVeri Card Payment Debug ==="),console.log("Order ID:",o.id),console.log("Amount:",N),console.log("Currency: USD"),console.log("Card (masked):",l.slice(0,4)+"****"+l.slice(-4)),console.log("Expiry:",u.expiry);try{const m=await G.initiatePayment({order_id:o.id,gateway_type:"iveri",amount:N,currency:"USD",metadata:{customer_name:A||(d==null?void 0:d.email),full_cart_payment:!0,card_pan:l,card_expiry:u.expiry,card_cvv:u.cvv,payment_subtype:"card"}});if(console.log("=== iVeri Response ==="),console.log(m),m.success)le(o.id),oe(!0),D(),setTimeout(()=>{z(`/orders/${o.id}?payment=success`)},3e3);else{console.error("iVeri Payment Declined:",m);const i=m.details||m,p=JSON.stringify(i,null,2);throw new Error(`Payment Failed:
${p}`)}}catch(m){console.error("=== iVeri Payment Error ==="),console.error(m);let i=m.message||"Payment initiation failed";throw i.includes("not authenticated")?i="Session expired. Please refresh the page and try again.":i.includes("gateway not available")?i="Payment gateway is currently unavailable. Please contact support.":i.includes("Application ID")&&(i="Payment system configuration error. Please contact support."),new Error(i)}}else if(g==="iveri_ecocash"){const o=(s=(await Promise.all(y))[0])==null?void 0:s.data;if(!o)throw new Error("Order creation failed");if(!Z)throw new Error("Please enter your EcoCash number.");const l=Z.replace(/\D/g,"");if(l.length<9||l.length>12)throw new Error("Invalid phone number. Please enter a valid mobile number.");const m=`910012${l}`;console.log("=== iVeri EcoCash Payment Debug ==="),console.log("Order ID:",o.id),console.log("Amount:",N),console.log("Phone (masked):",l.slice(0,3)+"***"+l.slice(-2)),console.log("EcoCash PAN:",m.slice(0,6)+"****");try{const i=await G.initiatePayment({order_id:o.id,gateway_type:"iveri",amount:N,currency:"USD",metadata:{customer_name:A||(d==null?void 0:d.email),full_cart_payment:!0,card_pan:m,card_expiry:"1228",card_cvv:"",payment_subtype:"ecocash"}});if(console.log("=== iVeri EcoCash Response ==="),console.log(i),i.success)le(o.id),oe(!0),D(),setTimeout(()=>{z(`/orders/${o.id}?payment=success`)},3e3);else{console.error("EcoCash Payment Declined:",i);const p=i.details||i,E=JSON.stringify(p,null,2);throw new Error(`EcoCash Failed:
${E}`)}}catch(i){console.error("=== iVeri EcoCash Payment Error ==="),console.error(i);let p=i.message||"EcoCash payment initiation failed";throw p.includes("not authenticated")?p="Session expired. Please refresh the page and try again.":p.includes("gateway not available")?p="Payment gateway is currently unavailable. Please contact support.":p.includes("Application ID")&&(p="Payment system configuration error. Please contact support."),new Error(p)}}else D(),z("/orders")}catch(d){console.error("Detailed Checkout Error:",d),d.message,d.code==="42501"||(n=d.message)!=null&&n.includes("violates row-level security")}finally{F(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-900 py-12 transition-colors duration-300",children:[ke&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl p-8 max-w-sm w-full shadow-2xl border border-gray-100 dark:border-slate-700 transform scale-100 animate-in zoom-in-95 duration-300 flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-32 h-32 flex items-center justify-center mb-6 animate-bounce",children:e.jsx("img",{src:"/zimaio-logo.png",alt:"ZimAIO",className:"w-full h-full object-contain"})}),e.jsx("h2",{className:"text-2xl font-black text-gray-900 dark:text-white mb-2",children:"Payment Successful!"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mb-6",children:"Your secure payment has been processed. Redirecting to your order summary..."}),e.jsx("div",{className:"w-full bg-gray-100 dark:bg-slate-700 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500 animate-[progress_3s_ease-in-out_forwards] w-full origin-left"})})]})}),we&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl p-8 max-w-md w-full shadow-2xl border border-gray-100 dark:border-slate-700 transform scale-100 animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ue,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),e.jsx("h2",{className:"text-2xl font-black text-gray-900 dark:text-white mb-2",children:"Account Created!"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Welcome to ZimAIO! Your account has been successfully created."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 dark:from-slate-700 dark:to-slate-900 rounded-2xl p-5 mb-6 border border-gray-200 dark:border-slate-600",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 dark:text-gray-400 tracking-wider mb-2",children:"Email Address"}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-white dark:bg-slate-800 rounded-lg border border-gray-200 dark:border-slate-600",children:[e.jsx(pe,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:je})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 dark:text-gray-400 tracking-wider mb-2",children:"Temporary Password"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-2 px-4 py-3 bg-white dark:bg-slate-800 rounded-lg border border-gray-200 dark:border-slate-600",children:[e.jsx(ge,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"}),e.jsx("code",{className:"text-sm font-mono font-bold text-green-600 dark:text-green-400 flex-1",children:ie})]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(ie),ce(!0),setTimeout(()=>ce(!1),2e3)},className:`p-3 rounded-lg transition-all ${ne?"bg-green-600 text-white":"bg-gray-100 dark:bg-slate-700 hover:bg-gray-200 dark:hover:bg-slate-600 text-gray-700 dark:text-gray-200"}`,title:"Copy password",children:ne?e.jsx(Ve,{className:"w-5 h-5"}):e.jsx(Ge,{className:"w-5 h-5"})})]})]})]}),e.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4 mb-6",children:e.jsxs("p",{className:"text-xs text-amber-800 dark:text-amber-300 leading-relaxed",children:[e.jsx("strong",{className:"font-bold",children:"Important:"})," Please save this password securely. You can change it after logging in from your account settings."]})}),e.jsx("button",{onClick:()=>de(!1),className:"w-full py-4 bg-green-600 text-white rounded-xl font-black uppercase tracking-widest text-xs shadow-xl shadow-green-200 hover:bg-green-700 active:scale-95 transition-all",children:"Continue to Checkout"})]})}),e.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[e.jsx("h1",{className:"text-3xl font-black text-gray-900 dark:text-white uppercase tracking-tight mb-8",children:"Secure Checkout"}),e.jsxs("div",{className:"grid lg:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-[2rem] p-8 shadow-sm border border-gray-100 dark:border-slate-700",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-3 mb-4 dark:text-white",children:[e.jsx("span",{className:"w-6 h-6 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 rounded-full flex items-center justify-center text-xs",children:"1"}),"Contact Information"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 dark:text-gray-400 mb-1",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-2.5 w-3.5 h-3.5 text-gray-400 dark:text-gray-500"}),e.jsx("input",{type:"email",disabled:!!v,value:q,onChange:r=>re(r.target.value),className:"w-full pl-9 pr-3 py-2 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 dark:text-gray-200"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 dark:text-gray-400 mb-1",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-2.5 w-3.5 h-3.5 text-gray-400 dark:text-gray-500"}),e.jsx("input",{type:"tel",value:te,onChange:r=>se(r.target.value),className:"w-full pl-9 pr-3 py-2 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 dark:text-gray-200"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 dark:text-gray-400 mb-1",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(ue,{className:"absolute left-3 top-2.5 w-3.5 h-3.5 text-gray-400 dark:text-gray-500"}),e.jsx("input",{type:"text",value:A,onChange:r=>ae(r.target.value),className:"w-full pl-9 pr-3 py-2 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 dark:text-gray-200"})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-slate-700",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-3 mb-4 dark:text-white",children:[e.jsx("span",{className:"w-6 h-6 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 rounded-full flex items-center justify-center text-xs",children:"2"}),"Delivery Method"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("div",{onClick:()=>I({id:"pickup",display_name:"Store Pickup",base_cost:0,delivery_time_min:0,delivery_time_max:0}),className:`cursor-pointer border rounded-xl p-3 flex items-center justify-between transition-all ${(a==null?void 0:a.id)==="pickup"?"border-emerald-500 bg-emerald-50/20 dark:bg-emerald-900/10":"border-gray-100 dark:border-slate-700 hover:border-gray-200 dark:hover:border-slate-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${(a==null?void 0:a.id)==="pickup"?"border-emerald-500":"border-gray-300 dark:border-slate-600"}`,children:(a==null?void 0:a.id)==="pickup"&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-xs text-gray-900 dark:text-white",children:"Store Pickup"}),e.jsx("p",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-medium",children:"Collect directly from shop"})]})]}),e.jsx("span",{className:"font-bold text-xs text-emerald-600 dark:text-emerald-400",children:"FREE"})]}),T.map(r=>e.jsxs("div",{onClick:()=>I(r),className:`cursor-pointer border rounded-xl p-3 flex items-center justify-between transition-all ${(a==null?void 0:a.id)===r.id?"border-emerald-500 bg-emerald-50/20 dark:bg-emerald-900/10":"border-gray-100 dark:border-slate-700 hover:border-gray-200 dark:hover:border-slate-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${(a==null?void 0:a.id)===r.id?"border-emerald-500":"border-gray-300 dark:border-slate-600"}`,children:(a==null?void 0:a.id)===r.id&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-xs text-gray-900 dark:text-white",children:r.display_name}),e.jsxs("p",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-medium",children:[r.delivery_time_min,"-",r.delivery_time_max," Days"]})]})]}),e.jsx("span",{className:"font-bold text-xs text-gray-900 dark:text-white",children:C(r.base_cost)})]},r.id))]})]}),(a==null?void 0:a.id)!=="pickup"&&e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-slate-700 animate-in fade-in slide-in-from-top-4 duration-300",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-3 mb-4 dark:text-white",children:[e.jsx("span",{className:"w-6 h-6 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 rounded-full flex items-center justify-center text-xs",children:"3"}),"Shipping Address"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 dark:text-gray-400 mb-1",children:"Street Address"}),e.jsx("input",{type:"text",value:b.street,onChange:r=>J({...b,street:r.target.value}),className:"w-full px-3 py-2 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 dark:text-gray-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 dark:text-gray-400 mb-1",children:"City"}),e.jsx("input",{type:"text",value:b.city,onChange:r=>J({...b,city:r.target.value}),className:"w-full px-3 py-2 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 dark:text-gray-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 dark:text-gray-400 mb-1",children:"Province/State"}),e.jsx("input",{type:"text",value:b.state,onChange:r=>J({...b,state:r.target.value}),className:"w-full px-3 py-2 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 dark:text-gray-200"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-sm border border-gray-100 dark:border-slate-700",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-3 mb-4 dark:text-white",children:[e.jsx("span",{className:"w-6 h-6 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 rounded-full flex items-center justify-center text-xs",children:"4"}),"Payment Method"]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:L.map(r=>{if(r.gateway_type==="iveri")return e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:()=>M("iveri_card"),className:`cursor-pointer border rounded-xl p-3 flex flex-col items-center justify-center gap-2 transition-all ${g==="iveri_card"?"border-emerald-500 bg-emerald-50/20 dark:bg-emerald-900/10 text-emerald-700 dark:text-emerald-400":"border-gray-100 dark:border-slate-700 text-gray-400 dark:text-gray-500 hover:border-gray-200 dark:hover:border-slate-600"}`,children:[e.jsx(R,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wide text-center",children:"In-Store Card"})]},"iveri_card"),e.jsxs("div",{onClick:()=>M("iveri_ecocash"),className:`cursor-pointer border rounded-xl p-3 flex flex-col items-center justify-center gap-2 transition-all ${g==="iveri_ecocash"?"border-emerald-500 bg-emerald-50/20 dark:bg-emerald-900/10 text-emerald-700 dark:text-emerald-400":"border-gray-100 dark:border-slate-700 text-gray-400 dark:text-gray-500 hover:border-gray-200 dark:hover:border-slate-600"}`,children:[e.jsx(X,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wide text-center",children:"EcoCash"})]},"iveri_ecocash")]});const t=r.gateway_type==="paynow"?X:r.gateway_type==="stripe"?R:r.gateway_type==="paypal"?Fe:r.gateway_type==="cash"?Le:R;return e.jsxs("div",{onClick:()=>M(r.gateway_type),className:`cursor-pointer border rounded-xl p-3 flex flex-col items-center justify-center gap-2 transition-all ${g===r.gateway_type?"border-emerald-500 bg-emerald-50/20 dark:bg-emerald-900/10 text-emerald-700 dark:text-emerald-400":"border-gray-100 dark:border-slate-700 text-gray-400 dark:text-gray-500 hover:border-gray-200 dark:hover:border-slate-600"}`,children:[e.jsx(t,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wide text-center",children:r.display_name})]},r.id)})}),g==="iveri_card"&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100 dark:border-slate-700 animate-in slide-in-from-top-2 fade-in",children:[e.jsx("h3",{className:"text-xs font-black text-gray-900 dark:text-white uppercase tracking-widest mb-4",children:"Card Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 dark:text-gray-400 mb-1",children:"Card Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400 dark:text-gray-500"}),e.jsx("input",{type:"text",maxLength:19,placeholder:"0000 0000 0000 0000",value:u.pan,onChange:r=>B({...u,pan:r.target.value}),className:"w-full pl-9 pr-3 py-2 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 dark:text-gray-200 tracking-wider"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 dark:text-gray-400 mb-1",children:"Expiry Date"}),e.jsx("input",{type:"text",placeholder:"MMYY",maxLength:4,value:u.expiry,onChange:r=>B({...u,expiry:r.target.value}),className:"w-full px-3 py-2 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 dark:text-gray-200 text-center"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 dark:text-gray-400 mb-1",children:"CVV / CVC"}),e.jsx("input",{type:"text",maxLength:4,placeholder:"123",value:u.cvv,onChange:r=>B({...u,cvv:r.target.value}),className:"w-full px-3 py-2 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 dark:text-gray-200 text-center"})]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-emerald-600 dark:text-emerald-400 bg-emerald-50 dark:bg-emerald-900/20 p-3 rounded-lg",children:[e.jsx(Te,{className:"w-4 h-4"}),e.jsx("p",{className:"text-[10px] font-bold leading-tight",children:"Your card details are securely processed via iVeri Enterprise Gateway."})]})]}),g==="iveri_ecocash"&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100 dark:border-slate-700 animate-in slide-in-from-top-2 fade-in",children:[e.jsx("h3",{className:"text-xs font-black text-gray-900 dark:text-white uppercase tracking-widest mb-4",children:"EcoCash Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 dark:text-gray-400 mb-1",children:"Mobile Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400 dark:text-gray-500"}),e.jsx("input",{type:"tel",placeholder:"077 123 4567",value:Z,onChange:r=>fe(r.target.value),className:"w-full pl-9 pr-3 py-2 bg-gray-50 dark:bg-slate-700 border border-gray-200 dark:border-slate-600 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 dark:text-gray-200 tracking-wider"})]}),e.jsx("p",{className:"text-[9px] text-gray-400 mt-2 ml-1",children:"We will send a push notification to your phone."})]})]}),g==="paypal"&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100 dark:border-slate-700 animate-in slide-in-from-top-2 fade-in",children:[e.jsx("div",{id:"paypal-button-container",className:"w-full"}),e.jsx("p",{className:"text-[10px] text-center text-gray-400 mt-2",children:"Secure payment processing by PayPal. You will be redirected to PayPal to complete your purchase."})]})]})]}),e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-gray-100 dark:border-slate-700 p-6 shadow-sm dark:shadow-slate-950/20 sticky top-24",children:[e.jsx("h3",{className:"text-lg font-black text-gray-900 dark:text-white uppercase tracking-tight mb-6",children:"Order Summary"}),e.jsx("div",{className:"space-y-3 mb-4",children:O.map(r=>e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-50 dark:bg-slate-700 rounded-lg overflow-hidden border border-gray-100 dark:border-slate-600",children:e.jsx("img",{src:r.image,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-[11px] font-bold text-gray-900 dark:text-white line-clamp-1",children:r.name}),e.jsxs("p",{className:"text-[9px] text-gray-400 dark:text-gray-500",children:["Qty: ",r.quantity]})]})]}),e.jsx("span",{className:"text-[11px] font-black text-gray-900 dark:text-white",children:C(r.price*r.quantity)})]},r.id))}),e.jsx("div",{className:"border-t border-gray-100 dark:border-slate-700 my-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 font-medium",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"text-gray-900 dark:text-white font-bold",children:C(_e)})]}),(j==null?void 0:j.is_enabled)&&e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 font-medium",children:[e.jsxs("span",{children:["VAT (",j.default_rate,"%)"]}),e.jsx("span",{className:"text-gray-900 dark:text-white font-bold",children:C(Pe)})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 font-medium",children:[e.jsx("span",{children:"Shipping"}),e.jsx("span",{className:"text-emerald-600 dark:text-emerald-400 font-bold",children:a?C(a.base_cost):"--"})]})]}),e.jsx("div",{className:"border-t border-gray-100 dark:border-slate-700 my-6 pt-6",children:e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"font-black text-gray-900 dark:text-white uppercase",children:"Total"}),e.jsx("span",{className:"text-3xl font-black text-emerald-600 leading-none",children:C(N)})]})}),g!=="paypal"&&e.jsx("button",{onClick:Ee,disabled:ee,className:"w-full py-4 bg-emerald-600 text-white rounded-xl font-black uppercase tracking-widest text-xs shadow-xl shadow-emerald-200 hover:bg-emerald-700 active:scale-95 transition-all flex items-center justify-center gap-2",children:ee?e.jsx(ze,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-4 h-4"})," Pay & Place Order"]})})]})})]})]})]})}export{Xe as CheckoutPage};
