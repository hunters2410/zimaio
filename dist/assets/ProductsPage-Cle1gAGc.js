import{d as H,r as l,e as I,f as O,j as e,C as N,S as v,L as W,s as n}from"./index-BktnpWS0.js";import{F as k}from"./funnel-NTM8UTrP.js";import{S as C}from"./shopping-bag-CPPoF0he.js";function G(){const[u,h]=H(),x=u.get("category"),[S,_]=l.useState([]),[p,P]=l.useState([]),[i,L]=l.useState(null),[F,A]=l.useState(!0),[o,f]=l.useState(null),[b,q]=l.useState(""),{formatPrice:D}=I(),{calculatePrice:R}=O(),[g,c]=l.useState(!1);l.useEffect(()=>{(async()=>{const[t,r,a]=await Promise.all([n.from("products").select("*").eq("is_active",!0).order("created_at",{ascending:!1}),n.from("categories").select("*").order("name"),n.from("vendor_ads").select("*").eq("status","active").eq("ad_type","sidebar").lte("start_date",new Date().toISOString()).gte("end_date",new Date().toISOString()).limit(1).maybeSingle()]);if(r.data&&(P(r.data),x)){const d=r.data.find(E=>E.slug===x);d&&f(d.id)}t.data&&_(t.data),a.data&&(L(a.data),await n.rpc("increment_ad_impressions",{ad_ids:[a.data.id]})),A(!1)})()},[x]);const m=(s,t)=>{f(s),h(t?{category:t}:{})},y=u.get("search"),w=S.filter(s=>o&&s.category_id!==o?!1:y?y.toLowerCase().trim().split(/\s+/).filter(a=>a.length>0).every(a=>{if(s.name.toLowerCase().includes(a)||s.slug&&s.slug.toLowerCase().includes(a)||s.description&&s.description.toLowerCase().includes(a))return!0;if(s.tags){if(Array.isArray(s.tags)){if(s.tags.some(d=>d.toLowerCase().includes(a)))return!0}else if(typeof s.tags=="string"&&s.tags.toLowerCase().includes(a))return!0}return!1}):!0),j=p.filter(s=>s.name.toLowerCase().includes(b.toLowerCase())),$=async s=>{await n.rpc("increment_ad_clicks",{ad_id:s})},B=s=>{const t=p.find(r=>r.id===s);t&&m(t.id,t.slug)};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b",children:e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsx("h1",{className:"text-2xl font-black text-gray-900 mb-1 uppercase tracking-tight",children:"All Products"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium uppercase tracking-widest",children:"Browse our entire collection"})]})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("div",{className:"lg:hidden mb-4",children:e.jsxs("button",{onClick:()=>c(!g),className:"w-full flex items-center justify-between px-4 py-3 bg-white border border-gray-200 rounded-xl shadow-sm text-sm font-bold text-gray-700 active:scale-[0.99] transition-transform",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4 text-emerald-600"}),"Filters & Categories"]}),e.jsx(N,{className:`h-4 w-4 transition-transform duration-300 ${g?"rotate-180":""}`})]})}),e.jsxs("aside",{className:`lg:w-64 space-y-6 lg:block ${g?"block":"hidden"}`,children:[e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-sm font-black text-gray-900 uppercase tracking-widest flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-2 text-emerald-600"}),"Filter by Category"]}),e.jsx("button",{onClick:()=>c(!1),className:"lg:hidden text-gray-400 hover:text-gray-600",children:e.jsx(N,{className:"h-4 w-4 rotate-180"})})]}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx(v,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Find a category...",className:"w-full pl-9 pr-3 py-2 bg-gray-50 border-none rounded-xl text-[10px] font-black uppercase tracking-widest focus:ring-2 focus:ring-emerald-500 outline-none transition-all",value:b,onChange:s=>q(s.target.value)})]}),e.jsxs("div",{className:"space-y-1 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:[e.jsx("button",{onClick:()=>{m(null),c(!1)},className:`w-full text-left px-4 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${o===null?"bg-emerald-600 text-white shadow-lg shadow-emerald-200":"text-gray-500 hover:bg-gray-50"}`,children:"All Products"}),j.map(s=>e.jsx("button",{onClick:()=>{m(s.id,s.slug),c(!1)},className:`w-full text-left px-4 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${o===s.id?"bg-emerald-600 text-white shadow-lg shadow-emerald-200":"text-gray-500 hover:bg-gray-50"}`,children:s.name},s.id)),j.length===0&&e.jsx("p",{className:"text-[10px] font-black uppercase text-gray-400 text-center py-4",children:"No categories found"})]})]}),i&&e.jsxs("a",{href:i.link_url,target:"_blank",rel:"noopener noreferrer",onClick:()=>$(i.id),className:"block bg-white p-2 rounded-xl shadow-sm border border-gray-100 group overflow-hidden",children:[e.jsxs("div",{className:"relative aspect-[4/5] rounded-lg overflow-hidden mb-3",children:[e.jsx("img",{src:i.image_url,alt:i.title,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}),e.jsx("div",{className:"absolute top-2 right-2 px-2 py-1 bg-black/50 backdrop-blur-md rounded text-white text-[8px] font-black uppercase tracking-widest",children:"Sponsored"})]}),e.jsx("h4",{className:"font-bold text-gray-900 text-sm line-clamp-1 px-2 mb-1 uppercase tracking-tight",children:i.title}),e.jsx("p",{className:"text-[10px] text-green-600 font-black px-2 uppercase tracking-widest",children:"Shop Now"})]})]}),e.jsxs("main",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-[0.2em]",children:[w.length," Premium results found"]}),e.jsxs("select",{className:"px-4 py-2 border border-gray-300 rounded-xl text-[10px] font-black uppercase tracking-widest focus:ring-2 focus:ring-emerald-500",children:[e.jsx("option",{children:"Sort by: Featured"}),e.jsx("option",{children:"Price: Low to High"}),e.jsx("option",{children:"Price: High to Low"}),e.jsx("option",{children:"Newest"}),e.jsx("option",{children:"Best Rating"})]})]}),F?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-5 gap-4",children:[...Array(10)].map((s,t)=>e.jsx("div",{className:"bg-gray-100 rounded-2xl h-64 animate-pulse border border-gray-50"},t))}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-6",children:w.map(s=>{var t;return e.jsxs(W,{to:`/products/${s.slug}`,className:"group bg-white rounded-3xl border border-gray-100 p-3 hover:shadow-2xl hover:shadow-emerald-900/5 transition-all duration-500 hover:-translate-y-1",children:[e.jsx("div",{className:"aspect-square rounded-xl overflow-hidden bg-gray-50 mb-3",children:(t=s.images)!=null&&t[0]?e.jsx("img",{src:s.images[0],alt:s.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(C,{className:"w-8 h-8 text-gray-200"})})}),e.jsxs("div",{className:"px-1 pb-1",children:[e.jsx("h3",{className:"text-[11px] font-bold text-gray-900 group-hover:text-emerald-600 transition-colors line-clamp-1 uppercase tracking-tight mb-2",children:s.name}),e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-50 pt-2",children:[e.jsx("span",{className:"text-sm font-black text-emerald-600",children:D(R(s.base_price).total,s.currency_code||"USD")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:r=>{r.preventDefault(),B(s.category_id)},title:"Find similar products",className:"p-1 px-2 border border-gray-100 rounded-lg hover:bg-emerald-600 hover:text-white transition-all",children:e.jsx(v,{className:"h-3 w-3"})}),e.jsx("div",{className:"p-1 px-2 border border-gray-100 rounded-lg group-hover:bg-emerald-600 group-hover:text-white transition-all",children:e.jsx(C,{className:"h-3 w-3"})})]})]})]})]},s.id)})})]})]})})]})}export{G as ProductsPage};
