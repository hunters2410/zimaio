import{n as dt,r as a,s as x,j as e,w as oe,D as pe,R as vt,S as ye,X as le,e as de,L as He,u as ct,f as kt,y as _t,z as St,d as xe,B as Ct,E as Dt,G as Pt,o as je,I as qt,m as we,P as ae,M as $t,g as ot,C as qe,U as xt,p as Rt,c as $e,A as At,l as Lt}from"./index-T9wcIP7k.js";import{W as Et}from"./wallet-C7uK7jSh.js";import{A as Oe}from"./arrow-up-right-D0Qk9enJ.js";import{C as re}from"./circle-check-big-BYTb-izI.js";import{T as Le}from"./trending-up-D57PSrGr.js";import{C as ge}from"./credit-card-DbXuWlg0.js";import{I as Fe,T as be,E as Ut,M as Te,a as Ve}from"./triangle-alert-C6svA3ly.js";import{S as fe}from"./save-Bbxo6HuH.js";import{B as tt}from"./bell-B6qorZ8L.js";import{C as st}from"./chevron-right-DQGX3U4F.js";import{C as Mt,S as It}from"./settings-CBK8R_-F.js";import{S as mt}from"./shield-BnwYx_xt.js";import{Z as ut}from"./zap-_oUAMe_n.js";import{M as Ot}from"./maximize-CxfeF--5.js";import{R as pt}from"./rotate-ccw-3XshzNt2.js";import{U as Ne}from"./upload-DtkpSNDN.js";import{L as Ft}from"./lock-DR4ROgcT.js";import{L as Tt,E as at,M as Vt,A as zt}from"./mouse-pointer-LCbXvNjb.js";import{L as rt}from"./layout-grid-CqtneesC.js";import{P as Re}from"./plus-B2DFtXvD.js";import{E as Bt}from"./ellipsis-vertical-GFqU5AFZ.js";import{F as gt}from"./funnel-DSb2S8Kf.js";import{E as Ae}from"./eye-ByJpIZwj.js";import{P as ze}from"./pen-CPGzRDpf.js";import{T as Be}from"./trash-2-RCUSiwrv.js";import{C as ie}from"./circle-x-COGKxlZd.js";import{C as Qe}from"./calendar-DXYSGu7Y.js";import{F as ue}from"./file-text-D26nKDmr.js";import{T as Wt}from"./truck-CI4bnO7s.js";import{C as ht}from"./clock-Hzc8pPp_.js";import{C as We}from"./check-CtKt80mY.js";import{V as Kt}from"./VendorPOS-CyMSdWeH.js";import{D as lt}from"./jspdf.es.min-CpleFsXe.js";import{R as Ke,A as bt,C as ft,X as yt,Y as jt,T as Ge,a as wt,P as Gt,b as Yt,c as Ht}from"./AreaChart-CQSOvDrc.js";import{C as Qt}from"./circle-CdTX2oci.js";import"./html2canvas.esm-CBrSDip1.js";import"./minus-CQkdbG1R.js";import"./banknote-COCCxm_1.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Ye=dt("archive",Zt);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Ie=dt("history",Xt);function Jt(){const[r,C]=a.useState([]),[P,j]=a.useState([]),[L,u]=a.useState([]),[O,S]=a.useState([]),[p,N]=a.useState(0),[k,I]=a.useState(!0),[y,D]=a.useState(!1),[g,n]=a.useState(null),[f,v]=a.useState(null),[d,c]=a.useState(null),[_,s]=a.useState({}),[o,b]=a.useState(!1),[q,R]=a.useState(!1),[E,B]=a.useState(""),[i,h]=a.useState("");a.useEffect(()=>{l()},[]);const l=async()=>{I(!0);try{const{data:{user:m}}=await x.auth.getUser();if(!m)throw new Error("Not authenticated");c(m.id);const[A,z,Y,J]=await Promise.all([x.from("vendor_profiles").select("id").eq("user_id",m.id).single(),x.from("wallets").select("balance").eq("user_id",m.id).maybeSingle(),x.from("payment_gateways").select("*").eq("is_active",!0),x.from("withdrawal_requests").select("*").eq("vendor_id",m.id).order("requested_at",{ascending:!1})]);if(A.error)throw A.error;const Q=A.data;v(Q.id),z.data?N(z.data.balance||0):(console.warn("Wallet data not found for user"),N(0)),Y.data&&u(Y.data),J.data&&S(J.data);const[te,ne]=await Promise.all([x.from("currencies").select("*").eq("is_active",!0).in("code",["USD","ZWL"]).order("code"),x.from("vendor_currency_rates").select("*").eq("vendor_id",Q.id)]);if(te.error)throw te.error;if(ne.error)throw ne.error;C(te.data||[]),j(ne.data||[]);const me={};(ne.data||[]).forEach(ce=>{ce.currency_code&&ce.exchange_rate!==void 0&&(me[ce.currency_code]=ce.exchange_rate.toString())}),s(me)}catch(m){console.error("Error in VendorCurrencyManagement fetchData:",m),n({type:"error",text:`Failed to load wallet data: ${m.message}`})}finally{I(!1)}},U=async m=>{if(m.preventDefault(),!d)return;const A=parseFloat(E);if(isNaN(A)||A<=0){alert("Please enter a valid amount");return}if(A>p){alert("Insufficient balance");return}if(!i){alert("Please select a payment gateway");return}D(!0);try{const{error:z}=await x.from("withdrawal_requests").insert({vendor_id:d,amount:A,currency:"USD",status:"pending",payment_method:i,net_amount:A*.98,withdrawal_charges:A*.02});if(z)throw z;b(!1),B(""),n({type:"success",text:"Withdrawal request submitted successfully."}),l()}catch(z){alert(z.message)}finally{D(!1)}},G=(m,A)=>{m!=="USD"&&(A===""||/^\d*\.?\d*$/.test(A))&&s(z=>({...z,[m]:A}))},T=async()=>{if(f){D(!0),n(null);try{for(const[m,A]of Object.entries(_)){if(m==="USD")continue;const z=parseFloat(A);if(isNaN(z)||z<=0)throw new Error(`Invalid rate for ${m}`);const Y=P.find(J=>J.currency_code===m);Y?await x.from("vendor_currency_rates").update({exchange_rate:z}).eq("id",Y.id):await x.from("vendor_currency_rates").insert({vendor_id:f,currency_code:m,exchange_rate:z,is_active:!0})}n({type:"success",text:"Changes saved successfully."}),l()}catch(m){n({type:"error",text:m.message})}finally{D(!1)}}},V=m=>{const A=r.find(z=>z.code===m);A&&s(z=>({...z,[m]:A.exchange_rate.toString()}))};return k?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-emerald-600"})}):e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl p-6 shadow-sm overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-emerald-50 rounded-full -mr-16 -mt-16 opacity-50"}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-emerald-600 rounded-2xl flex items-center justify-center shadow-lg shadow-emerald-600/20",children:e.jsx(Et,{className:"text-white w-7 h-7"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] uppercase tracking-widest font-black text-gray-400 mb-0.5",children:"Available Balance"}),e.jsxs("h2",{className:"text-3xl font-black text-gray-900 leading-none",children:[e.jsx("span",{className:"text-gray-400 text-xl mr-1",children:"$"}),p.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white text-xs font-bold px-5 py-2.5 rounded-xl transition-all shadow-sm active:scale-95",children:[e.jsx(Oe,{className:"w-4 h-4"}),"WITHDRAW"]}),e.jsxs("button",{onClick:()=>R(!0),className:"flex items-center gap-2 bg-white hover:bg-gray-50 text-gray-700 text-xs font-bold px-5 py-2.5 rounded-xl transition-all border border-gray-200 active:scale-95 shadow-sm",children:[e.jsx(Ie,{className:"w-4 h-4"}),"HISTORY"]})]})]})]}),g&&e.jsxs("div",{className:`p-3 rounded-xl flex items-center gap-3 text-sm font-medium ${g.type==="success"?"bg-green-50 text-green-700 border border-green-100":"bg-red-50 text-red-700 border border-red-100"}`,children:[g.type==="success"?e.jsx(re,{className:"w-4 h-4"}):e.jsx(oe,{className:"w-4 h-4"}),g.text]}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-5 border-b border-gray-50 bg-gray-50/30 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-emerald-50 rounded-lg",children:e.jsx(Le,{className:"w-4 h-4 text-emerald-600"})}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"Exchange Rate Control"})]}),e.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-wider bg-white px-3 py-1 rounded-full border border-gray-100",children:"Market Basis: 1 USD"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:r.map(m=>{var Y;const A=_[m.code]||m.exchange_rate.toString(),z=m.code==="USD";return e.jsxs("div",{className:`p-5 rounded-2xl border ${z?"bg-gray-50/50 border-gray-100 opacity-80":"bg-white border-gray-200"} transition-all hover:shadow-md hover:shadow-gray-100/50`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-lg font-bold ${z?"bg-gray-100 text-gray-400":"bg-emerald-50 text-emerald-600"}`,children:m.symbol}),e.jsxs("div",{children:[e.jsx("span",{className:"font-black text-gray-900 text-xs uppercase tracking-tight block",children:m.name}),e.jsx("span",{className:"text-[10px] text-gray-400 font-bold",children:m.code})]})]}),z&&e.jsx("span",{className:"text-[9px] font-black text-gray-400 bg-gray-200/50 px-2 py-0.5 rounded-full letter-spacing-widest",children:"DEFAULT"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1.5 ml-1",children:"Your Custom Rate"}),e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"text",value:A,disabled:z,onChange:J=>G(m.code,J.target.value),className:"w-full pl-9 pr-12 py-2.5 bg-white border border-gray-200 rounded-xl text-sm text-gray-900 font-black focus:ring-4 focus:ring-emerald-500/10 focus:border-emerald-500 outline-none transition-all disabled:bg-gray-50 disabled:text-gray-400"}),e.jsx(pe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 group-focus-within:text-emerald-500 transition-colors"}),!z&&e.jsx("button",{onClick:()=>V(m.code),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1.5 text-gray-300 hover:text-emerald-600 transition-colors bg-gray-50 rounded-lg",title:"Reset to system rate",children:e.jsx(vt,{className:"w-3.5 h-3.5"})})]})]}),!z&&e.jsxs("div",{className:"pt-3 border-t border-gray-50 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-[10px] font-bold",children:[e.jsxs("span",{className:"text-gray-400 flex items-center gap-1",children:[e.jsx(ye,{className:"w-3 h-3"})," System Rate"]}),e.jsx("span",{className:"text-gray-700 bg-gray-100 px-2 py-0.5 rounded",children:m.exchange_rate})]}),e.jsxs("div",{className:"flex items-center justify-between text-[10px] font-bold",children:[e.jsxs("span",{className:"text-gray-400 flex items-center gap-1",children:[e.jsx(ge,{className:"w-3 h-3"})," Live Rate"]}),e.jsx("span",{className:"text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded",children:((Y=P.find(J=>J.currency_code===m.code))==null?void 0:Y.exchange_rate)||m.exchange_rate})]})]})]})]},m.code)})}),e.jsxs("div",{className:"mt-8 flex flex-col md:flex-row md:items-center justify-between gap-6 p-5 border border-blue-50 bg-blue-50/20 rounded-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-1 opacity-5",children:e.jsx(Fe,{className:"w-20 h-20 text-blue-500"})}),e.jsxs("div",{className:"flex items-start gap-3 relative z-10",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx(Fe,{className:"w-4 h-4 text-blue-600 shrink-0"})}),e.jsx("p",{className:"text-xs text-blue-800 font-medium leading-relaxed max-w-md",children:"Set your custom exchange rates to control your profit margins. Prices on the storefront will be automatically calculated using these specific rates only for your store."})]}),e.jsxs("button",{onClick:T,disabled:y,className:"flex items-center justify-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white text-xs font-black px-8 py-3 rounded-xl transition-all disabled:opacity-50 shadow-lg shadow-emerald-600/20 active:scale-95 uppercase tracking-wider relative z-10",children:[e.jsx(fe,{className:"w-4 h-4"}),y?"Processing...":"Save Rates"]})]})]})]}),o&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-3xl shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-50 flex items-center justify-between bg-gray-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-600 rounded-xl flex items-center justify-center shadow-lg shadow-emerald-600/20",children:e.jsx(Oe,{className:"text-white w-5 h-5"})}),e.jsx("h3",{className:"text-lg font-black text-gray-900 uppercase tracking-tight",children:"Withdraw Funds"})]}),e.jsx("button",{onClick:()=>b(!1),className:"p-2 hover:bg-gray-100 rounded-xl transition-all",children:e.jsx(le,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("form",{onSubmit:U,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"bg-emerald-50/50 p-4 rounded-2xl border border-emerald-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-emerald-600 uppercase tracking-widest mb-1",children:"Max Available"}),e.jsxs("p",{className:"text-2xl font-black text-emerald-700",children:["$",p.toFixed(2)]})]}),e.jsx(ge,{className:"w-8 h-8 text-emerald-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2 ml-1",children:"Amount to Withdraw (USD)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",step:"0.01",required:!0,value:E,onChange:m=>B(m.target.value),placeholder:"0.00",className:"w-full pl-10 pr-4 py-3 bg-white border border-gray-200 rounded-2xl text-lg font-black focus:ring-4 focus:ring-emerald-500/10 focus:border-emerald-500 outline-none transition-all"}),e.jsx(pe,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-400 uppercase tracking-widest mb-2 ml-1",children:"Automatic Gateway"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[L.map(m=>e.jsxs("button",{type:"button",onClick:()=>h(m.gateway_name),className:`flex items-center justify-between p-4 rounded-2xl border-2 transition-all ${i===m.gateway_name?"border-emerald-600 bg-emerald-50/50":"border-gray-100 hover:border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${i===m.gateway_name?"bg-emerald-600 text-white":"bg-gray-100 text-gray-400"}`,children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-bold text-sm text-gray-900",children:m.gateway_name})]}),i===m.gateway_name&&e.jsx("div",{className:"w-2 h-2 bg-emerald-600 rounded-full animate-pulse"})]},m.id)),L.length===0&&e.jsx("div",{className:"p-4 bg-gray-50 border border-gray-100 rounded-2xl text-center",children:e.jsx("p",{className:"text-xs text-gray-400",children:"No payment gateways configured."})})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsxs("button",{type:"submit",disabled:y||!E||!i,className:"w-full flex items-center justify-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white text-sm font-black py-4 rounded-2xl transition-all disabled:opacity-50 shadow-xl shadow-emerald-600/20 active:scale-95 uppercase tracking-widest",children:[e.jsx(fe,{className:"w-4 h-4"}),y?"Processing...":"Request Withdrawal"]}),e.jsx("p",{className:"text-[10px] text-gray-400 text-center mt-4",children:"Transactions include a 2.0% platform processing fee."})]})]})]})}),q&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-3xl shadow-2xl overflow-hidden animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e.jsxs("div",{className:"p-6 border-b border-gray-50 flex items-center justify-between bg-gray-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-900 rounded-xl flex items-center justify-center shadow-lg shadow-slate-900/20 text-white",children:e.jsx(Ie,{className:"w-5 h-5"})}),e.jsx("h3",{className:"text-lg font-black text-gray-900 uppercase tracking-tight",children:"Withdrawal History"})]}),e.jsx("button",{onClick:()=>R(!1),className:"p-2 hover:bg-gray-100 rounded-xl transition-all",children:e.jsx(le,{className:"w-5 h-5 text-gray-400"})})]}),e.jsx("div",{className:"p-0 overflow-hidden",children:e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-gray-50/80 sticky top-0 backdrop-blur-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Gateway"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Amount"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:O.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:4,className:"px-6 py-12 text-center",children:[e.jsx(Ie,{className:"w-12 h-12 text-gray-100 mx-auto mb-4"}),e.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase tracking-widest",children:"No transaction history found"})]})}):O.map(m=>e.jsxs("tr",{className:"hover:bg-gray-50/50 group transition-all",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("span",{className:"text-xs font-bold text-gray-900 leading-none block",children:new Date(m.requested_at).toLocaleDateString()}),e.jsx("span",{className:"text-[10px] text-gray-400 font-medium",children:new Date(m.requested_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"text-xs font-black text-gray-600 uppercase tracking-tighter",children:m.payment_method})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"text-sm font-black text-gray-900",children:["$",m.amount.toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-[9px] font-black uppercase tracking-widest ${m.status==="completed"?"bg-green-50 text-green-700":m.status==="pending"?"bg-amber-50 text-amber-700":"bg-red-50 text-red-700"}`,children:m.status})})]},m.id))})]})})}),e.jsxs("div",{className:"p-6 bg-gray-50 border-t border-gray-100 flex justify-between items-center",children:[e.jsxs("span",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:["Showing ",O.length," Transactions"]}),e.jsx("button",{onClick:()=>R(!1),className:"text-xs font-black text-emerald-600 hover:text-emerald-700 uppercase tracking-tight",children:"Close Records"})]})]})}),r.length===0&&!k&&!g&&e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl p-8 text-center shadow-sm",children:[e.jsx(pe,{className:"w-12 h-12 text-gray-100 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-gray-400 font-bold uppercase tracking-widest",children:"No active currencies configured."})]})]})}function es(){const{user:r}=de(),[C,P]=a.useState([]),[j,L]=a.useState(0),[u,O]=a.useState(!1),[S,p]=a.useState(!1),N=a.useRef(null);a.useEffect(()=>{if(!r)return;k();const n=x.channel("vendor-notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${r.id}`},v=>{const d=v.new;P(c=>[d,...c]),L(c=>c+1)}).subscribe(),f=v=>{N.current&&!N.current.contains(v.target)&&O(!1)};return document.addEventListener("mousedown",f),()=>{x.removeChannel(n),document.removeEventListener("mousedown",f)}},[r]);const k=async()=>{if(!r)return;p(!0);const{data:n,error:f}=await x.from("notifications").select("*").eq("user_id",r.id).order("created_at",{ascending:!1}).limit(20);!f&&n&&(P(n),L(n.filter(v=>!v.is_read).length)),p(!1)},I=async n=>{P(f=>f.map(v=>v.id===n?{...v,is_read:!0}:v)),L(f=>Math.max(0,f-1)),await x.from("notifications").update({is_read:!0}).eq("id",n)},y=async()=>{P(n=>n.map(f=>({...f,is_read:!0}))),L(0),await x.from("notifications").update({is_read:!0}).eq("user_id",r==null?void 0:r.id).eq("is_read",!1)},D=async(n,f)=>{var d;f.stopPropagation();const v=((d=C.find(c=>c.id===n))==null?void 0:d.is_read)===!1;P(c=>c.filter(_=>_.id!==n)),v&&L(c=>Math.max(0,c-1)),await x.from("notifications").delete().eq("id",n)},g=n=>{switch(n){case"success":return e.jsx(re,{className:"h-5 w-5 text-green-500"});case"warning":return e.jsx(be,{className:"h-5 w-5 text-amber-500"});case"error":return e.jsx(be,{className:"h-5 w-5 text-red-500"});default:return e.jsx(Fe,{className:"h-5 w-5 text-blue-500"})}};return e.jsxs("div",{className:"relative",ref:N,children:[e.jsxs("button",{onClick:()=>O(!u),className:"relative p-2.5 rounded-xl hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-500 dark:text-slate-400 transition-colors",children:[e.jsx(tt,{className:"w-5 h-5"}),j>0&&e.jsx("span",{className:"absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full ring-2 ring-white dark:ring-slate-900 animate-pulse"})]}),u&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-96 bg-white dark:bg-slate-900 rounded-2xl shadow-xl border border-slate-100 dark:border-slate-800 overflow-hidden z-50 animate-in fade-in slide-in-from-top-2",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-800 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:"Notifications"}),j>0&&e.jsxs("span",{className:"bg-emerald-100 dark:bg-emerald-500/20 text-emerald-600 dark:text-emerald-400 text-xs font-bold px-2 py-0.5 rounded-full",children:[j," new"]})]}),j>0&&e.jsx("button",{onClick:y,className:"text-xs font-bold text-emerald-600 hover:text-emerald-700 dark:text-emerald-400 dark:hover:text-emerald-300 transition-colors",children:"Mark all read"})]}),e.jsx("div",{className:"max-h-[400px] overflow-y-auto custom-scrollbar",children:S&&C.length===0?e.jsxs("div",{className:"p-8 text-center text-slate-400",children:[e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-emerald-500 border-t-transparent rounded-full mx-auto mb-2"}),e.jsx("p",{className:"text-xs",children:"Loading..."})]}):C.length===0?e.jsxs("div",{className:"p-8 text-center text-slate-400",children:[e.jsx(tt,{className:"w-8 h-8 mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm font-medium",children:"No notifications"})]}):e.jsx("div",{className:"divide-y divide-slate-50 dark:divide-slate-800",children:C.map(n=>e.jsx("div",{className:`p-4 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors relative group ${n.is_read?"":"bg-slate-50/50 dark:bg-slate-800/30"}`,onClick:()=>I(n.id),children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"mt-1 shrink-0",children:g(n.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:`text-sm font-semibold ${n.is_read?"text-slate-600 dark:text-slate-400":"text-slate-900 dark:text-white"}`,children:n.title}),e.jsx("span",{className:"text-[10px] text-slate-400 shrink-0 whitespace-nowrap",children:new Date(n.created_at).toLocaleDateString(void 0,{month:"short",day:"numeric"})})]}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1 line-clamp-2",children:n.message})]}),e.jsx("button",{onClick:f=>D(n.id,f),className:"opacity-0 group-hover:opacity-100 p-1 text-slate-400 hover:text-red-500 transition-all absolute top-2 right-2 bg-white dark:bg-slate-900 shadow-sm rounded-lg",children:e.jsx(le,{className:"w-3 h-3"})})]})},n.id))})}),e.jsx("div",{className:"p-2 border-t border-slate-100 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/50 text-center",children:e.jsx(He,{to:"/notifications",className:"text-xs font-bold text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200 transition-colors",children:"View All Notifications"})})]})]})}const nt=[{id:"overview",label:"Dashboard",icon:e.jsx(qt,{className:"h-5 w-5"}),section:"Main"},{id:"pos",label:"Point of Sale (POS)",icon:e.jsx(Ot,{className:"h-5 w-5"}),section:"Main"},{id:"messages",label:"Customer Messages",icon:e.jsx(je,{className:"h-5 w-5"}),section:"Main"},{id:"orders",label:"Orders",icon:e.jsx(we,{className:"h-5 w-5"}),section:"Shop Management"},{id:"products",label:"Products",icon:e.jsx(Ye,{className:"h-5 w-5"}),section:"Shop Management"},{id:"wallet",label:"Wallet Management",icon:e.jsx(ge,{className:"h-5 w-5"}),section:"Shop Management"},{id:"refunds",label:"Refunds",icon:e.jsx(pt,{className:"h-5 w-5"}),section:"Shop Management"},{id:"ads",label:"Ads & Marketing",icon:e.jsx(Te,{className:"h-5 w-5"}),section:"Shop Management"},{id:"reports",label:"Reports & Analytics",icon:e.jsx(Le,{className:"h-5 w-5"}),section:"Shop Management"},{id:"packages",label:"Vendor Packages",icon:e.jsx(ae,{className:"h-5 w-5"}),section:"Shop Management"},{id:"kyc",label:"KYC Verification",icon:e.jsx(mt,{className:"h-5 w-5"}),section:"Configuration"},{id:"settings",label:"Shop Settings",icon:e.jsx(It,{className:"h-5 w-5"}),section:"Configuration"}];function ts({children:r,activeTab:C,onTabChange:P,hasPosAccess:j=!1}){var ve;const L=nt.filter(F=>!(F.id==="pos"&&!j)),u=Array.from(new Set(L.map(F=>F.section))),O=ct(),{signOut:S,profile:p}=de(),{settings:N}=kt(),{theme:k,toggleTheme:I}=_t(),[y,D]=a.useState(!1),[g,n]=a.useState(()=>localStorage.getItem("vendor-sidebar-collapsed")==="true"),[f,v]=a.useState(!1),[d,c]=a.useState(""),_=a.useRef(null),s=a.useRef(null),[o,b]=a.useState(0),[q,R]=a.useState(!1),[E,B]=a.useState(null);a.useEffect(()=>{const F=W=>{_.current&&!_.current.contains(W.target)&&v(!1)};return f&&document.addEventListener("mousedown",F),()=>{document.removeEventListener("mousedown",F)}},[f]),a.useEffect(()=>{localStorage.setItem("vendor-sidebar-collapsed",g.toString())},[g]),a.useLayoutEffect(()=>{const F=s.current;if(F){const W=sessionStorage.getItem("vendorSidebarScroll");W&&(F.scrollTop=parseInt(W,10))}},[]);const[i,h]=a.useState(null);a.useEffect(()=>{if(p!=null&&p.id){x.from("vendor_profiles").select("kyc_status").eq("user_id",p.id).maybeSingle().then(({data:Z})=>{Z&&h(Z.kyc_status)});const F=async()=>{var se;const{count:Z}=await x.from("chat_messages").select("*",{count:"exact",head:!0}).eq("is_read",!1).neq("sender_id",p.id).in("conversation_id",((se=(await x.from("chat_conversations").select("id").contains("participant_ids",[p.id])).data)==null?void 0:se.map(ke=>ke.id))||[]);b(Z||0)};F();const W=x.channel("vendor-unread-messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages"},Z=>{Z.new.sender_id!==p.id&&(b(se=>se+1),C!=="messages"&&(R(!0),x.from("profiles").select("full_name").eq("id",Z.new.sender_id).single().then(({data:se})=>{B((se==null?void 0:se.full_name)||"Customer")}),setTimeout(()=>R(!1),5e3)))}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"chat_messages"},()=>{F()}).subscribe();return()=>{x.removeChannel(W)}}},[p==null?void 0:p.id]);const l=()=>{s.current&&sessionStorage.setItem("vendorSidebarScroll",s.current.scrollTop.toString())},U=async()=>{await S(),O("/login")},T=nt.filter(F=>F.label.toLowerCase().includes(d.toLowerCase())||F.section.toLowerCase().includes(d.toLowerCase())).reduce((F,W)=>(F[W.section]||(F[W.section]=[]),F[W.section].push(W),F),{}),V=k==="dark",m=V?"bg-slate-900":"bg-[#fcfcfc]",A=V?"bg-slate-800":"bg-white",z=V?"bg-slate-800/80":"bg-white/80",Y=V?"border-slate-700":"border-slate-200",J=V?"text-white":"text-slate-900",Q=V?"text-slate-400":"text-slate-500",te=V?"hover:bg-slate-700":"hover:bg-slate-50",ne=V?"bg-emerald-900/40 text-emerald-400":"bg-emerald-50 text-emerald-700";return e.jsxs("div",{className:`min-h-screen ${m} font-sans transition-colors duration-300`,children:[e.jsxs("aside",{ref:s,className:`
          fixed top-0 left-0 bottom-0 z-50
          ${g?"w-20":"w-72"}
          ${A} border-r ${Y}
          flex flex-col
          transition-all duration-300 ease-in-out
          ${y?"translate-x-0":"-translate-x-full lg:translate-x-0"}
          shadow-xl lg:shadow-none
        `,children:[e.jsxs("div",{className:`
                    h-20 flex items-center ${g?"justify-center":"justify-between px-6"}
                    border-b ${Y}
                `,children:[e.jsx("div",{className:"flex items-center gap-3 overflow-hidden",children:e.jsx("div",{className:`shrink-0 transition-all duration-300 ${g?"w-10 h-10":"w-40 h-12"} flex items-center justify-center`,children:e.jsx("img",{src:N.site_logo,alt:N.site_name,className:"w-full h-full object-contain",onError:F=>{F.currentTarget.src="/zimaio_mineral_edition,_no_background_v1.2.png"}})})}),!g&&e.jsx("button",{onClick:()=>D(!1),className:"lg:hidden p-2 text-slate-400 hover:text-slate-600",children:e.jsx(le,{className:"w-5 h-5"})})]}),e.jsx("nav",{className:"flex-1 overflow-y-auto py-6 px-3 custom-scrollbar",children:u.map(F=>e.jsxs("div",{className:"mb-8",children:[!g&&e.jsx("h3",{className:`text-[10px] font-bold uppercase tracking-widest ${Q} mb-3 px-4`,children:F}),e.jsx("div",{className:"space-y-1",children:L.filter(W=>W.section===F).map(W=>{const Z=C===W.id;return e.jsxs("button",{onClick:()=>{P(W.id),D(!1),l()},className:`
                          w-full group flex items-center ${g?"justify-center py-3":"px-4 py-3"}
                          rounded-xl transition-all duration-200
                          ${Z?ne+" font-semibold":`${Q} ${te}`}
                          hover:shadow-sm
                        `,title:g?W.label:"",children:[e.jsx("div",{className:`
                          ${Z?"":"group-hover:text-slate-800 dark:group-hover:text-slate-200"}
                          transition-colors duration-200
                        `,children:W.icon}),!g&&e.jsx("span",{className:"ml-3 text-sm truncate",children:W.label}),W.id==="messages"&&o>0&&e.jsx("div",{className:`
                                                        ${g?"absolute -top-1 -right-1":"ml-auto"}
                                                        bg-rose-500 text-white text-[9px] font-black px-1.5 py-0.5 rounded-full shadow-lg animate-bounce
                                                    `,children:o}),Z&&!g&&W.id!=="messages"&&e.jsx("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-emerald-500"})]},W.id)})})]},F))}),e.jsx("div",{className:`p-4 border-t ${Y}`,children:e.jsxs("button",{onClick:()=>n(!g),className:`
              w-full flex items-center ${g?"justify-center":"justify-center gap-3"}
              p-3 rounded-xl
              ${V?"bg-slate-800 hover:bg-slate-700":"bg-gray-50 hover:bg-gray-100"}
              transition-colors duration-200 text-slate-500 hover:text-slate-700
            `,children:[g?e.jsx(st,{className:"w-5 h-5"}):e.jsx(Mt,{className:"w-5 h-5"}),!g&&e.jsx("span",{className:"text-sm font-semibold",children:"Collapse Sidebar"})]})})]}),y&&e.jsx("div",{className:"fixed inset-0 bg-slate-900/50 backdrop-blur-sm z-40 lg:hidden transition-opacity",onClick:()=>D(!1)}),e.jsxs("div",{className:`
        min-h-screen flex flex-col
        transition-all duration-300 ease-in-out
        ${g?"lg:pl-20":"lg:pl-72"}
      `,children:[e.jsxs("header",{className:`
          sticky top-0 z-30
          h-20 px-4 sm:px-8
          ${z} backdrop-blur-md
          border-b ${Y}
          flex items-center justify-between
        `,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>D(!0),className:`lg:hidden p-2 rounded-xl ${te} text-slate-500`,children:e.jsx(St,{className:"w-6 h-6"})}),i!=="approved"&&i!=="pending"&&e.jsxs("div",{className:"hidden xl:flex items-center gap-3 px-4 py-2 bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-900/30 rounded-xl animate-in slide-in-from-left-4 duration-500",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center text-blue-600 dark:text-blue-500",children:e.jsx(mt,{size:16})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-blue-800 dark:text-blue-400 leading-none",children:"KYC Required"}),e.jsx("p",{className:"text-[9px] font-bold text-blue-700/70 dark:text-blue-500/70 mt-1",children:"Submit documents for full access"})]}),e.jsx("button",{onClick:()=>P("kyc"),className:"ml-2 text-[9px] font-black bg-blue-800 text-white px-3 py-1.5 rounded-lg hover:bg-blue-900 transition-all uppercase tracking-widest active:scale-95",children:"Verify"})]}),e.jsxs("div",{className:"relative",ref:_,children:[e.jsxs("button",{onClick:()=>{v(!f),f||c("")},className:`hidden md:flex items-center gap-2 px-4 py-2.5 rounded-xl bg-emerald-600 dark:bg-emerald-500 text-white hover:bg-emerald-700 dark:hover:bg-emerald-600 transition-all border border-transparent group shadow-lg shadow-emerald-500/20 active:scale-95 ${f?"ring-2 ring-white/50 border-white":""}`,children:[e.jsx(ut,{className:`w-4 h-4 transition-colors ${f?"text-white":"text-white/80 group-hover:text-white"}`}),e.jsx("span",{className:"text-sm font-bold",children:"Quick Actions"}),e.jsx("span",{className:"ml-2 text-[10px] font-mono bg-white/20 px-1.5 py-0.5 rounded text-white/90",children:"⌘K"})]}),f&&e.jsxs("div",{className:"absolute top-full left-0 mt-2 w-80 max-h-[600px] bg-white dark:bg-slate-800 rounded-xl shadow-xl border border-slate-200 dark:border-slate-700 overflow-hidden z-50 animate-in fade-in slide-in-from-top-2",children:[e.jsx("div",{className:"p-3 border-b border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50 sticky top-0",children:e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx("input",{autoFocus:!0,type:"text",placeholder:"Search modules...",className:"w-full pl-9 pr-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-emerald-500/50 transition-all",value:d,onChange:F=>c(F.target.value)})]})}),e.jsx("div",{className:"overflow-y-auto max-h-[500px] p-2 custom-scrollbar",children:Object.keys(T).length===0?e.jsx("div",{className:"text-center py-8 text-slate-500",children:e.jsx("p",{className:"text-xs",children:"No matching modules found."})}):Object.entries(T).map(([F,W])=>e.jsxs("div",{className:"mb-4 last:mb-0",children:[e.jsx("h4",{className:"px-2 mb-1.5 text-[10px] font-bold uppercase tracking-wider text-slate-400",children:F}),e.jsx("div",{className:"space-y-0.5",children:W.map(Z=>e.jsxs("button",{onClick:()=>{P(Z.id),v(!1)},className:"w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 text-slate-700 dark:text-slate-300 hover:text-emerald-700 dark:hover:text-emerald-400 transition-colors group",children:[Z.icon,e.jsx("span",{className:"text-sm font-medium",children:Z.label}),d&&e.jsx(st,{className:"w-3 h-3 ml-auto text-slate-300 group-hover:text-emerald-500"})]},Z.id))})]},F))})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("button",{onClick:I,className:`p-2.5 rounded-xl ${te} ${Q} transition-all active:scale-95 border ${Y}`,title:V?"Switch to Light Mode":"Switch to Dark Mode",children:V?e.jsx(Ct,{className:"w-5 h-5 text-yellow-400"}):e.jsx(Dt,{className:"w-5 h-5"})}),e.jsx(es,{}),e.jsxs(He,{to:"/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-bold text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 transition-all shadow-lg shadow-blue-500/20 border border-transparent active:scale-95",children:[e.jsx(Ut,{className:"w-4 h-4"}),e.jsx("span",{children:"View Site"})]}),e.jsx("div",{className:`h-8 w-[1px] ${V?"bg-slate-700":"bg-slate-200"} mx-1`}),e.jsxs("div",{className:"flex items-center gap-3 pl-1",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:`text-sm font-bold ${J} leading-none`,children:(p==null?void 0:p.full_name)||"Vendor"}),e.jsx("p",{className:`text-xs ${Q} mt-0.5`,children:p==null?void 0:p.email})]}),e.jsxs("div",{className:"relative group cursor-pointer",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-tr from-emerald-600 to-green-600 p-[2px]",children:e.jsx("div",{className:`w-full h-full rounded-[10px] ${A} flex items-center justify-center`,children:e.jsx("span",{className:"font-bold text-transparent bg-clip-text bg-gradient-to-tr from-emerald-600 to-green-600",children:((ve=p==null?void 0:p.full_name)==null?void 0:ve.charAt(0))||"V"})})}),e.jsx("div",{className:`
                    absolute right-0 top-full mt-2 w-48 py-2 rounded-xl shadow-xl
                    ${A} border ${Y}
                    opacity-0 invisible group-hover:opacity-100 group-hover:visible
                    transform translate-y-2 group-hover:translate-y-0
                    transition-all duration-200
                  `,children:e.jsxs("button",{onClick:U,className:"w-full flex items-center gap-3 px-4 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[e.jsx(Pt,{className:"w-4 h-4"}),"Sign Out"]})})]})]})]})]}),q&&C!=="messages"&&e.jsx("div",{className:"fixed bottom-10 right-10 z-[100] animate-in slide-in-from-right-10 duration-500",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 border-2 border-emerald-500 rounded-2xl shadow-2xl p-6 flex items-center gap-6 max-w-sm",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-100 dark:bg-emerald-900/30 rounded-2xl flex items-center justify-center text-emerald-600",children:e.jsx(je,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-black text-slate-900 dark:text-white uppercase tracking-tight",children:"New Message Received!"}),e.jsxs("p",{className:"text-[10px] text-slate-500 dark:text-slate-400 font-bold uppercase tracking-widest mt-1",children:[E," is waiting for a response."]}),e.jsx("button",{onClick:()=>{P("messages"),R(!1)},className:"mt-4 text-[10px] font-black text-emerald-600 dark:text-emerald-400 uppercase tracking-[0.2em] hover:underline",children:"Reply Now →"})]}),e.jsx("button",{onClick:()=>R(!1),className:"p-2 text-slate-300 hover:text-slate-500 transition-colors",children:e.jsx(le,{className:"w-4 h-4"})})]})}),e.jsx("main",{className:"flex-1 p-6 lg:p-10 overflow-x-hidden",children:e.jsx("div",{className:"max-w-[1600px] mx-auto animate-fadeIn",children:r})})]})]})}function ss(){const{user:r}=de(),[C,P]=a.useState(""),[j,L]=a.useState(""),[u,O]=a.useState(""),[S,p]=a.useState(""),[N,k]=a.useState(""),[I,y]=a.useState(""),[D,g]=a.useState("USD"),[n,f]=a.useState(!1),[v,d]=a.useState(!1),[c,_]=a.useState(!1),[s,o]=a.useState(null);a.useEffect(()=>{b()},[r]);const b=async()=>{if(!r)return;const{data:i}=await x.from("vendor_profiles").select("shop_name, shop_description, shop_logo_url, shop_banner_url").eq("user_id",r.id).single();i&&(O(i.shop_name||""),p(i.shop_description||""),k(i.shop_logo_url||""),y(i.shop_banner_url||""));const{data:h}=await x.from("profiles").select("currency_code").eq("id",r.id).single();h&&g(h.currency_code||"USD")},q=async(i,h)=>{var G;const l=(G=i.target.files)==null?void 0:G[0];if(!l||!r)return;const U=h==="logo";U?d(!0):_(!0),o(null);try{const T=l.name.split(".").pop(),V=`${r.id}/${h}-${Math.random()}.${T}`,{error:m}=await x.storage.from("shop-assets").upload(V,l);if(m)throw m;const{data:{publicUrl:A}}=x.storage.from("shop-assets").getPublicUrl(V);U?k(A):y(A),o({type:"success",text:`${h==="logo"?"Logo":"Banner"} uploaded. Remember to save changes.`})}catch(T){o({type:"error",text:T.message})}finally{U?d(!1):_(!1)}},R=async i=>{i.preventDefault(),f(!0),o(null);try{const{error:h}=await x.from("vendor_profiles").update({shop_name:u,shop_description:S,shop_logo_url:N,shop_banner_url:I}).eq("user_id",r==null?void 0:r.id);if(h)throw h;const{error:l}=await x.from("profiles").update({currency_code:D}).eq("id",r==null?void 0:r.id);if(l)throw l;o({type:"success",text:"Financial and shop settings updated successfully."})}catch(h){o({type:"error",text:h.message})}finally{f(!1)}},E=async i=>{i.preventDefault(),f(!0),o(null);try{const{error:h}=await x.auth.updateUser({email:C});if(h)throw h;o({type:"success",text:"Confirmation link sent to your new email."})}catch(h){o({type:"error",text:h.message})}finally{f(!1)}},B=async i=>{i.preventDefault(),f(!0),o(null);try{const{error:h}=await x.auth.updateUser({password:j});if(h)throw h;o({type:"success",text:"Password updated successfully."}),L("")}catch(h){o({type:"error",text:h.message})}finally{f(!1)}};return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Settings"}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Manage your shop profile and account security."})]}),s&&e.jsxs("div",{className:`p-3 rounded-lg flex items-center gap-2 text-sm ${s.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:[s.type==="success"?e.jsx(re,{className:"w-4 h-4"}):e.jsx(oe,{className:"w-4 h-4"}),s.text]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"bg-emerald-50 p-2 rounded-lg",children:e.jsx(ye,{className:"w-4 h-4 text-emerald-600"})}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"Shop Details"})]}),e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5",children:"Shop Name"}),e.jsx("input",{type:"text",required:!0,value:u,onChange:i=>O(i.target.value),className:"w-full px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all",placeholder:"My Awesome Shop"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5",children:"Description"}),e.jsx("textarea",{rows:3,value:S,onChange:i=>p(i.target.value),className:"w-full px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all resize-none",placeholder:"Brief description of your shop..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5 text-emerald-600 uppercase tracking-widest",children:"Shop Logo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-20 h-20 rounded-2xl border-2 border-dashed border-gray-200 bg-gray-50 flex items-center justify-center overflow-hidden group hover:border-emerald-500 transition-colors relative",children:[N?e.jsx("img",{src:N,className:"w-full h-full object-cover"}):e.jsx(Ve,{className:"w-6 h-6 text-gray-300 group-hover:text-emerald-500 transition-colors"}),v&&e.jsx("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center",children:e.jsx("div",{className:"w-5 h-5 border-2 border-emerald-600 border-t-transparent rounded-full animate-spin"})})]}),e.jsxs("label",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer bg-white border border-gray-200 hover:border-emerald-500 px-4 py-2.5 rounded-xl text-sm font-bold text-gray-600 hover:text-emerald-600 shadow-sm transition-all active:scale-95",children:[e.jsx(Ne,{className:"w-4 h-4"}),v?"Uploading...":"Change Logo"]}),e.jsx("input",{type:"file",accept:"image/*",onChange:i=>q(i,"logo"),disabled:v,className:"hidden"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5 text-emerald-600 uppercase tracking-widest",children:"Shop Banner"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-20 h-20 rounded-2xl border-2 border-dashed border-gray-200 bg-gray-50 flex items-center justify-center overflow-hidden group hover:border-emerald-500 transition-colors relative",children:[I?e.jsx("img",{src:I,className:"w-full h-full object-cover"}):e.jsx(Ve,{className:"w-6 h-6 text-gray-300 group-hover:text-emerald-500 transition-colors"}),c&&e.jsx("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center",children:e.jsx("div",{className:"w-5 h-5 border-2 border-emerald-600 border-t-transparent rounded-full animate-spin"})})]}),e.jsxs("label",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer bg-white border border-gray-200 hover:border-emerald-500 px-4 py-2.5 rounded-xl text-sm font-bold text-gray-600 hover:text-emerald-600 shadow-sm transition-all active:scale-95",children:[e.jsx(Ne,{className:"w-4 h-4"}),c?"Uploading...":"Change Banner"]}),e.jsx("input",{type:"file",accept:"image/*",onChange:i=>q(i,"banner"),disabled:c,className:"hidden"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsxs("button",{type:"submit",disabled:n,className:"flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white text-sm font-medium px-4 py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(fe,{className:"w-3.5 h-3.5"}),n?"Saving...":"Save Settings"]})})]})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"bg-cyan-50 p-2 rounded-lg",children:e.jsx(pe,{className:"w-4 h-4 text-cyan-600"})}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"Financial Settings"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5 uppercase tracking-widest",children:"Withdrawal & Payout Currency"}),e.jsx("p",{className:"text-[10px] text-gray-400 mb-3 font-bold uppercase tracking-widest leading-relaxed",children:"Select how you want to receive your profits and view your primary balances."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>g("USD"),className:`px-6 py-4 rounded-xl border-2 transition-all flex items-center justify-between ${D==="USD"?"border-cyan-500 bg-cyan-50/50 text-cyan-700":"border-gray-50 bg-gray-50/50 text-gray-400 opacity-50"}`,children:[e.jsxs("div",{className:"text-left font-black uppercase text-xs tracking-widest",children:["United States Dollar",e.jsx("p",{className:"font-bold text-[9px] opacity-60 mt-0.5",children:"International Standard (USD)"})]}),D==="USD"&&e.jsx(re,{size:16})]}),e.jsxs("button",{onClick:()=>g("ZIG"),className:`px-6 py-4 rounded-xl border-2 transition-all flex items-center justify-between ${D==="ZIG"?"border-amber-500 bg-amber-50/50 text-amber-700":"border-gray-50 bg-gray-50/50 text-gray-400 opacity-50"}`,children:[e.jsxs("div",{className:"text-left font-black uppercase text-xs tracking-widest",children:["Zimbabwe Gold",e.jsx("p",{className:"font-bold text-[9px] opacity-60 mt-0.5",children:"Local Stable (ZIG)"})]}),D==="ZIG"&&e.jsx(re,{size:16})]})]})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"bg-blue-50 p-2 rounded-lg",children:e.jsx($t,{className:"w-4 h-4 text-blue-600"})}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"Update Email"})]}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5",children:"Current Email"}),e.jsx("input",{type:"text",value:(r==null?void 0:r.email)||"",disabled:!0,className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-500 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5",children:"New Email"}),e.jsx("input",{type:"email",required:!0,value:C,onChange:i=>P(i.target.value),className:"w-full px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",placeholder:"new@example.com"})]}),e.jsxs("button",{type:"submit",disabled:n||!C,className:"w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed mt-2",children:[e.jsx(fe,{className:"w-3.5 h-3.5"}),n?"Updating...":"Update Email"]})]})]}),e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx("div",{className:"bg-purple-50 p-2 rounded-lg",children:e.jsx(Ft,{className:"w-4 h-4 text-purple-600"})}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"Change Password"})]}),e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-700 mb-1.5",children:"New Password"}),e.jsx("input",{type:"password",required:!0,minLength:6,value:j,onChange:i=>L(i.target.value),className:"w-full px-3 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-purple-500/20 focus:border-purple-500 outline-none transition-all",placeholder:"Min 6 chars"})]}),e.jsxs("div",{className:"pt-[52px]",children:[" ",e.jsxs("button",{type:"submit",disabled:n||!j,className:"w-full flex items-center justify-center gap-2 bg-purple-600 hover:bg-purple-700 text-white text-sm font-medium py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(fe,{className:"w-3.5 h-3.5"}),n?"Updating...":"Update Password"]})]})]})]})]})]})}function as(){var et;a.useEffect(()=>{console.log("VendorProductManagement MOUNTED")},[]);const[r,C]=ot(),[P,j]=a.useState([]),[L,u]=a.useState([]),[O,S]=a.useState([]),[p,N]=a.useState(!0),[k,I]=a.useState(""),[y,D]=a.useState("all"),[g,n]=a.useState("all"),[f,v]=a.useState("all"),[d,c]=a.useState("table"),[_,s]=a.useState(null),[o,b]=a.useState(null),[q,R]=a.useState(!1),[E,B]=a.useState(!1),[i,h]=a.useState({name:"",base_price:"",stock_quantity:"",category_id:"",brand_id:"",is_featured:!1,sku:"",description:"",images:[],attributes:{colors:[]}}),[l,U]=a.useState(null),[G,T]=a.useState(!1),[V,m]=a.useState(!1),[A,z]=a.useState(!1),[Y,J]=a.useState(""),[Q,te]=a.useState("");a.useEffect(()=>{if(ve(),r.get("add")==="true"){R(!0);const t=new URLSearchParams(r);t.delete("add"),C(t)}},[]);const ne=async(t,w)=>{const $=t.target.files;if(!(!$||$.length===0)){if(!o){s({type:"error",text:"Error: Vendor profile not found. Please refresh the page."});return}z(!0);try{const M=Array.from($);for(const K of M){const H=URL.createObjectURL(K);w?U(X=>X?{...X,images:[...X.images||[],H].slice(0,5)}:null):h(X=>({...X,images:[...X.images||[],H].slice(0,5)}));const Ee=K.name.split(".").pop()||"jpg",he=`${o}/${Date.now()}-${Math.random().toString(36).substring(2,7)}.${Ee}`,{error:Ce}=await x.storage.from("product-images").upload(he,K,{cacheControl:"3600",upsert:!1});if(Ce){console.error("SUPABASE STORAGE ERROR:",Ce),console.error("Bucket: product-images, Path:",he),w?U(ee=>{if(!ee)return null;const Me=(ee.images||[]).filter(Nt=>Nt!==H);return{...ee,images:Me}}):h(ee=>({...ee,images:(ee.images||[]).filter(Me=>Me!==H)}));const X=Ce.message||JSON.stringify(Ce);throw new Error(`Upload precision failed: ${X}`)}const{data:Ue}=x.storage.from("product-images").getPublicUrl(he),De=Ue==null?void 0:Ue.publicUrl;if(!De)throw new Error("Failed to generate public URL for uploaded image");w?U(X=>X?{...X,images:(X.images||[]).map(ee=>ee===H?De:ee)}:null):h(X=>({...X,images:X.images.map(ee=>ee===H?De:ee)})),console.log("Image uploaded successfully:",De)}}catch(M){console.error("Final Image upload error:",M),s({type:"error",text:M.message||"Image upload failed"})}finally{z(!1),t.target.value=""}}},me=(t,w)=>{w&&l?U({...l,images:l.images.filter(($,M)=>M!==t)}):h({...i,images:i.images.filter(($,M)=>M!==t)})},ce=t=>{if(!t)return"";const w=t.split(" ").map(M=>M.substring(0,3).toUpperCase()).join("-").replace(/[^\w-]/g,""),$=Math.random().toString(36).substring(2,6).toUpperCase();return`${w}-${$}`},ve=async()=>{var t;N(!0);try{const{data:{user:w}}=await x.auth.getUser();if(!w)return;const[$,M,K,H]=await Promise.all([x.from("products").select("*, category:categories(name)").order("created_at",{ascending:!1}),x.from("categories").select("id, name").eq("is_active",!0),x.from("brands").select("id, name").eq("is_active",!0),x.from("vendor_profiles").select("id").eq("user_id",w.id).single()]);if(H.data){b(H.data.id);const Ee=((t=$.data)==null?void 0:t.filter(he=>he.vendor_id===H.data.id))||[];j(Ee)}u(M.data||[]),S(K.data||[])}catch(w){console.error("Error fetching products:",w)}finally{N(!1)}},F=async t=>{if(t.preventDefault(),!!o){B(!0);try{const w=i.name.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),{data:$,error:M}=await x.from("products").insert([{...i,base_price:parseFloat(i.base_price),stock_quantity:parseInt(i.stock_quantity),vendor_id:o,brand_id:i.brand_id||null,is_featured:i.is_featured,slug:w,is_active:!0}]).select("*, category:categories(name)").single();if(M)throw M;j(K=>[$,...K]),R(!1),h({name:"",base_price:"",stock_quantity:"",category_id:"",brand_id:"",is_featured:!1,sku:"",description:"",images:[],attributes:{colors:[]}}),m(!1),s({type:"success",text:"Product added successfully!"})}catch(w){s({type:"error",text:w.message})}finally{B(!1)}}},W=async t=>{if(t.preventDefault(),!!l){B(!0);try{const w=l.name.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),{data:$,error:M}=await x.from("products").update({name:l.name,base_price:parseFloat(l.base_price),stock_quantity:parseInt(l.stock_quantity),category_id:l.category_id,brand_id:l.brand_id||null,is_featured:l.is_featured,sku:l.sku,slug:w,description:l.description,images:l.images,attributes:l.attributes||{colors:[]}}).eq("id",l.id).select("*, category:categories(name)").single();if(M)throw M;j(K=>K.map(H=>H.id===$.id?$:H)),T(!1),U(null),s({type:"success",text:"Product updated successfully!"})}catch(w){s({type:"error",text:w.message})}finally{B(!1)}}},Z=async(t,w)=>{try{const{error:$}=await x.from("products").update({is_active:!w}).eq("id",t);if($)throw $;j(M=>M.map(K=>K.id===t?{...K,is_active:!w}:K)),s({type:"success",text:`Product ${w?"deactivated":"activated"} successfully.`})}catch($){s({type:"error",text:$.message})}},se=async(t,w)=>{try{if(w<0)return;const{error:$}=await x.from("products").update({stock_quantity:w}).eq("id",t);if($)throw $;j(M=>M.map(K=>K.id===t?{...K,stock_quantity:w}:K)),s({type:"success",text:"Stock updated successfully."})}catch($){s({type:"error",text:$.message})}},ke=async t=>{if(confirm("Are you sure you want to delete this product?"))try{const{error:w}=await x.from("products").delete().eq("id",t);if(w)throw w;j($=>$.filter(M=>M.id!==t)),s({type:"success",text:"Product deleted successfully."})}catch(w){s({type:"error",text:w.message})}},_e=t=>{var w,$;if(!(!Q||!Q.startsWith("#"))){if(t==="add"){const M=((w=i.attributes)==null?void 0:w.colors)||[];M.includes(Q)||h({...i,attributes:{...i.attributes,colors:[...M,Q]}})}else{const M=(($=l.attributes)==null?void 0:$.colors)||[];M.includes(Q)||U({...l,attributes:{...l.attributes,colors:[...M,Q]}})}te("")}},Ze=(t,w)=>{var $,M;if(w==="add"){const K=(($=i.attributes)==null?void 0:$.colors)||[];h({...i,attributes:{...i.attributes,colors:K.filter(H=>H!==t)}})}else{const K=((M=l.attributes)==null?void 0:M.colors)||[];U({...l,attributes:{...l.attributes,colors:K.filter(H=>H!==t)}})}},Xe=t=>{U({...t,images:Array.isArray(t.images)?t.images:[],base_price:t.base_price.toString(),stock_quantity:t.stock_quantity.toString(),brand_id:t.brand_id||"",is_featured:t.is_featured||!1,attributes:t.attributes||{colors:[]}}),T(!0)},Se=P.filter(t=>{var H;const w=t.name.toLowerCase().includes(k.toLowerCase())||(((H=t.sku)==null?void 0:H.toLowerCase())||"").includes(k.toLowerCase()),$=y==="all"||y==="active"&&t.is_active||y==="inactive"&&!t.is_active,M=g==="all"||g==="low"&&t.stock_quantity>0&&t.stock_quantity<=10||g==="out"&&t.stock_quantity===0,K=f==="all"||t.category_id===f;return w&&$&&M&&K}),Je=t=>t===0?{label:"Out of Stock",color:"text-red-600 bg-red-50 border-red-100",icon:e.jsx(ie,{className:"w-3 h-3"})}:t<=10?{label:"Low Stock",color:"text-amber-600 bg-amber-50 border-amber-100",icon:e.jsx(be,{className:"w-3 h-3"})}:{label:"In Stock",color:"text-emerald-600 bg-emerald-50 border-emerald-100",icon:e.jsx(re,{className:"w-3 h-3"})};return p?e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"}),e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Loading your inventory..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Product Management"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Manage your shop inventory, stock levels and visibility."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"bg-white p-1 rounded-xl border border-gray-200 flex shadow-sm",children:[e.jsx("button",{onClick:()=>c("table"),className:`p-2 rounded-lg transition-all ${d==="table"?"bg-emerald-50 text-emerald-600":"text-gray-400 hover:text-gray-600"}`,children:e.jsx(Tt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>c("grid"),className:`p-2 rounded-lg transition-all ${d==="grid"?"bg-emerald-50 text-emerald-600":"text-gray-400 hover:text-gray-600"}`,children:e.jsx(rt,{className:"w-4 h-4"})})]}),e.jsxs("button",{onClick:()=>R(!0),className:"flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2.5 rounded-xl text-sm font-bold transition-all shadow-lg shadow-emerald-600/20 active:scale-95",children:[e.jsx(Re,{className:"w-4 h-4"}),"Add Product"]})]})]}),_&&e.jsxs("div",{className:`p-3 rounded-xl flex items-center gap-3 text-sm font-medium animate-in fade-in slide-in-from-top-2 ${_.type==="success"?"bg-green-50 text-green-700 border border-green-100":"bg-red-50 text-red-700 border border-red-100"}`,children:[_.type==="success"?e.jsx(re,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"}),_.text,e.jsx("button",{onClick:()=>s(null),className:"ml-auto text-gray-400 hover:text-gray-600",children:e.jsx(Bt,{className:"w-4 h-4 rotate-90"})})]}),e.jsx("div",{className:"bg-white border border-gray-100 rounded-2xl p-4 shadow-sm space-y-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1 group",children:[e.jsx(xe,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 group-focus-within:text-emerald-500 transition-colors"}),e.jsx("input",{type:"text",placeholder:"Search by product name, SKU...",value:k,onChange:t=>I(t.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 border border-transparent rounded-xl text-sm focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"relative group",children:[e.jsx(gt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400"}),e.jsxs("select",{value:y,onChange:t=>D(t.target.value),className:"pl-8 pr-10 py-2.5 bg-gray-50 border border-transparent rounded-xl text-sm font-medium focus:bg-white focus:border-emerald-500 outline-none transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsx(qe,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400"}),e.jsxs("select",{value:g,onChange:t=>n(t.target.value),className:"pl-8 pr-10 py-2.5 bg-gray-50 border border-transparent rounded-xl text-sm font-medium focus:bg-white focus:border-emerald-500 outline-none transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"Stock Levels"}),e.jsx("option",{value:"low",children:"Low Stock"}),e.jsx("option",{value:"out",children:"Out of Stock"})]}),e.jsx(qe,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400"}),e.jsxs("select",{value:f,onChange:t=>v(t.target.value),className:"pl-8 pr-10 py-2.5 bg-gray-50 border border-transparent rounded-xl text-sm font-medium focus:bg-white focus:border-emerald-500 outline-none transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"Categories"}),L.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsx(qe,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]}),(k||y!=="all"||g!=="all"||f!=="all")&&e.jsx("button",{onClick:()=>{I(""),D("all"),n("all"),v("all")},className:"text-xs font-bold text-red-500 hover:text-red-600 transition-colors uppercase tracking-widest px-2",children:"Reset"})]})]})}),d==="table"?e.jsx("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50/50 border-b border-gray-100",children:[e.jsx("th",{className:"px-4 py-2.5 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Product"}),e.jsx("th",{className:"px-4 py-2.5 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Category"}),e.jsx("th",{className:"px-4 py-2.5 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Price"}),e.jsx("th",{className:"px-4 py-2.5 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Stock"}),e.jsx("th",{className:"px-4 py-2.5 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Status"}),e.jsx("th",{className:"px-4 py-2.5 text-[10px] font-black text-gray-400 uppercase tracking-widest text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:Se.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-20 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center",children:e.jsx(ae,{className:"w-8 h-8 text-gray-200"})}),e.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"No products found matching your criteria"})]})})}):Se.map(t=>{var $,M;const w=Je(t.stock_quantity);return e.jsxs("tr",{className:"hover:bg-gray-50/30 group transition-all",children:[e.jsx("td",{className:"px-4 py-2.5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg overflow-hidden shadow-sm shrink-0",children:($=t.images)!=null&&$[0]?e.jsx("img",{src:t.images[0],alt:t.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(ae,{className:"w-5 h-5 text-gray-300"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-black text-gray-900 leading-none group-hover:text-emerald-600 transition-colors uppercase tracking-tight line-clamp-1",children:t.name}),e.jsxs("p",{className:"text-[10px] text-gray-400 font-bold mt-0.5 uppercase tracking-tighter",children:["SKU: ",t.sku||"N/A"]})]})]})}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsx("span",{className:"text-[10px] font-black text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full uppercase tracking-widest truncate max-w-[100px] inline-block",children:((M=t.category)==null?void 0:M.name)||"Uncategorized"})}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsxs("span",{className:"text-xs font-black text-gray-900",children:["$",t.base_price.toFixed(2)]})}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-black text-gray-900",children:t.stock_quantity}),e.jsxs("div",{className:`flex items-center gap-1 px-1.5 py-0.5 rounded-full border text-[9px] font-black uppercase tracking-widest ${w.color}`,children:[w.icon,w.label]})]}),e.jsxs("div",{className:"flex gap-1 group-hover:opacity-100 opacity-50 transition-opacity",children:[e.jsx("button",{onClick:()=>se(t.id,t.stock_quantity-1),className:"w-5 h-5 border border-gray-200 rounded flex items-center justify-center hover:bg-red-50 hover:text-red-500 hover:border-red-200 transition-all text-xs",children:"-"}),e.jsx("button",{onClick:()=>se(t.id,t.stock_quantity+1),className:"w-5 h-5 border border-gray-200 rounded flex items-center justify-center hover:bg-emerald-50 hover:text-emerald-500 hover:border-emerald-200 transition-all text-xs",children:"+"})]})]})}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsxs("button",{onClick:()=>Z(t.id,t.is_active),className:`flex items-center gap-1.5 px-2 py-1 rounded-lg transition-all ${t.is_active?"bg-emerald-50 text-emerald-600 hover:bg-emerald-100":"bg-gray-100 text-gray-400 hover:bg-gray-200"}`,children:[t.is_active?e.jsx(Ae,{className:"w-3 h-3"}):e.jsx(at,{className:"w-3 h-3"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:t.is_active?"Active":"Inactive"})]})}),e.jsx("td",{className:"px-4 py-2.5 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1.5",children:[e.jsx("button",{onClick:()=>Xe(t),className:"p-1.5 text-gray-400 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-all",title:"Edit Product",children:e.jsx(ze,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>ke(t.id),className:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all",title:"Delete Product",children:e.jsx(Be,{className:"w-3.5 h-3.5"})})]})})]},t.id)})})]})})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Se.length===0?e.jsxs("div",{className:"col-span-full py-20 text-center bg-white rounded-2xl border border-gray-100",children:[e.jsx(ae,{className:"w-12 h-12 text-gray-100 mx-auto mb-4"}),e.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase tracking-widest",children:"No products found"})]}):Se.map(t=>{var $,M;const w=Je(t.stock_quantity);return e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl overflow-hidden shadow-sm hover:shadow-xl hover:shadow-gray-100 transition-all group",children:[e.jsxs("div",{className:"h-48 relative overflow-hidden bg-gray-50",children:[($=t.images)!=null&&$[0]?e.jsx("img",{src:t.images[0],alt:t.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(ae,{className:"w-12 h-12 text-gray-200"})}),e.jsxs("div",{className:"absolute top-3 left-3 flex flex-col gap-2",children:[e.jsxs("div",{className:`flex items-center gap-1.5 px-2.5 py-1 rounded-full border text-[9px] font-black uppercase tracking-widest shadow-sm backdrop-blur-md ${w.color} border-opacity-50`,children:[w.icon,w.label]}),e.jsxs("div",{className:`flex items-center gap-1.5 px-2.5 py-1 rounded-full border text-[9px] font-black uppercase tracking-widest shadow-sm backdrop-blur-md border-opacity-50 ${t.is_active?"bg-emerald-50/80 text-emerald-600 border-emerald-100":"bg-gray-100/80 text-gray-400 border-gray-200"}`,children:[t.is_active?e.jsx(Ae,{className:"w-3 h-3"}):e.jsx(at,{className:"w-3 h-3"}),t.is_active?"Visible":"Hidden"]})]})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black text-emerald-600 uppercase tracking-widest mb-1",children:((M=t.category)==null?void 0:M.name)||"Uncategorized"}),e.jsx("h4",{className:"text-sm font-black text-gray-900 uppercase tracking-tight line-clamp-1",children:t.name})]}),e.jsxs("p",{className:"text-lg font-black text-gray-900 leading-none",children:["$",t.base_price]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 mt-4 border-t border-gray-50",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:["STOCK: ",t.stock_quantity]})}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>Xe(t),className:"p-2 text-gray-400 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-all",children:e.jsx(ze,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>ke(t.id),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all",children:e.jsx(Be,{className:"w-3.5 h-3.5"})})]})]})]})]},t.id)})}),P.some(t=>t.stock_quantity>0&&t.stock_quantity<=10)&&e.jsxs("div",{className:"bg-amber-50 border border-amber-100 rounded-2xl p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center",children:e.jsx(be,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-black text-amber-900 uppercase tracking-tight",children:"Low Stock Alert"}),e.jsx("p",{className:"text-xs text-amber-700 font-medium",children:"Some of your products are running low. Consider restocking soon to avoid lost sales."})]})]}),e.jsx("button",{onClick:()=>n("low"),className:"text-xs font-black text-amber-600 hover:text-amber-700 uppercase tracking-widest px-4 py-2 bg-white rounded-xl shadow-sm border border-amber-200 transition-all hover:shadow-md",children:"Review Items"})]}),q&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[24px] shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200 flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b border-gray-50 flex items-center justify-between bg-gray-50/50 shrink-0",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-black text-gray-900 uppercase tracking-tight",children:"Add New Product"}),e.jsx("p",{className:"text-[9px] text-gray-400 font-bold uppercase tracking-wider",children:"List a new item in your store inventory"})]}),e.jsx("button",{onClick:()=>R(!1),className:"p-1.5 hover:bg-gray-100 rounded-lg transition-all",children:e.jsx(ie,{className:"w-5 h-5 text-gray-300"})})]}),e.jsxs("form",{onSubmit:F,className:"flex flex-col overflow-hidden",children:[e.jsx("div",{className:"p-5 overflow-y-auto space-y-3 custom-scrollbar",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Name *"}),e.jsx("input",{required:!0,type:"text",value:i.name,onChange:t=>{const w=t.target.value;h($=>({...$,name:w,sku:V?$.sku:ce(w)}))},className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all",placeholder:"e.g. Wireless Headphones"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"SKU (Auto-generated)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:i.sku,onChange:t=>{h({...i,sku:t.target.value}),m(!0)},className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all font-mono",placeholder:"WH-001"}),e.jsx("button",{type:"button",onClick:()=>{h({...i,sku:ce(i.name)}),m(!1)},className:"absolute right-2 top-1/2 -translate-y-1/2 p-1.5 text-emerald-600 hover:bg-emerald-50 rounded-lg transition-all",title:"Regenerate SKU",children:e.jsx(Re,{className:"w-3.5 h-3.5 rotate-45"})})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Base Price ($) *"}),e.jsx("input",{required:!0,type:"number",step:"0.01",value:i.base_price,onChange:t=>h({...i,base_price:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all",placeholder:"29.99"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Stock Quantity *"}),e.jsx("input",{required:!0,type:"number",value:i.stock_quantity,onChange:t=>h({...i,stock_quantity:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all",placeholder:"100"})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Category *"}),e.jsxs("div",{className:"relative group",children:[e.jsx(xe,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search category...",className:"pl-7 pr-3 py-1 bg-gray-100 border-none rounded-lg text-[10px] focus:ring-0 w-32 font-bold placeholder:text-gray-300 transition-all focus:w-48",value:Y,onChange:t=>J(t.target.value)})]})]}),e.jsxs("select",{required:!0,value:i.category_id,onChange:t=>h({...i,category_id:t.target.value}),className:"w-full px-3 py-2.5 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all appearance-none cursor-pointer font-bold text-gray-700",children:[e.jsx("option",{value:"",children:"Select Category"}),L.filter(t=>t.name.toLowerCase().includes(Y.toLowerCase())).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Brand"}),e.jsxs("select",{value:i.brand_id,onChange:t=>h({...i,brand_id:t.target.value}),className:"w-full px-3 py-2.5 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all appearance-none cursor-pointer font-bold text-gray-700",children:[e.jsx("option",{value:"",children:"Select Brand (Optional)"}),O.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"col-span-full space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Description"}),e.jsx("textarea",{rows:3,value:i.description,onChange:t=>h({...i,description:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all resize-none",placeholder:"Tell customers about your product..."})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Colors (Hex codes)"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(i.attributes.colors||[]).map((t,w)=>e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg border border-gray-100 bg-white shadow-sm transition-all hover:border-emerald-200 group",children:[e.jsx("div",{className:"w-3 h-3 rounded-full shadow-inner",style:{backgroundColor:t}}),e.jsx("span",{className:"text-[10px] font-bold text-gray-600 font-mono tracking-tighter",children:t}),e.jsx("button",{type:"button",onClick:()=>Ze(t,"add"),className:"p-0.5 text-gray-400 hover:text-red-500 rounded transition-colors",children:e.jsx(le,{className:"w-2.5 h-2.5"})})]},w))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1 group",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border border-gray-200",style:{backgroundColor:Q}}),e.jsx("input",{type:"text",value:Q,onChange:t=>te(t.target.value),onKeyDown:t=>t.key==="Enter"&&(t.preventDefault(),_e("add")),placeholder:"#FF5733",className:"w-full pl-9 pr-4 py-2 bg-gray-50 border border-transparent rounded-xl text-[12px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all font-mono"})]}),e.jsx("button",{type:"button",onClick:()=>_e("add"),className:"px-4 py-2 bg-emerald-600 text-white rounded-xl text-xs font-bold hover:bg-emerald-700 transition-all shadow-lg shadow-emerald-600/10",children:"Add"})]})]}),e.jsx("div",{className:"col-span-full py-2 border-t border-gray-50 mt-2",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group w-fit",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:i.is_featured,onChange:t=>h({...i,is_featured:t.target.checked})}),e.jsx("div",{className:`w-10 h-5 rounded-full transition-all duration-300 ${i.is_featured?"bg-emerald-500 shadow-lg shadow-emerald-200":"bg-gray-200"}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-3 h-3 bg-white rounded-full transition-transform duration-300 ${i.is_featured?"translate-x-5":""}`})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-black text-gray-700 uppercase tracking-widest block leading-none",children:"Featured Product"}),e.jsx("span",{className:"text-[8px] text-gray-400 font-bold uppercase tracking-tighter",children:"Show this in featured products sections"})]})]})}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Images (up to 5)"}),e.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[i.images.map((t,w)=>e.jsxs("div",{className:"relative aspect-square rounded-xl overflow-hidden group border border-gray-100 shadow-sm",children:[e.jsx("img",{src:t,className:"w-full h-full object-cover",alt:""}),e.jsx("button",{type:"button",onClick:()=>me(w,!1),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(le,{className:"w-2.5 h-2.5"})})]},w)),i.images.length<5&&e.jsxs("label",{className:"relative aspect-square rounded-xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center gap-1 cursor-pointer hover:border-emerald-500 hover:bg-emerald-50/30 transition-all group",children:[e.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.svg,.webp,.gif",multiple:!0,className:"hidden",onChange:t=>ne(t,!1),disabled:A}),A?e.jsx("div",{className:"w-4 h-4 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 text-gray-400 group-hover:text-emerald-500 transition-colors"}),e.jsx("span",{className:"text-[8px] font-black text-gray-400 uppercase group-hover:text-emerald-500 transition-colors",children:"Upload"}),e.jsx("span",{className:"text-[7px] text-gray-300 font-bold uppercase mt-0.5",children:"800x800px"})]})]})]})]})]})}),e.jsxs("div",{className:"p-4 bg-gray-50/50 border-t border-gray-50 flex gap-3 shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>R(!1),className:"flex-1 px-4 py-2 bg-white text-gray-500 font-bold rounded-xl hover:bg-gray-100 transition-all uppercase tracking-widest text-[9px] border border-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:E||A,className:"flex-[2] px-4 py-2 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-700 transition-all uppercase tracking-widest text-[9px] shadow-lg shadow-emerald-200 disabled:opacity-50 flex items-center justify-center gap-2",children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Saving..."]}):A?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Uploading Images..."]}):"Create Product"})]})]})]})}),G&&l&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[24px] shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200 flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b border-gray-50 flex items-center justify-between bg-gray-50/50 shrink-0",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-black text-gray-900 uppercase tracking-tight",children:"Edit Product"}),e.jsx("p",{className:"text-[9px] text-gray-400 font-bold uppercase tracking-wider",children:"Update your product information"})]}),e.jsx("button",{onClick:()=>T(!1),className:"p-1.5 hover:bg-gray-100 rounded-lg transition-all",children:e.jsx(ie,{className:"w-5 h-5 text-gray-300"})})]}),e.jsxs("form",{onSubmit:W,className:"flex flex-col overflow-hidden",children:[e.jsx("div",{className:"p-5 overflow-y-auto space-y-3 custom-scrollbar",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Name *"}),e.jsx("input",{required:!0,type:"text",value:l.name,onChange:t=>U({...l,name:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"SKU"}),e.jsx("input",{type:"text",value:l.sku,onChange:t=>U({...l,sku:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all font-mono"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Base Price ($) *"}),e.jsx("input",{required:!0,type:"number",step:"0.01",value:l.base_price,onChange:t=>U({...l,base_price:parseFloat(t.target.value)}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Stock Quantity *"}),e.jsx("input",{required:!0,type:"number",value:l.stock_quantity,onChange:t=>U({...l,stock_quantity:parseInt(t.target.value)}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all"})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Category *"}),e.jsxs("div",{className:"relative group",children:[e.jsx(xe,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3 h-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search category...",className:"pl-7 pr-3 py-1 bg-gray-100 border-none rounded-lg text-[10px] focus:ring-0 w-32 font-bold placeholder:text-gray-300 transition-all focus:w-48",value:Y,onChange:t=>J(t.target.value)})]})]}),e.jsxs("select",{required:!0,value:l.category_id,onChange:t=>U({...l,category_id:t.target.value}),className:"w-full px-3 py-2.5 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all appearance-none cursor-pointer font-bold text-gray-700",children:[e.jsx("option",{value:"",children:"Select Category"}),L.filter(t=>t.name.toLowerCase().includes(Y.toLowerCase())).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Brand"}),e.jsxs("select",{value:l.brand_id,onChange:t=>U({...l,brand_id:t.target.value}),className:"w-full px-3 py-2.5 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all appearance-none cursor-pointer font-bold text-gray-700",children:[e.jsx("option",{value:"",children:"Select Brand (Optional)"}),O.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsx("div",{className:"col-span-full py-2 border-t border-gray-50 mt-2",children:e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group w-fit",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",className:"sr-only",checked:l.is_featured,onChange:t=>U({...l,is_featured:t.target.checked})}),e.jsx("div",{className:`w-10 h-5 rounded-full transition-all duration-300 ${l.is_featured?"bg-emerald-500 shadow-lg shadow-emerald-200":"bg-gray-200"}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-3 h-3 bg-white rounded-full transition-transform duration-300 ${l.is_featured?"translate-x-5":""}`})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-black text-gray-700 uppercase tracking-widest block leading-none",children:"Featured Product"}),e.jsx("span",{className:"text-[8px] text-gray-400 font-bold uppercase tracking-tighter",children:"Show this in featured products sections"})]})]})}),e.jsxs("div",{className:"col-span-full space-y-1.5",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Description"}),e.jsx("textarea",{rows:3,value:l.description,onChange:t=>U({...l,description:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-transparent rounded-xl text-[13px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all resize-none"})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Colors (Hex codes)"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(((et=l.attributes)==null?void 0:et.colors)||[]).map((t,w)=>e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 rounded-lg border border-gray-100 bg-white shadow-sm transition-all hover:border-emerald-200 group",children:[e.jsx("div",{className:"w-3 h-3 rounded-full shadow-inner",style:{backgroundColor:t}}),e.jsx("span",{className:"text-[10px] font-bold text-gray-600 font-mono tracking-tighter",children:t}),e.jsx("button",{type:"button",onClick:()=>Ze(t,"edit"),className:"p-0.5 text-gray-400 hover:text-red-500 rounded transition-colors",children:e.jsx(le,{className:"w-2.5 h-2.5"})})]},w))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1 group",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 rounded-full border border-gray-200",style:{backgroundColor:Q}}),e.jsx("input",{type:"text",value:Q,onChange:t=>te(t.target.value),onKeyDown:t=>t.key==="Enter"&&(t.preventDefault(),_e("edit")),placeholder:"#FF5733",className:"w-full pl-9 pr-4 py-2 bg-gray-50 border border-transparent rounded-xl text-[12px] focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all font-mono"})]}),e.jsx("button",{type:"button",onClick:()=>_e("edit"),className:"px-4 py-2 bg-emerald-600 text-white rounded-xl text-xs font-bold hover:bg-emerald-700 transition-all shadow-lg shadow-emerald-600/10",children:"Add"})]})]}),e.jsxs("div",{className:"col-span-full space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none",children:"Product Images (up to 5)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-[8px] font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full uppercase tracking-tighter",children:"Recommended: 800x800px"}),e.jsx("span",{className:"text-[8px] font-bold text-gray-400 bg-gray-50 px-2 py-0.5 rounded-full uppercase tracking-tighter",children:"JPG, PNG, SVG, WEBP"})]})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-3",children:[(l.images||[]).map((t,w)=>e.jsxs("div",{className:"relative aspect-square rounded-xl overflow-hidden group border border-gray-100 shadow-sm bg-gray-50",children:[e.jsx("img",{src:t,className:"w-full h-full object-cover",alt:"",onError:$=>{$.target.src="https://placehold.co/400x400/f3f4f6/9ca3af?text=Image+Load+Error"}}),e.jsx("button",{type:"button",onClick:()=>me(w,!0),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity shadow-lg",children:e.jsx(le,{className:"w-2.5 h-2.5"})})]},w)),(l.images||[]).length<5&&e.jsxs("label",{className:"relative aspect-square rounded-xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center gap-1 cursor-pointer hover:border-emerald-500 hover:bg-emerald-50/30 transition-all group",children:[e.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.svg,.webp,.gif",multiple:!0,className:"hidden",onChange:t=>ne(t,!0),disabled:A}),A?e.jsx("div",{className:"w-4 h-4 border-2 border-emerald-500 border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"w-4 h-4 text-gray-400 group-hover:text-emerald-500 transition-colors"}),e.jsx("span",{className:"text-[8px] font-black text-gray-400 uppercase group-hover:text-emerald-500 transition-colors",children:"Upload"})]})]})]})]})]})}),e.jsxs("div",{className:"p-4 bg-gray-50/50 border-t border-gray-50 flex gap-3 shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>T(!1),className:"flex-1 px-4 py-2 bg-white text-gray-500 font-bold rounded-xl hover:bg-gray-100 transition-all uppercase tracking-widest text-[9px] border border-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:E||A,className:"flex-[2] px-4 py-2 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-700 transition-all uppercase tracking-widest text-[9px] shadow-lg shadow-emerald-200 disabled:opacity-50 flex items-center justify-center gap-2",children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Updating..."]}):A?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Uploading Images..."]}):"Save Changes"})]})]})]})})]})}function rs(){var c,_,s,o,b,q,R,E,B,i,h;const[r,C]=a.useState([]),[P,j]=a.useState(!0),[L,u]=a.useState(""),[O,S]=a.useState("all"),[p,N]=a.useState(null),[k,I]=a.useState(!1),[y,D]=a.useState(null);a.useEffect(()=>{g()},[]);const g=async()=>{j(!0);try{const{data:{user:l}}=await x.auth.getUser();if(!l)return;const{data:U}=await x.from("vendor_profiles").select("id").eq("user_id",l.id).single();if(U){const{data:G,error:T}=await x.from("orders").select("*, customer:profiles(full_name, email, phone)").eq("vendor_id",U.id).order("created_at",{ascending:!1});if(T)throw T;C(G||[])}}catch(l){console.error("Error fetching orders:",l),D({type:"error",text:l.message})}finally{j(!1)}},n=async(l,U)=>{I(!0);try{const{error:G}=await x.from("orders").update({status:U}).eq("id",l);if(G)throw G;C(T=>T.map(V=>V.id===l?{...V,status:U}:V)),(p==null?void 0:p.id)===l&&N(T=>T?{...T,status:U}:null),D({type:"success",text:`Order status updated to ${U}`})}catch(G){D({type:"error",text:G.message})}finally{I(!1)}},f=r.filter(l=>{var T;const U=l.order_number.toLowerCase().includes(L.toLowerCase())||(((T=l.customer)==null?void 0:T.full_name)||"").toLowerCase().includes(L.toLowerCase()),G=O==="all"||l.status===O;return U&&G}),v=l=>{switch(l){case"pending":return"bg-amber-50 text-amber-700 border-amber-100";case"processing":return"bg-blue-50 text-blue-700 border-blue-100";case"shipped":return"bg-indigo-50 text-indigo-700 border-indigo-100";case"delivered":return"bg-emerald-50 text-emerald-700 border-emerald-100";case"cancelled":return"bg-red-50 text-red-700 border-red-100";default:return"bg-gray-50 text-gray-700 border-gray-100"}},d=l=>{switch(l){case"pending":return e.jsx(ht,{className:"w-3 h-3"});case"processing":return e.jsx(ae,{className:"w-3 h-3"});case"shipped":return e.jsx(Wt,{className:"w-3 h-3"});case"delivered":return e.jsx(re,{className:"w-3 h-3"});case"cancelled":return e.jsx(ie,{className:"w-3 h-3"});default:return e.jsx(ue,{className:"w-3 h-3"})}};return P?e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"}),e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Fetching your orders..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Order Management"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Manage and track all customer orders directed to your shop."})]}),e.jsxs("button",{onClick:g,className:"flex items-center gap-2 bg-white hover:bg-gray-50 text-gray-700 px-4 py-2 rounded-xl text-sm font-bold border border-gray-200 transition-all active:scale-95",children:[e.jsx(Qe,{className:"w-4 h-4"}),"Refresh List"]})]}),e.jsx("div",{className:"bg-white border border-gray-100 rounded-2xl p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(xe,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by Order ID or Customer Name...",value:L,onChange:l=>u(l.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 border border-transparent rounded-xl text-sm focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition-all"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(gt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400"}),e.jsxs("select",{value:O,onChange:l=>S(l.target.value),className:"pl-8 pr-10 py-2.5 bg-gray-50 border border-transparent rounded-xl text-sm font-medium focus:bg-white focus:border-emerald-500 outline-none transition-all appearance-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"shipped",children:"Shipped"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsx(qe,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-gray-400 pointer-events-none"})]})})]})}),y&&e.jsxs("div",{className:`p-4 rounded-xl flex items-center justify-between animate-in fade-in slide-in-from-top-2 ${y.type==="success"?"bg-green-50 text-green-700 border border-green-100":"bg-red-50 text-red-700 border border-red-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[y.type==="success"?e.jsx(re,{className:"w-5 h-5"}):e.jsx(ie,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:y.text})]}),e.jsx("button",{onClick:()=>D(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(ie,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm overflow-hidden text-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50/50 border-b border-gray-100",children:[e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Order Details"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Customer"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Total Amount"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:f.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-20 text-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center",children:e.jsx(we,{className:"w-8 h-8 text-gray-200"})}),e.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"No orders found matching your criteria"})]})})}):f.map(l=>{var U,G,T,V;return e.jsxs("tr",{className:"hover:bg-gray-50/30 group transition-all",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-black text-gray-900 group-hover:text-emerald-600 transition-colors uppercase tabular-nums",children:["#",l.order_number]}),e.jsxs("span",{className:"text-[10px] text-gray-400 font-bold mt-0.5",children:[new Date(l.created_at).toLocaleDateString()," at ",new Date(l.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-gray-400 font-bold text-xs uppercase",children:((G=(U=l.customer)==null?void 0:U.full_name)==null?void 0:G.charAt(0))||"U"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-gray-900 uppercase text-[11px] tracking-tight",children:((T=l.customer)==null?void 0:T.full_name)||"Anonymous"}),e.jsx("span",{className:"text-[10px] text-gray-400",children:(V=l.customer)==null?void 0:V.email})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-black text-gray-900",children:["$",l.total.toFixed(2)]}),e.jsx("span",{className:"text-[10px] text-emerald-600 font-bold uppercase tracking-widest",children:l.payment_status})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full border text-[10px] font-black uppercase tracking-widest ${v(l.status)}`,children:[d(l.status),l.status]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>N(l),className:"p-2 text-gray-400 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-all",title:"View Details",children:e.jsx(Ae,{className:"w-4 h-4"})})})]},l.id)})})]})})}),p&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white w-full max-w-4xl rounded-3xl shadow-2xl overflow-hidden animate-in fade-in zoom-in duration-200 flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 border-b border-gray-50 flex items-center justify-between bg-gray-50/50 shrink-0",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xs font-black text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full uppercase tracking-widest",children:"ORDER DETAIL"}),e.jsxs("h3",{className:"text-lg font-black text-gray-900 tabular-nums",children:["#",p.order_number]})]}),e.jsxs("p",{className:"text-[10px] text-gray-400 font-bold mt-1 uppercase tracking-wider",children:["Placed on ",new Date(p.created_at).toLocaleString()]})]}),e.jsx("button",{onClick:()=>N(null),className:"p-2 hover:bg-gray-100 rounded-xl transition-all",children:e.jsx(ie,{className:"w-6 h-6 text-gray-300"})})]}),e.jsxs("div",{className:"p-8 overflow-y-auto space-y-8",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-8 text-sm font-medium",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600",children:[e.jsx(xt,{className:"w-4 h-4"}),e.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest",children:"Customer Information"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 border border-gray-100 space-y-3",children:[e.jsx("p",{className:"font-black text-gray-900 uppercase",children:(c=p.customer)==null?void 0:c.full_name}),e.jsx("p",{className:"text-gray-500 font-bold text-xs",children:(_=p.customer)==null?void 0:_.email}),e.jsx("p",{className:"text-gray-500 font-bold text-xs",children:(s=p.customer)==null?void 0:s.phone})]})]}),e.jsxs("div",{className:"space-y-4 text-sm font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600",children:[e.jsx(Rt,{className:"w-4 h-4"}),e.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest",children:"Shipping Address"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 border border-gray-100 min-h-[100px] text-xs font-bold text-gray-600 space-y-1",children:[e.jsx("p",{className:"text-gray-900 font-black",children:(o=p.shipping_address)==null?void 0:o.full_name}),e.jsx("p",{children:(b=p.shipping_address)==null?void 0:b.address_line1}),e.jsxs("p",{children:[(q=p.shipping_address)==null?void 0:q.city,", ",(R=p.shipping_address)==null?void 0:R.state]}),e.jsxs("p",{children:[(E=p.shipping_address)==null?void 0:E.country,", ",(B=p.shipping_address)==null?void 0:B.zip_code]})]})]}),e.jsxs("div",{className:"space-y-4 text-sm font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest",children:"Payment & Status"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4 border border-gray-100 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] text-gray-400 font-black uppercase tracking-widest",children:"Method:"}),e.jsx("span",{className:"font-black text-gray-900 uppercase text-[11px]",children:p.payment_method||"Direct Payment"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] text-gray-400 font-black uppercase tracking-widest",children:"Status:"}),e.jsx("span",{className:"font-black text-emerald-600 uppercase text-[11px]",children:p.payment_status})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[10px] text-gray-400 font-black uppercase tracking-widest",children:"Order:"}),e.jsx("div",{className:`px-2 py-0.5 rounded-full border text-[9px] font-black uppercase tracking-widest ${v(p.status)}`,children:p.status})]})]})]})]}),e.jsxs("div",{className:"space-y-4 text-sm font-medium",children:[e.jsxs("div",{className:"flex items-center gap-2 text-emerald-600",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest",children:"Order Items"})]}),e.jsx("div",{className:"border border-gray-100 rounded-2xl overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{className:"text-left",children:[e.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Product"}),e.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Qty"}),e.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-gray-400 uppercase tracking-widest text-right",children:"Total"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50 font-bold",children:p.items.map((l,U)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg overflow-hidden shrink-0",children:l.image?e.jsx("img",{src:l.image,alt:l.name,className:"w-full h-full object-cover"}):e.jsx(ae,{className:"w-5 h-5 text-gray-300 m-2.5"})}),e.jsx("span",{className:"text-xs text-gray-900 uppercase line-clamp-1",children:l.name})]})}),e.jsxs("td",{className:"px-6 py-4 text-gray-600",children:["$",l.price.toFixed(2)]}),e.jsxs("td",{className:"px-6 py-4 text-gray-600",children:["x",l.quantity]}),e.jsxs("td",{className:"px-6 py-4 text-right text-gray-900 font-black tabular-nums",children:["$",(l.price*l.quantity).toFixed(2)]})]},U))}),e.jsxs("tfoot",{className:"bg-gray-50/50",children:[e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"px-6 py-3 text-right text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Subtotal"}),e.jsxs("td",{className:"px-6 py-3 text-right font-black text-gray-900 tabular-nums",children:["$",((i=p.subtotal)==null?void 0:i.toFixed(2))||(p.total-p.shipping_fee).toFixed(2)]})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"px-6 py-3 text-right text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Shipping"}),e.jsxs("td",{className:"px-6 py-3 text-right font-black text-gray-900 tabular-nums",children:["$",((h=p.shipping_fee)==null?void 0:h.toFixed(2))||"0.00"]})]}),e.jsxs("tr",{className:"border-t border-gray-200",children:[e.jsx("td",{colSpan:3,className:"px-6 py-4 text-right text-xs font-black text-gray-900 uppercase tracking-widest",children:"Grand Total"}),e.jsxs("td",{className:"px-6 py-4 text-right text-xl font-black text-emerald-600 tabular-nums",children:["$",p.total.toFixed(2)]})]})]})]})})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-100 bg-gray-50/30 flex flex-col md:flex-row items-center justify-between gap-4 shrink-0 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Update Order Status:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["processing","shipped","delivered","cancelled"].map(l=>e.jsx("button",{onClick:()=>n(p.id,l),disabled:k||p.status===l,className:`px-3 py-1.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all ${p.status===l?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-white border border-gray-200 text-gray-700 hover:border-emerald-600 hover:text-emerald-600 shadow-sm"}`,children:l},l))})]}),e.jsx("button",{onClick:()=>N(null),className:"bg-gray-900 text-white px-8 py-3 rounded-2xl text-[10px] font-black uppercase tracking-widest hover:bg-black transition-all shadow-lg shadow-gray-200 active:scale-95",children:"Close Detail"})]})]})})]})}function ls(){var v;const r=ct(),[C,P]=a.useState([]),[j,L]=a.useState(null),[u,O]=a.useState(!0),[S,p]=a.useState(null),[N,k]=a.useState(null),[I,y]=a.useState(null);a.useEffect(()=>{D()},[]);const D=async()=>{O(!0);try{const{data:d,error:c}=await x.from("vendor_packages").select("*").eq("is_active",!0).order("sort_order",{ascending:!0});if(c)throw c;P(d||[]);const{data:{user:_}}=await x.auth.getUser();if(!_)return;const{data:s}=await x.from("vendor_profiles").select("id").eq("user_id",_.id).single();if(s){k(_.id);const{data:o}=await x.from("vendor_subscriptions").select("package_id").eq("vendor_id",_.id).maybeSingle();o&&L(o.package_id)}}catch(d){console.error("Error fetching data:",d)}finally{O(!1)}},g=d=>{const c=d.toLowerCase();return c.includes("starter")?"emerald":c.includes("pro")?"blue":c.includes("elite")?"purple":"gray"},n=d=>{const c=[];return d.product_limit>=999999?c.push("Unlimited Products"):c.push(`Up to ${d.product_limit} Products`),d.has_priority_support?c.push("24/7 Dedicated Support"):c.push("Standard Support"),d.has_analytics_access&&c.push("Advanced Analytics"),d.has_ads_access&&c.push("Ads Access"),d.has_pos_access&&c.push("POS Access"),d.has_wallet_management&&c.push("Wallet Management"),d.has_withdraw_management&&c.push("Fast Withdrawals"),d.has_promotion_access&&c.push("Product Promotions"),c},f=async d=>{if(d===j)return;const c=C.find(_=>_.id===d);if(c){if(c.price_monthly>0){r(`/vendor/payment?packageId=${d}&plan=${c.name}`);return}p(d);try{const{error:_}=await x.from("vendor_subscriptions").upsert({vendor_id:N,package_id:d,status:"active",billing_cycle:"monthly"},{onConflict:"vendor_id"});if(_)throw _;L(d),y({type:"success",text:`Successfully switched to ${c.name}.`})}catch(_){y({type:"error",text:_.message})}finally{p(null)}}};return u?e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 gap-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"}),e.jsx("p",{className:"text-gray-500 text-sm font-medium",children:"Syncing packages..."})]}):e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900 uppercase tracking-tight",children:"Vendor Packages"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the plan that best fits your business growth."})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-emerald-50 px-4 py-2 rounded-xl text-emerald-700 text-[10px] font-black uppercase tracking-widest border border-emerald-100",children:[e.jsx(ut,{className:"w-3 h-3"}),((v=C.find(d=>d.id===j))==null?void 0:v.price_monthly)===0?e.jsx("span",{children:"Lifetime Access"}):e.jsxs("span",{children:["Next Billing: ",new Date(new Date().setMonth(new Date().getMonth()+1)).toLocaleDateString()]})]})]}),I&&e.jsxs("div",{className:`p-4 rounded-2xl flex items-center justify-between ${I.type==="success"?"bg-green-50 text-green-700 border border-green-100":"bg-red-50 text-red-700 border border-red-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(We,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-bold",children:I.text})]}),e.jsx("button",{onClick:()=>y(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(ie,{})})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:C.map(d=>{const c=j===d.id,_=g(d.name),s=n(d);return e.jsxs("div",{className:`relative bg-white rounded-[32px] border transition-all duration-500 overflow-hidden flex flex-col p-8 ${c?"border-emerald-500 ring-4 ring-emerald-500/10 shadow-xl":"border-gray-100 hover:border-emerald-200 hover:shadow-2xl hover:shadow-gray-200/50"}`,children:[d.sort_order===2&&e.jsx("div",{className:"absolute top-0 right-0 bg-emerald-600 text-white px-6 py-2 rounded-bl-3xl text-[10px] font-black uppercase tracking-widest",children:"Best Value"}),c&&e.jsx("div",{className:"mb-6 flex",children:e.jsx("span",{className:"bg-emerald-50 text-emerald-600 px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest border border-emerald-100",children:"Current active plan"})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mb-1",children:d.name.split(" ")[0]}),e.jsx("h3",{className:"text-2xl font-black text-gray-900 tracking-tight",children:d.name}),e.jsxs("div",{className:"mt-4 flex items-baseline gap-1",children:[e.jsxs("span",{className:"text-4xl font-black text-gray-900 tabular-nums",children:["$",d.price_monthly]}),e.jsx("span",{className:"text-gray-400 text-sm font-bold uppercase tracking-widest",children:"/ Month"})]})]}),e.jsxs("div",{className:"space-y-4 mb-10 flex-1",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-300 uppercase tracking-widest",children:"What's included:"}),s.map((o,b)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center shrink-0 ${c?"bg-emerald-100 text-emerald-600":"bg-gray-50 text-gray-300"}`,children:e.jsx(We,{className:"w-3 h-3",strokeWidth:3})}),e.jsx("span",{className:"text-xs font-bold text-gray-600",children:o})]},b))]}),e.jsx("button",{disabled:c||S===d.id,onClick:()=>f(d.id),className:`w-full py-4 rounded-2xl text-[11px] font-black uppercase tracking-widest transition-all ${c?"bg-gray-50 text-gray-400 cursor-not-allowed border border-gray-100":_==="blue"?"bg-emerald-600 text-white hover:bg-emerald-700 shadow-lg shadow-emerald-200 active:scale-95":"bg-gray-900 text-white hover:bg-black shadow-lg shadow-gray-200 active:scale-95"}`,children:S===d.id?"Processing...":c?"Active Plan":"Select Plan"})]},d.id)})})]})}function ns(){const{profile:r}=de(),[C,P]=a.useState(!0),[j,L]=a.useState(!1),[u,O]=a.useState(null),[S,p]=a.useState("none"),[N,k]=a.useState(null),[I,y]=a.useState(!1),[D,g]=a.useState(!1),[n,f]=a.useState([]);a.useEffect(()=>{v()},[r]);const v=async()=>{var s;if(r!=null&&r.id)try{const{data:o}=await x.from("vendor_profiles").select("kyc_status, kyc_details").eq("user_id",r.id).maybeSingle();o&&(p(o.kyc_status||"none"),O(o.kyc_details),f(((s=o.kyc_details)==null?void 0:s.documents)||[]))}catch(o){console.error("Error fetching KYC:",o)}finally{P(!1)}},d=async s=>{var b;if(!s.target.files||!(r!=null&&r.id))return;const o=Array.from(s.target.files);y(!0),k(null);try{const{data:q}=await x.from("vendor_profiles").select("id").eq("user_id",r.id).single();if(!q)throw new Error("Vendor profile not found");const R=[];for(const E of o){const i=`kyc/${`${q.id}/${Date.now()}-${E.name.replace(/\s+/g,"_")}`}`,{error:h}=await x.storage.from("shop-assets").upload(i,E);if(h)throw console.error("Upload error:",h),h.statusCode==="404"||(b=h.message)!=null&&b.includes("not found")?new Error('Storage bucket "shop-assets" not found. Please create it in Supabase dashboard.'):h;const{data:{publicUrl:l}}=x.storage.from("shop-assets").getPublicUrl(i);R.push({name:E.name,url:l,path:i,type:E.type,size:E.size,submitted_at:new Date().toISOString()})}f(E=>[...E,...R]),k({type:"success",text:`${o.length} document(s) prepared successfully.`})}catch(q){console.error("File upload failed:",q),k({type:"error",text:`Upload failed: ${q.message}`})}finally{y(!1),s.target.value=""}},c=s=>{f(o=>o.filter((b,q)=>q!==s))},_=async s=>{var o;if(s.preventDefault(),L(!0),k(null),!!(r!=null&&r.id))try{const{data:b}=await x.from("vendor_profiles").select("id").eq("user_id",r.id).single();if(!b)throw new Error("Vendor profile not found");const q=new FormData(s.target),R={full_name:q.get("full_name"),id_number:q.get("id_number"),business_reg:q.get("business_reg"),tax_number:q.get("tax_number"),address:q.get("address"),submitted_at:new Date().toISOString(),documents:n,storage_path:(o=n[0])!=null&&o.path?n[0].path.split("/").slice(0,-1).join("/"):"kyc"},{error:E}=await x.from("vendor_profiles").update({kyc_status:"pending",kyc_details:R}).eq("user_id",r==null?void 0:r.id);if(E)throw E;const{data:B}=await x.from("profiles").select("id").eq("role","admin");if(B&&B.length>0){const i=(u==null?void 0:u.shop_name)||(r==null?void 0:r.full_name)||"A Vendor",h=B.map(l=>({user_id:l.id,type:"info",title:"New KYC Submission",message:`Shop "${i}" has submitted KYC documents for review.`,data:{vendor_id:b.id,type:"kyc_submission"},is_read:!1}));await x.from("notifications").insert(h)}p("pending"),O(R),f(n),g(!1),k({type:"success",text:"KYC documents submitted successfully for review."})}catch(b){k({type:"error",text:b.message})}finally{L(!1)}};return C?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"})}):e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4 pb-2 border-b border-gray-100",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900 uppercase tracking-tighter",children:"Business Verification"}),e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest",children:"Trust & Security • Identity Management • Compliance"})]}),e.jsxs("div",{className:`flex items-center gap-2 px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-[0.15em] border transition-all shadow-sm ${S==="approved"?"bg-emerald-50 text-emerald-700 border-emerald-100":S==="pending"?"bg-blue-50 text-blue-700 border-blue-100":S==="rejected"?"bg-red-50 text-red-700 border-red-100":"bg-gray-50 text-gray-500 border-gray-100"}`,children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full animate-pulse ${S==="approved"?"bg-emerald-500":S==="pending"?"bg-blue-500":S==="rejected"?"bg-red-500":"bg-gray-400"}`}),S==="none"?"Verification Required":S]})]}),N&&e.jsx("div",{className:`p-4 rounded-xl flex items-center justify-between animate-in zoom-in duration-300 ${N.type==="success"?"bg-emerald-50 text-emerald-800 border border-emerald-100":"bg-red-50 text-red-800 border border-red-100"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[N.type==="success"?e.jsx(re,{className:"w-5 h-5"}):e.jsx(oe,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-black uppercase tracking-tight",children:N.text})]})}),S==="approved"?e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-10 text-center space-y-6 shadow-sm",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto text-emerald-600 shadow-inner",children:e.jsx($e,{size:32})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-black text-gray-900 tracking-tight uppercase",children:"Identity Verified"}),e.jsx("p",{className:"text-gray-500 max-w-sm mx-auto font-bold text-sm",children:"Your business has cleared all compliance checks. You now have priority access to all gateway features."})]})]}):(S==="pending"||S==="rejected")&&!D?e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 p-10 text-center space-y-6 shadow-sm",children:[e.jsx("div",{className:`w-16 h-16 ${S==="pending"?"bg-blue-100 text-blue-600 animate-pulse":"bg-red-100 text-red-600"} rounded-2xl flex items-center justify-center mx-auto shadow-inner`,children:S==="pending"?e.jsx(ht,{size:32}):e.jsx(oe,{size:32})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xl font-black text-gray-900 tracking-tight uppercase",children:S==="pending"?"Review in Progress":"Verification Rejected"}),e.jsx("p",{className:"text-gray-500 max-w-sm mx-auto font-bold tracking-tight text-sm",children:S==="pending"?"Our compliance officers are verifying your documents. This typically takes 24 business hours.":(u==null?void 0:u.rejection_reason)||"Information provided was insufficient or invalid. Please update and resubmit."})]}),e.jsxs("div",{className:"pt-8 border-t border-gray-50 max-w-2xl mx-auto grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] mb-4 text-left",children:"Transmission Snapshot"}),e.jsx("div",{className:"space-y-2 text-left bg-gray-50 p-6 rounded-xl border border-gray-100",children:[{label:"Primary Contact",value:u==null?void 0:u.full_name},{label:"ID/Passport",value:u==null?void 0:u.id_number},{label:"Entity ID",value:u==null?void 0:u.business_reg},{label:"Tax ID (BP#)",value:u==null?void 0:u.tax_number}].map((s,o)=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest",children:s.label}),e.jsx("span",{className:"text-xs font-black text-gray-900",children:s.value||"N/A"})]},o))}),e.jsx("button",{onClick:()=>g(!0),className:"w-full py-3 bg-gray-900 text-white rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-black transition-all shadow-sm",children:"Edit KYC Details"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] mb-4 text-left",children:"Submitted Documents"}),e.jsx("div",{className:"space-y-2",children:n.length>0?n.map((s,o)=>e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 p-3 bg-white border border-gray-100 rounded-xl hover:border-blue-500 transition-colors group",children:[e.jsx("div",{className:"p-2 bg-blue-50 text-blue-600 rounded-lg group-hover:bg-blue-600 group-hover:text-white transition-colors",children:e.jsx(ue,{size:16})}),e.jsxs("div",{className:"flex-1 text-left min-w-0",children:[e.jsx("p",{className:"text-xs font-black text-gray-900 truncate uppercase tracking-tighter",children:s.name}),e.jsxs("p",{className:"text-[9px] text-gray-400 font-bold uppercase",children:[(s.size/1024).toFixed(1)," KB"]})]})]},o)):e.jsxs("div",{className:"p-10 border-2 border-dashed border-gray-100 rounded-2xl flex flex-col items-center justify-center text-gray-300",children:[e.jsx(ue,{size:32,className:"mb-2 opacity-20"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest",children:"No Documents Found"})]})})]})]})]}):e.jsxs("form",{onSubmit:_,className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm transition-all",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center gap-4 bg-gray-50/50",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center text-blue-600 border border-gray-100",children:e.jsx(ue,{size:24,strokeWidth:2.5})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-black text-gray-900 tracking-tighter uppercase",children:"Legal Disclosure"}),e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest mt-0.5",children:"Submit authentic documents to enable withdrawals."})]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] ml-1",children:"Representative Name"}),e.jsxs("div",{className:"relative group",children:[e.jsx(xt,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-300 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{name:"full_name",required:!0,defaultValue:u==null?void 0:u.full_name,placeholder:"Legal Representative Name",className:"w-full bg-gray-50 border-gray-200 border focus:border-blue-500 focus:bg-white rounded-xl py-2.5 pl-10 pr-4 text-sm font-bold transition-all outline-none placeholder:font-medium"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] ml-1",children:"Government ID Number"}),e.jsxs("div",{className:"relative group",children:[e.jsx($e,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-300 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{name:"id_number",required:!0,defaultValue:u==null?void 0:u.id_number,placeholder:"National ID / Passport #",className:"w-full bg-gray-50 border-gray-200 border focus:border-blue-500 focus:bg-white rounded-xl py-2.5 pl-10 pr-4 text-sm font-bold transition-all outline-none placeholder:font-medium"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] ml-1",children:"Business Registration"}),e.jsxs("div",{className:"relative group",children:[e.jsx(ye,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-300 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{name:"business_reg",required:!0,defaultValue:u==null?void 0:u.business_reg,placeholder:"Certificate Number",className:"w-full bg-gray-50 border-gray-200 border focus:border-blue-500 focus:bg-white rounded-xl py-2.5 pl-10 pr-4 text-sm font-bold transition-all outline-none placeholder:font-medium"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] ml-1",children:"Tax Identification (TIN)"}),e.jsxs("div",{className:"relative group",children:[e.jsx(ue,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-300 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{name:"tax_number",required:!0,defaultValue:u==null?void 0:u.tax_number,placeholder:"BP# / TIN#",className:"w-full bg-gray-50 border-gray-200 border focus:border-blue-500 focus:bg-white rounded-xl py-2.5 pl-10 pr-4 text-sm font-bold transition-all outline-none placeholder:font-medium"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] ml-1",children:"Physical Trading Address"}),e.jsx("textarea",{name:"address",required:!0,rows:2,defaultValue:u==null?void 0:u.address,placeholder:"Headquarters physical address...",className:"w-full bg-gray-50 border-gray-200 border focus:border-blue-500 focus:bg-white rounded-xl p-4 text-sm font-bold transition-all outline-none resize-none placeholder:font-medium"})]}),e.jsxs("div",{className:"bg-blue-50/50 rounded-2xl border border-blue-100/50 p-6 flex flex-col items-center text-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-xl shadow-sm flex items-center justify-center text-blue-600 border border-blue-50",children:e.jsx(Ne,{size:20})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"text-base font-black text-gray-900 uppercase tracking-tighter",children:"Document Transmission"}),e.jsx("p",{className:"text-xs text-gray-500 max-w-sm mx-auto font-bold uppercase tracking-tight",children:"Upload ID scan, Business Registration, and Tax certificate."})]}),e.jsx("input",{type:"file",className:"hidden",id:"kyc-files",multiple:!0,onChange:d,disabled:I,accept:".pdf,.zip,.jpg,.jpeg,.png"}),e.jsx("label",{htmlFor:"kyc-files",className:`cursor-pointer bg-white border border-gray-200 px-8 py-3 rounded-xl text-[10px] font-black uppercase tracking-[0.2em] hover:border-blue-500 hover:text-blue-600 transition-all shadow-sm text-gray-700 ${I?"opacity-50 cursor-not-allowed":""}`,children:I?"Uploading...":"Select Documents"}),n.length>0&&e.jsxs("div",{className:"w-full mt-4 space-y-2",children:[e.jsxs("h5",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest text-left mb-2",children:["Uploaded Assets (",n.length,")"]}),n.map((s,o)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-100 rounded-xl group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-50 text-blue-600 rounded-lg group-hover:bg-blue-600 group-hover:text-white transition-colors",children:e.jsx(ue,{size:16})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-700 uppercase truncate max-w-[200px]",children:s.name}),e.jsxs("p",{className:"text-[8px] font-bold text-gray-400 uppercase",children:[(s.size/1024).toFixed(1)," KB • ",s.path||"Managed"]})]})]}),e.jsx("button",{type:"button",onClick:()=>c(o),className:"p-1 hover:text-red-500 transition-colors",children:e.jsx(oe,{size:14})})]},o))]}),I&&e.jsxs("div",{className:"w-full mt-4 flex items-center justify-center py-4 bg-blue-50/30 rounded-xl border border-dashed border-blue-200",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-blue-600 border-t-transparent mr-2"}),e.jsx("span",{className:"text-[10px] font-black text-blue-600 uppercase tracking-widest",children:"Transmitting to Secure Storage..."})]})]})]}),e.jsxs("div",{className:"p-6 bg-white border-t border-gray-100 flex flex-col sm:flex-row justify-between items-center gap-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[D&&e.jsx("button",{type:"button",onClick:()=>g(!1),className:"px-6 py-4 border border-gray-200 rounded-xl text-[11px] font-black uppercase tracking-widest hover:bg-gray-50 transition-all",children:"Cancel Edit"}),e.jsxs("div",{className:"flex items-start gap-2 max-w-sm text-center sm:text-left",children:[e.jsx($e,{className:"w-4 h-4 text-gray-300 shrink-0 mt-0.5"}),e.jsx("p",{className:"text-[10px] font-bold text-gray-400 leading-relaxed uppercase tracking-widest",children:"Compliance Statement: I certify that the information provided is legally binding and accurate."})]})]}),e.jsx("button",{type:"submit",disabled:j||I||n.length===0,className:"w-full sm:w-auto bg-gray-900 text-white px-10 py-4 rounded-xl text-[11px] font-black uppercase tracking-[0.25em] hover:bg-black transition-all shadow-lg shadow-gray-200 flex items-center justify-center gap-3 active:scale-95 disabled:opacity-50",children:j?"Propagating Documents...":e.jsxs(e.Fragment,{children:[D?"Update & Re-Submit":"Verify Shop Identity",e.jsx(At,{size:16})]})})]})]})]})}function is(){const{profile:r}=de(),[C,P]=a.useState([]),[j,L]=a.useState(!0),[u,O]=a.useState(null),[S,p]=a.useState("all"),[N,k]=a.useState("");a.useEffect(()=>{I()},[r]);const I=async()=>{if(r!=null&&r.id)try{const{data:n}=await x.from("vendor_profiles").select("id").eq("user_id",r.id).single();if(!n)return;const{data:f,error:v}=await x.from("order_refunds").select(`
          *,
          orders (
            order_number
          ),
          profiles:customer_id (
            full_name,
            email
          )
        `).eq("vendor_id",n.id).order("created_at",{ascending:!1});if(v)throw v;P(f||[])}catch(n){console.error("Error fetching refunds:",n)}finally{L(!1)}},y=async(n,f)=>{O(n);try{const{error:v}=await x.from("order_refunds").update({status:f}).eq("id",n);if(v)throw v;P(d=>d.map(c=>c.id===n?{...c,status:f}:c))}catch(v){console.error("Error updating refund status:",v),alert("Failed to update refund status")}finally{O(null)}},D=C.filter(n=>{var d,c,_;const f=S==="all"||n.status===S,v=((d=n.orders)==null?void 0:d.order_number.toLowerCase().includes(N.toLowerCase()))||((c=n.profiles)==null?void 0:c.full_name.toLowerCase().includes(N.toLowerCase()))||((_=n.profiles)==null?void 0:_.email.toLowerCase().includes(N.toLowerCase()));return f&&v}),g=n=>{switch(n){case"approved":return"bg-emerald-50 text-emerald-700 border-emerald-100";case"processed":return"bg-emerald-50 text-emerald-700 border-emerald-100";case"rejected":return"bg-red-50 text-red-700 border-red-100";case"pending":return"bg-amber-50 text-amber-700 border-amber-100";default:return"bg-gray-50 text-gray-700 border-gray-100"}};return j?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"})}):e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900 uppercase tracking-tight",children:"Refund Management"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 uppercase tracking-wider",children:"Process and track customer refund requests."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search order or customer...",value:N,onChange:n=>k(n.target.value),className:"pl-9 pr-4 py-2 bg-white border border-gray-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none w-64"})]}),e.jsxs("select",{value:S,onChange:n=>p(n.target.value),className:"px-4 py-2 bg-white border border-gray-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending Review"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]})]}),e.jsx("div",{className:"bg-white rounded-3xl border border-gray-100 shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50/50 border-b border-gray-100",children:[e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Request Details"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Customer"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Reason"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Amount"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-[10px] font-black text-gray-400 uppercase tracking-widest text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:D.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-400",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-50 rounded-2xl flex items-center justify-center mb-3",children:e.jsx(pt,{className:"w-6 h-6"})}),e.jsx("p",{className:"text-sm font-bold",children:"No refund requests found"})]})})}):D.map(n=>{var f,v,d,c;return e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center text-gray-500 font-bold shrink-0",children:((f=n.orders)==null?void 0:f.order_number.slice(-4))||"####"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-black text-gray-900 uppercase tracking-wide",children:["#",(v=n.orders)==null?void 0:v.order_number]}),e.jsx("p",{className:"text-[10px] text-gray-400 font-bold mt-0.5",children:new Date(n.created_at).toLocaleDateString()})]})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-xs font-bold text-gray-900",children:((d=n.profiles)==null?void 0:d.full_name)||"Unknown"}),e.jsx("div",{className:"text-[10px] text-gray-400 font-medium",children:(c=n.profiles)==null?void 0:c.email})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-xs font-medium text-gray-600 max-w-xs",children:n.reason})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"text-sm font-black text-gray-900 tabular-nums",children:["$",n.amount.toFixed(2)]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-lg text-[10px] font-black uppercase tracking-widest border ${g(n.status)}`,children:n.status})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:n.status==="pending"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>y(n.id,"approved"),disabled:u===n.id,className:"p-2 bg-emerald-50 text-emerald-600 hover:bg-emerald-100 rounded-lg transition-colors disabled:opacity-50",title:"Approve Refund",children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>y(n.id,"rejected"),disabled:u===n.id,className:"p-2 bg-red-50 text-red-600 hover:bg-red-100 rounded-lg transition-colors disabled:opacity-50",title:"Reject Refund",children:e.jsx(ie,{className:"w-4 h-4"})})]}):e.jsx("div",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:n.status==="approved"?"Completed":"Review Closed"})})})]},n.id)})})]})})})]})}function ds({onTabChange:r}){const{profile:C}=de(),[P,j]=a.useState([]),[L,u]=a.useState(!0),[O,S]=a.useState(!1),[p,N]=a.useState(!1),[k,I]=a.useState(null),[y,D]=a.useState(null),[g,n]=a.useState({title:"",image_url:"",link_url:"",ad_type:"banner",start_date:"",end_date:""});a.useEffect(()=>{C&&f()},[C]);const f=async()=>{var s,o;try{const{data:b,error:q}=await x.from("vendor_profiles").select(`
          *,
          vendor_subscriptions (
            vendor_packages (has_ads_access)
          )
        `).eq("user_id",C==null?void 0:C.id).single();if(q)throw q;const R=((o=(s=b.vendor_subscriptions)==null?void 0:s.vendor_packages)==null?void 0:o.has_ads_access)||!1;S(R),R&&v(b.id)}catch(b){console.error("Error checking ads access:",b)}finally{u(!1)}},v=async s=>{const{data:o,error:b}=await x.from("vendor_ads").select("*").eq("vendor_id",s).order("created_at",{ascending:!1});!b&&o&&j(o)},d=async s=>{var o;s.preventDefault(),u(!0);try{const b=(o=(await x.from("vendor_profiles").select("id").eq("user_id",C==null?void 0:C.id).single()).data)==null?void 0:o.id;if(!b)throw new Error("Vendor not found");const q={vendor_id:b,title:g.title,image_url:g.image_url,link_url:g.link_url,ad_type:g.ad_type,start_date:g.start_date,end_date:g.end_date,status:"active"};if(k){const{error:R}=await x.from("vendor_ads").update(q).eq("id",k.id);if(R)throw R;D({type:"success",text:"Ad updated successfully"})}else{const{error:R}=await x.from("vendor_ads").insert(q);if(R)throw R;D({type:"success",text:"Ad created successfully"})}N(!1),v(b),_()}catch(b){D({type:"error",text:b.message})}finally{u(!1)}},c=async s=>{var o;if(confirm("Are you sure you want to delete this ad?"))try{const{error:b}=await x.from("vendor_ads").delete().eq("id",s);if(b)throw b;const q=(o=(await x.from("vendor_profiles").select("id").eq("user_id",C==null?void 0:C.id).single()).data)==null?void 0:o.id;q&&v(q),D({type:"success",text:"Ad deleted successfully"})}catch(b){D({type:"error",text:b.message})}},_=()=>{I(null),n({title:"",image_url:"",link_url:"",ad_type:"banner",start_date:"",end_date:""})};return L?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading ads module..."}):O?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900",children:"Ads Management"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage your promotional campaigns"})]}),e.jsxs("button",{onClick:()=>{_(),N(!0)},className:"bg-purple-600 text-white px-4 py-2 rounded-xl font-bold hover:bg-purple-700 transition flex items-center gap-2",children:[e.jsx(Re,{className:"w-4 h-4"}),"Create Campaign"]})]}),y&&e.jsxs("div",{className:`p-4 rounded-xl flex items-center gap-3 ${y.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:[y.type==="success"?e.jsx(We,{className:"w-5 h-5"}):e.jsx(oe,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:y.text})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:[P.map(s=>e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm hover:shadow-md transition overflow-hidden group",children:[e.jsxs("div",{className:"aspect-video bg-gray-100 relative",children:[e.jsx("img",{src:s.image_url,alt:s.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide border shadow-sm ${s.status==="active"?"bg-green-100 text-green-700 border-green-200":s.status==="pending"?"bg-amber-100 text-amber-700 border-amber-200":"bg-gray-100 text-gray-600 border-gray-200"}`,children:s.status})})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900 line-clamp-1",children:s.title}),e.jsx("p",{className:"text-xs text-gray-500 uppercase font-medium",children:s.ad_type})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>{I(s),n(s),N(!0)},className:"p-2 hover:bg-gray-50 rounded-lg text-gray-500 hover:text-blue-600 transition",children:e.jsx(ze,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>c(s.id),className:"p-2 hover:bg-gray-50 rounded-lg text-gray-500 hover:text-red-600 transition",children:e.jsx(Be,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs font-bold uppercase mb-1",children:[e.jsx(Ae,{className:"w-3 h-3"})," Views"]}),e.jsx("div",{className:"text-lg font-black text-gray-900",children:s.impressions.toLocaleString()})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs font-bold uppercase mb-1",children:[e.jsx(Vt,{className:"w-3 h-3"})," Clicks"]}),e.jsx("div",{className:"text-lg font-black text-gray-900",children:s.clicks.toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(Qe,{className:"w-3 h-3"}),e.jsxs("span",{children:[new Date(s.start_date).toLocaleDateString()," - ",new Date(s.end_date).toLocaleDateString()]})]})]})]},s.id)),P.length===0&&e.jsxs("div",{className:"col-span-full border-2 border-dashed border-gray-200 rounded-3xl p-12 text-center text-gray-400",children:[e.jsx(Te,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"No active campaigns"}),e.jsx("p",{className:"text-sm",children:"Start promoting your products today"})]})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl w-full max-w-lg p-8 shadow-2xl overflow-y-auto max-h-[90vh]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-2xl font-black text-gray-900",children:k?"Edit Campaign":"New Campaign"}),e.jsx("button",{onClick:()=>N(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(le,{className:"w-6 h-6 text-gray-500"})})]}),e.jsxs("form",{onSubmit:d,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Campaign Title"}),e.jsx("input",{required:!0,type:"text",value:g.title,onChange:s=>n({...g,title:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none",placeholder:"Summer Sale 2024"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Ad Type"}),e.jsxs("select",{value:g.ad_type,onChange:s=>n({...g,ad_type:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none",children:[e.jsx("option",{value:"banner",children:"Main Banner"}),e.jsx("option",{value:"sidebar",children:"Sidebar Ad"}),e.jsx("option",{value:"popup",children:"Popup Modal"}),e.jsx("option",{value:"featured",children:"Featured Spot"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Target URL"}),e.jsx("input",{type:"text",value:g.link_url,onChange:s=>n({...g,link_url:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none",placeholder:"https://..."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Image URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{required:!0,type:"text",value:g.image_url,onChange:s=>n({...g,image_url:s.target.value}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none",placeholder:"https://..."}),e.jsx("button",{type:"button",className:"px-4 bg-gray-100 rounded-xl font-bold text-gray-600 hover:bg-gray-200",children:e.jsx(Ve,{className:"w-5 h-5"})})]}),g.image_url&&e.jsx("img",{src:g.image_url,alt:"Preview",className:"mt-2 h-32 w-full object-cover rounded-xl border border-gray-200"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Start Date"}),e.jsx("input",{required:!0,type:"datetime-local",value:g.start_date?new Date(g.start_date).toISOString().slice(0,16):"",onChange:s=>n({...g,start_date:new Date(s.target.value).toISOString()}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"End Date"}),e.jsx("input",{required:!0,type:"datetime-local",value:g.end_date?new Date(g.end_date).toISOString().slice(0,16):"",onChange:s=>n({...g,end_date:new Date(s.target.value).toISOString()}),className:"w-full px-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-purple-500 outline-none"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",disabled:L,className:"w-full bg-purple-600 text-white font-bold py-4 rounded-xl hover:bg-purple-700 transition shadow-lg shadow-purple-200 active:scale-95 disabled:opacity-50",children:L?"Saving...":"Save Campaign"})})]})]})})]}):e.jsx("div",{className:"max-w-2xl mx-auto text-center py-12 px-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-purple-100 to-indigo-50 p-8 rounded-3xl border border-purple-100 shadow-xl",children:[e.jsx("div",{className:"w-20 h-20 bg-white rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-sm",children:e.jsx(Te,{className:"w-10 h-10 text-purple-600"})}),e.jsx("h2",{className:"text-3xl font-black text-gray-900 mb-4",children:"Boost Your Sales with Ads!"}),e.jsxs("p",{className:"text-gray-600 mb-8 text-lg leading-relaxed",children:["Unlock the power of targeted advertising. Create banners, popups, and featured listings to reach more customers. This feature is exclusively available for ",e.jsx("span",{className:"font-bold text-purple-600",children:"Premium & Gold"})," partners."]}),e.jsx("button",{onClick:()=>r==null?void 0:r("packages"),className:"bg-purple-600 text-white px-8 py-4 rounded-xl font-bold hover:bg-purple-700 transition shadow-lg shadow-purple-200 active:scale-95",children:"Upgrade My Package"})]})})}const it=["#8B5CF6","#10B981","#F59E0B","#EF4444","#3B82F6"];function Pe({title:r,value:C,trend:P,icon:j,color:L}){return e.jsxs("div",{className:"bg-white p-5 rounded-[2rem] border border-gray-100 shadow-sm hover:translate-y-[-2px] transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:`p-2.5 rounded-xl ${L}`,children:j}),P!==void 0&&e.jsxs("div",{className:`flex items-center gap-0.5 text-[9px] font-black ${P>=0?"text-green-600":"text-red-600"} uppercase tracking-widest`,children:[P>=0?e.jsx(Oe,{className:"w-3 h-3"}):e.jsx(zt,{className:"w-3 h-3"}),Math.abs(P),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-gray-400 uppercase tracking-[0.2em] mb-1",children:r}),e.jsx("h3",{className:"text-xl font-black text-gray-900 tracking-tight",children:C})]})]})}function cs(){const{profile:r}=de(),[C,P]=a.useState(!0),[j,L]=a.useState("USD"),[u,O]=a.useState("30days"),[S,p]=a.useState(""),[N,k]=a.useState(""),[I,y]=a.useState({totalRevenue:0,totalOrders:0,avgOrderValue:0,growth:12.5}),[D,g]=a.useState([]),[n,f]=a.useState([]);a.useEffect(()=>{r&&v()},[r,j,u,S,N]);const v=async()=>{P(!0);try{const d=(await x.from("vendor_profiles").select("id").eq("user_id",r==null?void 0:r.id).single()).data;if(!d)return;let c,_=new Date().toISOString();if(u==="custom"&&S&&N)c=new Date(S).toISOString(),_=new Date(new Date(N).setHours(23,59,59)).toISOString();else{let i=new Date;u==="7days"?i.setDate(i.getDate()-7):u==="30days"?i.setDate(i.getDate()-30):u==="90days"&&i.setDate(i.getDate()-90),c=i.toISOString()}const{data:s,error:o}=await x.from("orders").select("total, currency_code, created_at, items").eq("vendor_id",d.id).eq("currency_code",j).gte("created_at",c).lte("created_at",_).order("created_at",{ascending:!0});if(o)throw o;const b=s,q=b.reduce((i,h)=>i+Number(h.total),0);y({totalRevenue:q,totalOrders:b.length,avgOrderValue:b.length>0?q/b.length:0,growth:12.5});const R={};b.forEach(i=>{const h=new Date(i.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"});R[h]=(R[h]||0)+Number(i.total)}),g(Object.entries(R).map(([i,h])=>({date:i,total:h})));const E={};b.forEach(i=>{i.items.forEach(h=>{const l=h.id||h.product_id;E[l]||(E[l]={name:h.name,count:0,revenue:0}),E[l].count+=h.quantity||1,E[l].revenue+=(h.price||0)*(h.quantity||1)})});const B=Object.values(E).sort((i,h)=>h.count-i.count).slice(0,5);f(B)}catch(d){console.error("Error fetching reports:",d)}finally{P(!1)}};return C?e.jsx("div",{className:"flex items-center justify-center h-[60vh]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-purple-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 font-black uppercase tracking-widest text-[10px]",children:"Processing Intelligence..."})]})}):e.jsxs("div",{className:"space-y-10 animate-in fade-in duration-700",children:[e.jsxs("div",{className:"flex flex-col xl:flex-row xl:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900 tracking-tighter uppercase",children:"Intelligence Center"}),e.jsx("p",{className:"text-gray-500 font-bold uppercase tracking-widest text-[9px]",children:"Advanced revenue & behavior analytics"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"bg-white p-1 rounded-xl border border-gray-100 flex gap-1 shadow-sm",children:["USD","ZWL","ZAR"].map(d=>e.jsx("button",{onClick:()=>L(d),className:`px-3 py-1.5 rounded-lg text-[10px] font-black transition-all ${j===d?"bg-purple-600 text-white":"text-gray-400 hover:bg-gray-50"}`,children:d},d))}),e.jsxs("select",{value:u,onChange:d=>O(d.target.value),className:"bg-white px-3 py-2 rounded-xl border border-gray-100 shadow-sm text-[10px] font-black uppercase tracking-widest outline-none focus:ring-1 focus:ring-purple-500",children:[e.jsx("option",{value:"7days",children:"7 Days"}),e.jsx("option",{value:"30days",children:"30 Days"}),e.jsx("option",{value:"90days",children:"90 Days"}),e.jsx("option",{value:"custom",children:"Custom Range"})]}),u==="custom"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:S,onChange:d=>p(d.target.value),className:"bg-white px-3 py-2 rounded-xl border border-gray-100 text-[10px] font-bold outline-none ring-purple-500/20 focus:ring-2"}),e.jsx("span",{className:"text-gray-400 font-black text-[10px]",children:"TO"}),e.jsx("input",{type:"date",value:N,onChange:d=>k(d.target.value),className:"bg-white px-3 py-2 rounded-xl border border-gray-100 text-[10px] font-bold outline-none ring-purple-500/20 focus:ring-2"})]}),e.jsx("button",{className:"p-2.5 bg-gray-900 text-white rounded-xl hover:bg-black transition-all active:scale-95 shadow-sm",children:e.jsx(lt,{className:"w-3.5 h-3.5"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(Pe,{title:"Gross Revenue",value:`${j==="USD"?"$":j} ${I.totalRevenue.toLocaleString()}`,trend:15.2,icon:e.jsx(pe,{className:"w-4 h-4 text-purple-600"}),color:"bg-purple-50"}),e.jsx(Pe,{title:"Volume",value:I.totalOrders.toString(),trend:4.1,icon:e.jsx(we,{className:"w-4 h-4 text-blue-600"}),color:"bg-blue-50"}),e.jsx(Pe,{title:"AOV",value:`${j==="USD"?"$":j} ${I.avgOrderValue.toFixed(1)}`,icon:e.jsx(Le,{className:"w-4 h-4 text-green-600"}),color:"bg-green-50"}),e.jsx(Pe,{title:"Growth",value:"+12.5%",icon:e.jsx(Qe,{className:"w-4 h-4 text-amber-600"}),color:"bg-amber-50"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-[2rem] border border-gray-100 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-black text-gray-900 uppercase tracking-tight",children:"Revenue Matrix"}),e.jsx("p",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest",children:"Growth performance trend"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-600 rounded-full"}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-gray-500",children:"Gross Sales"})]})]}),e.jsx("div",{className:"h-[280px] w-full",children:e.jsx(Ke,{width:"100%",height:"100%",children:e.jsxs(bt,{data:D,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorTotal",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#8B5CF6",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#8B5CF6",stopOpacity:0})]})}),e.jsx(ft,{strokeDasharray:"3 3",vertical:!1,stroke:"#F8FAFC"}),e.jsx(yt,{dataKey:"date",axisLine:!1,tickLine:!1,tick:{fontSize:9,fontWeight:900,fill:"#94A3B8"},dy:10}),e.jsx(jt,{axisLine:!1,tickLine:!1,tick:{fontSize:9,fontWeight:900,fill:"#94A3B8"},tickFormatter:d=>`${d>=1e3?(d/1e3).toFixed(1)+"k":d}`}),e.jsx(Ge,{contentStyle:{borderRadius:"0.75rem",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)",fontWeight:900,fontSize:"10px"}}),e.jsx(wt,{type:"monotone",dataKey:"total",stroke:"#8B5CF6",strokeWidth:3,fillOpacity:1,fill:"url(#colorTotal)"})]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-black text-gray-900 uppercase tracking-tight mb-6",children:"Top Assets"}),e.jsxs("div",{className:"space-y-4",children:[n.map((d,c)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-2xl hover:bg-gray-50 transition-colors group",children:[e.jsxs("div",{className:"w-9 h-9 rounded-xl bg-purple-600 text-white flex items-center justify-center font-black text-xs shadow-md shrink-0",children:["#",c+1]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-black text-[11px] text-gray-900 uppercase tracking-tight truncate group-hover:text-purple-600 transition-colors",children:d.name}),e.jsxs("p",{className:"text-[8px] font-bold text-gray-400 uppercase tracking-widest",children:[d.count," Sold"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-black text-[11px] text-gray-900",children:["$",d.revenue.toLocaleString()]})})]},c)),n.length===0&&e.jsxs("div",{className:"text-center py-10",children:[e.jsx(ae,{className:"w-8 h-8 text-gray-200 mx-auto mb-2"}),e.jsx("p",{className:"text-[9px] font-bold text-gray-300 uppercase",children:"No data"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-black text-gray-900 uppercase tracking-tight mb-6",children:"Revenue Mix"}),e.jsx("div",{className:"h-[200px]",children:e.jsx(Ke,{width:"100%",height:"100%",children:e.jsxs(Gt,{children:[e.jsx(Yt,{data:n,cx:"50%",cy:"50%",innerRadius:45,outerRadius:65,paddingAngle:5,dataKey:"revenue",nameKey:"name",children:n.map((d,c)=>e.jsx(Ht,{fill:it[c%it.length]},`cell-${c}`))}),e.jsx(Ge,{})]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-gray-100 shadow-sm flex flex-col justify-center text-center",children:[e.jsx("div",{className:"w-14 h-14 bg-purple-50 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(lt,{className:"w-6 h-6 text-purple-600"})}),e.jsx("h4",{className:"text-lg font-black text-gray-900 uppercase tracking-tight",children:"Export Intel"}),e.jsx("p",{className:"text-[10px] text-gray-500 font-bold uppercase tracking-widest px-8 mt-1",children:"Download raw transactional data for custom auditing."}),e.jsx("button",{className:"mt-6 mx-auto px-6 py-3 bg-purple-600 text-white rounded-xl font-black uppercase tracking-widest text-[10px] hover:bg-purple-700 transition shadow-md active:scale-95",children:"Download CSV Report"})]})]})]})}function os(){var _;const{profile:r}=de(),[C,P]=a.useState([]),[j,L]=a.useState(null),[u,O]=a.useState([]),[S,p]=a.useState(""),[N,k]=a.useState(!0),[I,y]=a.useState(!1),D=a.useRef(null);a.useEffect(()=>{r!=null&&r.id&&(f(),n())},[r==null?void 0:r.id]),a.useEffect(()=>{j&&(v(j.id),d(j.id))},[j]),a.useEffect(()=>{g()},[u]);const g=()=>{var s;(s=D.current)==null||s.scrollIntoView({behavior:"smooth"})},n=()=>{const s=x.channel("chat_changes").on("postgres_changes",{event:"*",schema:"public",table:"chat_messages"},o=>{j&&o.new&&o.new.conversation_id===j.id&&O(b=>[...b,o.new]),f()}).subscribe();return()=>{x.removeChannel(s)}},f=async()=>{try{const{data:s,error:o}=await x.from("chat_conversations").select(`
          *,
          chat_messages(count)
        `).contains("participant_ids",[r==null?void 0:r.id]).order("last_message_at",{ascending:!1});if(o)throw o;const b=await Promise.all((s||[]).map(async q=>{const R=q.participant_ids.find(i=>i!==(r==null?void 0:r.id)),{data:E}=await x.from("profiles").select("full_name, avatar_url").eq("id",R).single(),{count:B}=await x.from("chat_messages").select("*",{count:"exact",head:!0}).eq("conversation_id",q.id).eq("is_read",!1).neq("sender_id",r==null?void 0:r.id);return{...q,customer_name:(E==null?void 0:E.full_name)||"Anonymous Customer",customer_avatar:E==null?void 0:E.avatar_url,unread_count:B||0}}));P(b)}catch(s){console.error("Error fetching conversations:",s)}finally{k(!1)}},v=async s=>{try{const{data:o,error:b}=await x.from("chat_messages").select("*").eq("conversation_id",s).order("created_at",{ascending:!0});if(b)throw b;O(o||[])}catch(o){console.error("Error fetching messages:",o)}},d=async s=>{await x.from("chat_messages").update({is_read:!0}).eq("conversation_id",s).neq("sender_id",r==null?void 0:r.id),P(o=>o.map(b=>b.id===s?{...b,unread_count:0}:b))},c=async s=>{if(s.preventDefault(),!(!S.trim()||!j||!(r!=null&&r.id))){y(!0);try{const o={conversation_id:j.id,sender_id:r.id,message:S.trim()},{error:b}=await x.from("chat_messages").insert(o).select().single();if(b)throw b;await x.from("chat_conversations").update({last_message:S.trim(),last_message_at:new Date().toISOString()}).eq("id",j.id),p("")}catch(o){console.error("Error sending message:",o)}finally{y(!1)}}};return N?e.jsx("div",{className:"flex items-center justify-center p-20",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"})}):e.jsxs("div",{className:"bg-white rounded-[2.5rem] border border-gray-100 shadow-sm overflow-hidden flex h-[700px]",children:[e.jsxs("div",{className:"w-80 border-r border-gray-50 flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-50",children:[e.jsx("h3",{className:"text-sm font-black text-gray-900 uppercase tracking-widest mb-4",children:"Customer Messages"}),e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search conversations...",className:"w-full pl-10 pr-4 py-2 bg-gray-50 border-none rounded-xl text-xs focus:ring-2 focus:ring-emerald-500 outline-none"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:C.length===0?e.jsxs("div",{className:"p-10 text-center",children:[e.jsx(je,{className:"h-10 w-10 text-gray-200 mx-auto mb-4"}),e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"No conversations yet"})]}):e.jsx("div",{className:"divide-y divide-gray-50",children:C.map(s=>{var o;return e.jsxs("button",{onClick:()=>L(s),className:`w-full p-6 flex items-start gap-4 hover:bg-gray-50 transition-all text-left ${(j==null?void 0:j.id)===s.id?"bg-emerald-50/50 border-r-4 border-emerald-500":""}`,children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-2xl flex items-center justify-center shrink-0 uppercase font-black text-emerald-700 shadow-sm",children:(o=s.customer_name)==null?void 0:o[0]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"text-xs font-black text-gray-900 uppercase truncate",children:s.customer_name}),s.unread_count&&s.unread_count>0?e.jsx("span",{className:"w-5 h-5 bg-emerald-600 text-white text-[9px] font-black rounded-full flex items-center justify-center shadow-lg animate-bounce",children:s.unread_count}):e.jsx("span",{className:"text-[8px] font-black text-gray-400 uppercase tracking-tighter",children:new Date(s.last_message_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("p",{className:"text-[10px] font-bold text-gray-500 truncate italic",children:s.last_message})]})]},s.id)})})})]}),e.jsx("div",{className:"flex-1 flex flex-col bg-gray-50/30",children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-6 bg-white border-b border-gray-50 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-xl flex items-center justify-center uppercase font-black text-emerald-700",children:(_=j.customer_name)==null?void 0:_[0]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-black text-gray-900 uppercase",children:j.customer_name}),e.jsxs("p",{className:"text-[8px] font-black text-emerald-600 uppercase tracking-widest flex items-center gap-1.5",children:[e.jsx(Qt,{className:"w-1.5 h-1.5 fill-current"})," Active Now"]})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-8 space-y-4 custom-scrollbar",children:[u.map(s=>e.jsx("div",{className:`flex ${s.sender_id===(r==null?void 0:r.id)?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[70%] p-4 rounded-3xl text-sm ${s.sender_id===(r==null?void 0:r.id)?"bg-emerald-600 text-white shadow-xl shadow-emerald-200 rounded-tr-none":"bg-white text-gray-700 border border-gray-100 shadow-sm rounded-tl-none"}`,children:[e.jsx("p",{className:"font-bold leading-relaxed",children:s.message}),e.jsx("p",{className:`text-[8px] font-black uppercase tracking-widest mt-2 ${s.sender_id===(r==null?void 0:r.id)?"text-emerald-100":"text-gray-400"}`,children:new Date(s.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},s.id)),e.jsx("div",{ref:D})]}),e.jsx("div",{className:"p-6 bg-white border-t border-gray-50",children:e.jsxs("form",{onSubmit:c,className:"flex items-center gap-4",children:[e.jsx("input",{type:"text",value:S,onChange:s=>p(s.target.value),placeholder:"Type your message...",className:"flex-1 bg-gray-50 border-none rounded-2xl px-6 py-4 text-sm focus:ring-2 focus:ring-emerald-500 outline-none transition-all placeholder:font-bold"}),e.jsx("button",{type:"submit",disabled:I||!S.trim(),className:"p-4 bg-emerald-600 text-white rounded-2xl hover:bg-emerald-700 transition shadow-lg shadow-emerald-200 disabled:opacity-50 active:scale-95 group",children:e.jsx(Lt,{className:"h-5 w-5 transition-transform group-hover:translate-x-1 group-hover:-translate-y-1"})})]})})]}):e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-20 text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-white rounded-[2rem] flex items-center justify-center shadow-2xl shadow-emerald-900/10 mb-8",children:e.jsx(je,{className:"h-12 w-12 text-emerald-600"})}),e.jsx("h3",{className:"text-xl font-black text-gray-900 uppercase tracking-tight mb-2",children:"Select a Conversation"}),e.jsx("p",{className:"text-xs text-gray-500 font-bold max-w-xs uppercase tracking-widest leading-loose",children:"Choose a customer from the left to start chatting and managing inquiries."})]})})]})}function Hs(){var v,d;const{profile:r,signOut:C}=de(),[P,j]=ot(),L=P.get("tab")||"overview",[u,O]=a.useState(L),[S,p]=a.useState(!0);a.useEffect(()=>{const c=P.get("tab");c&&c!==u&&O(c)},[P]);const N=c=>{const[_,s]=c.split("?");O(_);const o={tab:_};s&&new URLSearchParams(s).forEach((q,R)=>{o[R]=q}),j(o)},[k,I]=a.useState({totalSales:0,totalOrders:0,totalProducts:0,pendingOrders:0,walletBalance:0,rating:0,lowStockItems:0,outOfStockItems:0,dailyRevenue:[],unreadMessages:0}),[y,D]=a.useState(null),[g,n]=a.useState([]),f=async()=>{var c,_;if(r!=null&&r.id){p(!0);try{const{data:s,error:o}=await x.from("vendor_profiles").select("*").eq("user_id",r.id).maybeSingle();if(o)throw o;if(s){D(s);const{data:b}=await x.from("vendor_subscriptions").select("*, vendor_packages(*)").eq("vendor_id",r.id).maybeSingle(),[q,R,E]=await Promise.all([x.from("orders").select("*").eq("vendor_id",s.id).order("created_at",{ascending:!1}),x.from("products").select("*").eq("vendor_id",s.id),x.from("wallets").select("balance").eq("user_id",r.id).maybeSingle()]),B=q.data||[],i=R.data||[];b!=null&&b.vendor_packages&&D(m=>m?{...m,vendor_packages:b.vendor_packages}:null);const h=B.filter(m=>m.status!=="cancelled").reduce((m,A)=>m+Number(A.total),0),l=B.filter(m=>["pending","processing"].includes(m.status)).length,U=i.filter(m=>m.stock_quantity>0&&m.stock_quantity<=10).length,G=i.filter(m=>m.stock_quantity===0).length,T=new Date;T.setDate(T.getDate()-30);const V={};B.filter(m=>new Date(m.created_at)>=T).forEach(m=>{const A=new Date(m.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric"});V[A]=(V[A]||0)+Number(m.total)}),I({totalSales:h,totalOrders:B.length,totalProducts:i.length,pendingOrders:l,walletBalance:((c=E.data)==null?void 0:c.balance)||0,rating:s.rating||0,lowStockItems:U,outOfStockItems:G,dailyRevenue:Object.entries(V).map(([m,A])=>({date:m,total:A})),unreadMessages:(await x.from("chat_messages").select("*",{count:"exact",head:!0}).eq("is_read",!1).neq("sender_id",r.id).in("conversation_id",((_=(await x.from("chat_conversations").select("id").contains("participant_ids",[r.id])).data)==null?void 0:_.map(m=>m.id))||[])).count||0}),n(B.slice(0,5))}}catch(s){console.error("Error fetching vendor data",s)}finally{p(!1)}}};return a.useEffect(()=>{r!=null&&r.id&&f()},[r==null?void 0:r.id]),S?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"})}):y?e.jsx(ts,{activeTab:u,onTabChange:N,shopName:y==null?void 0:y.shop_name,hasPosAccess:((v=y==null?void 0:y.vendor_packages)==null?void 0:v.has_pos_access)||Array.isArray(y==null?void 0:y.vendor_packages)&&((d=y.vendor_packages[0])==null?void 0:d.has_pos_access),children:e.jsxs("div",{className:"max-w-6xl mx-auto pb-10",children:[u==="overview"&&e.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900 uppercase tracking-tight",children:"Dashboard Overview"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Snapshot of your shop's performance and inventory health."})]}),(y==null?void 0:y.kyc_status)!=="approved"&&(y==null?void 0:y.kyc_status)!=="pending"&&e.jsxs("div",{className:"flex-1 max-w-xl bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-900/30 rounded-2xl p-4 flex items-center justify-between gap-4 animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3 text-blue-800 dark:text-blue-400",children:[e.jsx($e,{size:20,className:"shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-black uppercase tracking-wider",children:"KYC Verification Required"}),e.jsx("p",{className:"text-[10px] font-bold opacity-80",children:"Submit your documents to unlock full platform trust and faster payouts."})]})]}),e.jsx("button",{onClick:()=>N("kyc"),className:"whitespace-nowrap bg-blue-800 text-white text-[9px] font-black uppercase tracking-widest px-4 py-2 rounded-lg hover:bg-blue-900 transition-colors",children:"Submit Now"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:f,className:"p-2.5 bg-white border border-gray-100 rounded-xl text-gray-400 hover:text-emerald-600 hover:border-emerald-100 transition-all shadow-sm",children:e.jsx(ae,{className:"w-5 h-5"})}),e.jsxs("button",{onClick:()=>N("products?add=true"),className:"flex items-center gap-2 bg-emerald-600 text-white px-5 py-2.5 rounded-xl text-xs font-black uppercase tracking-widest hover:bg-emerald-700 transition shadow-lg shadow-emerald-200 active:scale-95",children:[e.jsx(Re,{className:"w-4 h-4"}),"Add Product"]})]})]}),(k.lowStockItems>0||k.outOfStockItems>0||k.pendingOrders>0||k.unreadMessages>0)&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[k.unreadMessages>0&&e.jsxs("div",{className:"bg-rose-50 border border-rose-100 p-4 rounded-2xl flex items-center gap-4 animate-pulse",children:[e.jsx("div",{className:"w-10 h-10 bg-rose-100 rounded-xl flex items-center justify-center shrink-0",children:e.jsx(je,{className:"w-5 h-5 text-rose-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] font-black text-rose-400 uppercase tracking-widest leading-none mb-1",children:"Unaddressed Inbox"}),e.jsxs("p",{className:"text-xs font-bold text-rose-900",children:[k.unreadMessages," Unread messages"]})]}),e.jsx("button",{onClick:()=>N("messages"),className:"text-[10px] font-black text-rose-600 uppercase tracking-widest hover:underline whitespace-nowrap",children:"Reply"})]}),k.pendingOrders>0&&e.jsxs("div",{className:"bg-blue-50 border border-blue-100 p-4 rounded-2xl flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center shrink-0",children:e.jsx(we,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] font-black text-blue-400 uppercase tracking-widest leading-none mb-1",children:"Attention Required"}),e.jsxs("p",{className:"text-xs font-bold text-blue-900",children:[k.pendingOrders," Orders need processing"]})]}),e.jsx("button",{onClick:()=>N("orders"),className:"text-[10px] font-black text-blue-600 uppercase tracking-widest hover:underline whitespace-nowrap",children:"View"})]}),k.lowStockItems>0&&e.jsxs("div",{className:"bg-amber-50 border border-amber-100 p-4 rounded-2xl flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-xl flex items-center justify-center shrink-0",children:e.jsx(oe,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] font-black text-amber-400 uppercase tracking-widest leading-none mb-1",children:"Stock Warning"}),e.jsxs("p",{className:"text-xs font-bold text-amber-900",children:[k.lowStockItems," Items running low"]})]}),e.jsx("button",{onClick:()=>N("products"),className:"text-[10px] font-black text-amber-600 uppercase tracking-widest hover:underline whitespace-nowrap",children:"Restock"})]}),k.outOfStockItems>0&&e.jsxs("div",{className:"bg-red-50 border border-red-100 p-4 rounded-2xl flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-xl flex items-center justify-center shrink-0",children:e.jsx(Ye,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[10px] font-black text-red-400 uppercase tracking-widest leading-none mb-1",children:"Critical Alert"}),e.jsxs("p",{className:"text-xs font-bold text-red-900",children:[k.outOfStockItems," Products out of stock"]})]}),e.jsx("button",{onClick:()=>N("products"),className:"text-[10px] font-black text-red-600 uppercase tracking-widest hover:underline whitespace-nowrap",children:"Check"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm relative overflow-hidden group hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-emerald-50 rounded-full -mr-12 -mt-12 group-hover:scale-150 transition-transform duration-700"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"bg-emerald-50 w-12 h-12 rounded-2xl flex items-center justify-center mb-6 shadow-sm border border-emerald-100",children:e.jsx(pe,{className:"w-6 h-6 text-emerald-600"})}),e.jsxs("div",{className:"text-3xl font-black text-gray-900 tracking-tight tabular-nums",children:["$",k.totalSales.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mt-2",children:"Gross Revenue"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm relative overflow-hidden group hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-blue-50 rounded-full -mr-12 -mt-12 group-hover:scale-150 transition-transform duration-700"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"bg-blue-50 w-12 h-12 rounded-2xl flex items-center justify-center mb-6 shadow-sm border border-blue-100",children:e.jsx(we,{className:"w-6 h-6 text-blue-600"})}),e.jsx("div",{className:"text-3xl font-black text-gray-900 tracking-tight tabular-nums",children:k.totalOrders}),e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mt-2",children:"Lifetime Orders"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm relative overflow-hidden group hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-purple-50 rounded-full -mr-12 -mt-12 group-hover:scale-150 transition-transform duration-700"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"bg-purple-50 w-12 h-12 rounded-2xl flex items-center justify-center mb-6 shadow-sm border border-purple-100",children:e.jsx(Ye,{className:"w-6 h-6 text-purple-600"})}),e.jsx("div",{className:"text-3xl font-black text-gray-900 tracking-tight tabular-nums",children:k.totalProducts}),e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mt-2",children:"Active Catalog"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-gray-100 shadow-sm relative overflow-hidden group hover:shadow-xl transition-all duration-300",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-amber-50 rounded-full -mr-12 -mt-12 group-hover:scale-150 transition-transform duration-700"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"bg-amber-50 w-12 h-12 rounded-2xl flex items-center justify-center mb-6 shadow-sm border border-amber-100",children:e.jsx(ge,{className:"w-6 h-6 text-amber-600"})}),e.jsxs("div",{className:"text-3xl font-black text-gray-900 tracking-tight tabular-nums",children:["$",k.walletBalance.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest mt-2",children:"Withdrawable Funds"})]})]})]}),e.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-gray-900 uppercase tracking-tight",children:"Financial Performance"}),e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"Revenue trend for the past 30 days"})]}),e.jsxs("button",{onClick:()=>N("reports"),className:"flex items-center gap-2 text-[10px] font-black text-emerald-600 uppercase tracking-widest hover:underline",children:["View Full Report ",e.jsx(Le,{className:"w-3 h-3"})]})]}),e.jsx("div",{className:"h-[300px] w-full",children:e.jsx(Ke,{width:"100%",height:"100%",children:e.jsxs(bt,{data:k.dailyRevenue,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"dashboardRevenue",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]})}),e.jsx(ft,{strokeDasharray:"3 3",vertical:!1,stroke:"#F1F5F9"}),e.jsx(yt,{dataKey:"date",axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:900,fill:"#94A3B8"},dy:10}),e.jsx(jt,{axisLine:!1,tickLine:!1,tick:{fontSize:10,fontWeight:900,fill:"#94A3B8"},tickFormatter:c=>`$${c}`}),e.jsx(Ge,{contentStyle:{borderRadius:"1rem",border:"none",boxShadow:"0 20px 25px -5px rgb(0 0 0 / 0.1)",fontWeight:900}}),e.jsx(wt,{type:"monotone",dataKey:"total",stroke:"#10B981",strokeWidth:4,fillOpacity:1,fill:"url(#dashboardRevenue)"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-3xl border border-gray-100 shadow-sm overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-50 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-1.5 h-6 bg-emerald-600 rounded-full"}),e.jsx("h3",{className:"font-black text-gray-900 text-sm uppercase tracking-tight",children:"Recent Orders"})]}),e.jsx("button",{onClick:()=>N("orders"),className:"text-[10px] font-black text-emerald-600 hover:text-emerald-700 uppercase tracking-widest",children:"See All Orders"})]}),e.jsx("div",{className:"overflow-x-auto flex-1",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50/30",children:[e.jsx("th",{className:"px-6 py-4 text-[9px] font-black text-gray-400 uppercase tracking-widest",children:"Order ID"}),e.jsx("th",{className:"px-6 py-4 text-[9px] font-black text-gray-400 uppercase tracking-widest",children:"Total"}),e.jsx("th",{className:"px-6 py-4 text-[9px] font-black text-gray-400 uppercase tracking-widest",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-[9px] font-black text-gray-400 uppercase tracking-widest text-right",children:"Activity"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:g.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-6 py-12 text-center text-[11px] font-bold text-gray-400 uppercase",children:"No recent transactions"})}):g.map(c=>e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors group",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"font-black text-gray-900 tabular-nums group-hover:text-emerald-600 transition-colors uppercase",children:["#",c.order_number]}),e.jsx("div",{className:"text-[9px] text-gray-400 font-bold uppercase mt-0.5",children:new Date(c.created_at).toLocaleDateString()})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"text-xs font-black text-gray-900 tabular-nums",children:["$",c.total]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-[9px] font-black uppercase tracking-widest bg-gray-100 text-gray-600 border border-gray-200",children:c.status})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("div",{className:"text-[9px] font-black text-emerald-600 uppercase tracking-widest bg-emerald-50 px-2 py-0.5 rounded-full inline-block",children:"Active"})})]},c.id))})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-3xl p-6 text-gray-900 shadow-xl shadow-gray-200 relative overflow-hidden border border-gray-100",children:[e.jsx("div",{className:"absolute top-0 right-0 p-2 opacity-5",children:e.jsx(ye,{className:"w-24 h-24"})}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h3",{className:"text-xl font-black uppercase tracking-tight mb-2",children:"Shop Profile"}),e.jsxs("p",{className:"text-xs text-gray-500 font-medium mb-6",children:["Your store's visibility: ",e.jsx("span",{className:"text-emerald-500 font-black",children:"HIGH"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-2xl border border-gray-200",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Support Rating"}),e.jsxs("span",{className:"text-sm font-black text-emerald-600",children:[k.rating.toFixed(1),"/5.0"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-2xl border border-gray-200",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Join Date"}),e.jsx("span",{className:"text-xs font-bold text-gray-900",children:new Date(y.created_at).toLocaleDateString(void 0,{month:"short",year:"numeric"})})]})]}),e.jsx("button",{onClick:()=>N("settings"),className:"w-full mt-6 bg-emerald-600 hover:bg-emerald-700 text-white font-black uppercase tracking-widest text-[10px] py-4 rounded-2xl transition-all shadow-lg shadow-emerald-200",children:"Edit Shop Profile"})]})]}),e.jsxs("div",{className:"bg-emerald-50 rounded-3xl p-6 border border-emerald-100",children:[e.jsx("h4",{className:"text-[10px] font-black text-emerald-600 uppercase tracking-widest mb-4",children:"Quick Tip"}),e.jsx("p",{className:"text-xs text-emerald-900 font-bold leading-relaxed italic",children:'"Updating your product stock regularly helps improve your visibility in customer search results."'})]})]})]})]}),u==="wallet"&&e.jsx(Jt,{}),u==="products"&&e.jsx(as,{}),u==="orders"&&e.jsx(rs,{}),u==="settings"&&e.jsx(ss,{}),u==="packages"&&e.jsx(ls,{}),u==="pos"&&e.jsx(Kt,{onTabChange:N}),u==="kyc"&&e.jsx(ns,{}),u==="refunds"&&e.jsx(is,{}),u==="ads"&&e.jsx(ds,{onTabChange:N}),u==="reports"&&e.jsx(cs,{}),u==="messages"&&e.jsx(os,{})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-slate-900 rounded-2xl shadow-xl p-8 text-center border border-gray-100 dark:border-slate-800",children:[e.jsx(ye,{className:"w-16 h-16 mx-auto text-emerald-600 mb-6"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Vendor Setup Required"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-8",children:"Your vendor profile is not fully set up. Please complete your registration to access the dashboard."}),e.jsx(He,{to:"/vendor/setup",className:"block w-full bg-emerald-600 text-white font-bold py-3 rounded-xl hover:bg-emerald-700 transition shadow-lg shadow-emerald-500/20 active:scale-95",children:"Complete Setup"}),e.jsx("button",{onClick:C,className:"mt-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-sm",children:"Sign Out"})]})})}export{Hs as VendorDashboard};
