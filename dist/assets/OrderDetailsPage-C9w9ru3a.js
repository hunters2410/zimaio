import{l as v,r as a,s as i,j as e,L as u,P as w,k as R,D as S}from"./index-DO0RgZ49.js";import{A as k}from"./arrow-left-B0D0mH8W.js";import{R as _}from"./rotate-ccw-CasWziMb.js";function C(){const{id:n}=v(),[t,g]=a.useState(null),[h,f]=a.useState(!0),[b,l]=a.useState(!1),[d,p]=a.useState(""),[c,o]=a.useState(0),[x,m]=a.useState(!1);a.useEffect(()=>{n&&y()},[n]);const y=async()=>{try{const{data:s,error:r}=await i.from("orders").select("*").eq("id",n).single();if(r)throw r;g(s),s&&o(s.total)}catch(s){console.error("Error fetching order:",s)}finally{f(!1)}},j=async()=>{var s;if(t){m(!0);try{const{error:r}=await i.from("order_refunds").insert({order_id:t.id,customer_id:(s=(await i.auth.getUser()).data.user)==null?void 0:s.id,vendor_id:t.vendor_id,reason:d,amount:c,status:"pending"});if(r)throw r;alert("Refund request submitted successfully"),l(!1)}catch(r){console.error("Error submitting refund:",r),alert("Failed to submit refund request: "+r.message)}finally{m(!1)}}};if(h)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-600"})});if(!t)return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Order Not Found"}),e.jsx(u,{to:"/dashboard",className:"text-cyan-600 hover:text-cyan-700 font-medium",children:"Return to Dashboard"})]});const N=s=>{switch(s){case"delivered":return"bg-green-100 text-green-700";case"processing":return"bg-blue-100 text-blue-700";case"cancelled":return"bg-red-100 text-red-700";default:return"bg-yellow-100 text-yellow-700"}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[e.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[e.jsxs(u,{to:"/dashboard",className:"inline-flex items-center text-gray-500 hover:text-gray-700 mb-6",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden mb-6",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Order #",t.order_number]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold uppercase tracking-wide ${N(t.status)}`,children:t.status})]}),e.jsxs("p",{className:"text-gray-500 text-sm",children:["Placed on ",new Date(t.created_at).toLocaleDateString()," at ",new Date(t.created_at).toLocaleTimeString()]})]}),t.status==="delivered"&&e.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors font-medium text-sm",children:[e.jsx(_,{className:"w-4 h-4"}),"Request Refund"]})]}),e.jsxs("div",{className:"p-6 grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wider mb-4",children:"Items Ordered"}),e.jsx("div",{className:"space-y-4",children:Array.isArray(t.items)&&t.items.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:s.image?e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-cover"}):e.jsx(w,{className:"w-8 h-8 text-gray-400 m-auto"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 line-clamp-1",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Qty: ",s.quantity," Ã— $",s.price]})]}),e.jsxs("div",{className:"font-bold text-gray-900",children:["$",(s.price*s.quantity).toFixed(2)]})]},r))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wider mb-4",children:"Order Summary"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal"}),e.jsxs("span",{className:"font-medium",children:["$",t.total.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Shipping"}),e.jsx("span",{className:"font-medium",children:"$0.00"})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-200 flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-gray-900",children:"Total"}),e.jsxs("span",{className:"text-xl font-bold text-cyan-600",children:["$",t.total.toFixed(2)]})]})]})]}),t.shipping_address&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wider mb-2",children:"Shipping Details"}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-600 bg-white border border-gray-100 p-3 rounded-lg",children:[e.jsx(R,{className:"w-4 h-4 mt-0.5 flex-shrink-0 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{children:t.shipping_address.address}),e.jsxs("p",{children:[t.shipping_address.city,", ",t.shipping_address.country]})]})]})]})]})]})]})]}),b&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Request Refund"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Please provide a reason for your refund request. The vendor will review your request."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Refund Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"number",value:c,onChange:s=>o(Number(s.target.value)),max:t.total,className:"w-full pl-9 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-cyan-500 outline-none"})]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Max refundable: $",t.total.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason"}),e.jsx("textarea",{value:d,onChange:s=>p(s.target.value),className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-cyan-500 outline-none h-24 resize-none",placeholder:"e.g. Item defective, wrong size..."})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>l(!1),className:"flex-1 py-2 text-gray-600 hover:bg-gray-50 rounded-lg font-medium transition-colors",children:"Cancel"}),e.jsx("button",{onClick:j,disabled:x||!d.trim(),className:"flex-1 py-2 bg-cyan-600 hover:bg-cyan-700 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Submitting...":"Submit Request"})]})]})})]})}export{C as OrderDetailsPage};
