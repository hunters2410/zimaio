import{r as a,j as e,S as f,l as p,s as k,P as w}from"./index-BktnpWS0.js";import{T as y}from"./truck-CO3939ut.js";import{C as _}from"./clock-Ep4hhKF1.js";import{C as j}from"./circle-check-big-DQYFJHkd.js";function E(){const[i,b]=a.useState(""),[r,m]=a.useState(null),[n,x]=a.useState([]),[o,c]=a.useState(!1),[h,l]=a.useState(""),g=async()=>{if(!i.trim()){l("Please enter a tracking number");return}c(!0),l(""),m(null),x([]);try{const{data:s,error:t}=await k.rpc("get_delivery_details",{p_tracking_number:i.trim()});if(t)throw t;if(!s){l("No delivery found with this tracking number"),c(!1);return}m(s.delivery),x(s.history||[])}catch(s){console.error("Tracking Error:",s),l(s.message||"Failed to track order")}finally{c(!1)}},N=s=>{switch(s){case"delivered":return e.jsx(j,{className:"h-6 w-6 text-green-500"});case"in_transit":case"picked_up":return e.jsx(y,{className:"h-6 w-6 text-blue-500"});default:return e.jsx(w,{className:"h-6 w-6 text-gray-400"})}},v=s=>{switch(s){case"delivered":return"bg-green-100 text-green-700";case"in_transit":case"picked_up":return"bg-blue-100 text-blue-700";case"pending":case"assigned":return"bg-yellow-100 text-yellow-700";case"cancelled":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},u=s=>s.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" "),d=s=>new Date(s).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white",children:e.jsxs("div",{className:"container mx-auto px-4 py-12",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"Track Your Order"}),e.jsx("p",{className:"text-green-100",children:"Enter your tracking number to see delivery status"})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("div",{className:"max-w-2xl mx-auto mb-8",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:i,onChange:s=>b(s.target.value),onKeyPress:s=>s.key==="Enter"&&g(),placeholder:"Enter tracking number (e.g., TRK123456789)",className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"}),e.jsxs("button",{onClick:g,disabled:o,className:"px-6 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold transition flex items-center space-x-2 disabled:opacity-50",children:[e.jsx(f,{className:"h-5 w-5"}),e.jsx("span",{children:o?"Tracking...":"Track"})]})]}),h&&e.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:h})]})}),r&&e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Delivery Status"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Tracking: ",r.tracking_number]})]}),e.jsx("span",{className:`px-4 py-2 rounded-full font-semibold ${v(r.delivery_status)}`,children:u(r.delivery_status)})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center",children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"Delivery Address"]}),e.jsx("p",{className:"text-gray-900",children:r.delivery_address}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.customer_phone})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Vendor"}),e.jsx("p",{className:"text-gray-900",children:r.vendor.full_name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.vendor.phone})]}),r.driver&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Assigned Driver"]}),e.jsx("p",{className:"text-gray-900",children:r.driver.driver_name}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1 capitalize",children:[r.driver.vehicle_type," â€¢ ",r.driver.vehicle_number]}),e.jsx("p",{className:"text-sm text-gray-600",children:r.driver.phone_number})]}),r.pickup_time&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Picked Up"]}),e.jsx("p",{className:"text-gray-900",children:d(r.pickup_time)})]}),r.delivery_time&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center",children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Delivered"]}),e.jsx("p",{className:"text-gray-900",children:d(r.delivery_time)})]})]}),r.delivery_notes&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Delivery Notes"}),e.jsx("p",{className:"text-gray-900",children:r.delivery_notes})]})]}),n.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Tracking History"}),e.jsx("div",{className:"space-y-4",children:n.map((s,t)=>e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"flex flex-col items-center mr-4",children:[N(s.status),t<n.length-1&&e.jsx("div",{className:"w-0.5 h-full bg-gray-300 my-2"})]}),e.jsxs("div",{className:"flex-1 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:u(s.status)}),e.jsx("span",{className:"text-sm text-gray-500",children:d(s.created_at)})]}),s.location&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx(p,{className:"h-3 w-3 inline mr-1"}),s.location]}),s.notes&&e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:s.notes})]})]},s.id))})]})]})]})]})}export{E as TrackOrderPage};
