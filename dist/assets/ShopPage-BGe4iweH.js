import{u as V,q as L,e as B,t as T,r as l,s as c,j as e,S as R,L as p,c as O,o as U,p as Z,P,d as z,v as F,w as Y,l as G}from"./index-T9wcIP7k.js";import{A as q}from"./arrow-left-CeWPuxjJ.js";import{S as o}from"./star-Fc9uE4lG.js";import{S as H}from"./shopping-bag-BM34hV8d.js";import{C as J}from"./check-CtKt80mY.js";function ae(){const b=V(),{userId:x}=L(),{user:n}=B(),{openChat:A}=T(),[t,D]=l.useState(null),[m,E]=l.useState([]),[i,$]=l.useState([]),[I,u]=l.useState(!0),[g,f]=l.useState(!1),[h,k]=l.useState(5),[w,j]=l.useState(""),[y,N]=l.useState(null),[v,S]=l.useState(!1);l.useEffect(()=>{x&&_()},[x]);const _=async()=>{u(!0);try{const{data:a}=await c.from("vendor_profiles").select("*").eq("user_id",x).single();if(a){D(a);const{data:s}=await c.from("products").select("*, category:categories(name, slug)").eq("vendor_id",a.id).eq("is_active",!0).order("created_at",{ascending:!1});s&&E(s);const{data:r}=await c.from("vendor_reviews").select("*, user:profiles(full_name)").eq("vendor_id",a.id).order("created_at",{ascending:!1});r&&$(r)}}catch(a){console.error("Error fetching shop data:",a)}finally{u(!1)}},M=async a=>{if(a.preventDefault(),!!n&&t){f(!0),N(null);try{const{error:s}=await c.from("vendor_reviews").insert({vendor_id:t.id,user_id:n.id,rating:h,comment:w});if(s)throw s;S(!0),j(""),k(5),_(),setTimeout(()=>S(!1),3e3)}catch(s){N(s.message)}finally{f(!1)}}};return I?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-slate-900 transition-colors duration-300",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-emerald-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400 font-black uppercase tracking-widest text-xs",children:"Opening Shop..."})]})}):t?e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-900 pb-20 transition-colors duration-300",children:[e.jsxs("div",{className:"h-[250px] md:h-[300px] relative overflow-hidden bg-gray-900 dark:bg-slate-950",children:[t.shop_banner_url?e.jsx("img",{src:t.shop_banner_url,className:"w-full h-full object-cover opacity-60",alt:t.shop_name}):e.jsx("div",{className:"w-full h-full bg-emerald-900/40 flex items-center justify-center"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-50 dark:from-slate-900 via-transparent to-transparent"})]}),e.jsxs("div",{className:"container mx-auto px-4 -mt-20 relative z-10",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-3xl shadow-xl shadow-gray-200/50 dark:shadow-slate-950/50 p-6 md:p-8 border border-gray-100 dark:border-slate-700",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[e.jsx("div",{className:"w-24 h-24 md:w-32 md:h-32 bg-white dark:bg-slate-700 p-1.5 rounded-2xl shadow-xl border border-gray-50 dark:border-slate-600 flex-shrink-0 flex items-center justify-center overflow-hidden",children:t.shop_logo_url?e.jsx("img",{src:t.shop_logo_url,className:"w-full h-full object-cover rounded-xl",alt:t.shop_name}):e.jsx(R,{className:"w-12 h-12 text-emerald-500"})}),e.jsxs("div",{className:"flex-1 mt-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-2",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-black text-gray-900 dark:text-white uppercase tracking-tight",children:t.shop_name}),t.is_verified&&e.jsxs("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 px-3 py-1 rounded-full flex items-center gap-1.5 border border-emerald-100 dark:border-emerald-800",children:[e.jsx(O,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"}),e.jsx("span",{className:"text-[8px] font-black text-emerald-900 dark:text-emerald-400 uppercase tracking-widest",children:"Verified Merchant"})]})]}),e.jsx("p",{className:"text-sm text-gray-600 font-medium leading-relaxed max-w-2xl mb-6",children:t.shop_description||"Certified ZimAIO partner committed to providing superior products."}),e.jsxs("button",{onClick:()=>{if(!n){b("/login");return}t&&A(t.id,t.shop_name)},className:"inline-flex items-center gap-2 bg-emerald-600 text-white px-5 py-2.5 rounded-xl font-black uppercase text-[10px] tracking-widest shadow-lg shadow-emerald-200 hover:bg-emerald-700 transition-all active:scale-95 mb-4",children:[e.jsx(U,{className:"w-4 h-4"})," Message Vendor"]}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-center border-t border-gray-50 dark:border-slate-700 pt-6 mt-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[9px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-0.5",children:"Rating"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(o,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"}),e.jsx("span",{className:"text-base font-black text-gray-900 dark:text-white",children:(t.rating||5).toFixed(1)})]})]}),e.jsx("div",{className:"h-8 w-px bg-gray-100 dark:bg-slate-700 hidden sm:block"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[9px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-0.5",children:"Catalog"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(H,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("span",{className:"text-base font-black text-gray-900 dark:text-white",children:[m.length," Items"]})]})]}),e.jsx("div",{className:"h-8 w-px bg-gray-100 dark:bg-slate-700 hidden sm:block"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[9px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-0.5",children:"Presence"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Z,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-base font-black text-gray-900 dark:text-white",children:"Zimbabwe"})]})]})]})]})]})}),e.jsxs("div",{className:"mt-12",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-end justify-between gap-4 mb-8",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-gray-900 dark:text-white uppercase tracking-tight",children:"Catalog Items"}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 font-bold uppercase tracking-widest text-[10px] mt-1",children:["Products from ",t.shop_name]})]})}),m.length===0?e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-[2.5rem] border border-gray-100 dark:border-slate-700 p-20 text-center shadow-sm",children:[e.jsx(P,{className:"w-20 h-20 text-gray-200 dark:text-slate-700 mx-auto mb-6"}),e.jsx("h3",{className:"text-2xl font-black text-gray-900 dark:text-white uppercase",children:"Inventory Empty"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"This vendor has no active products listed currently."})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:m.map(a=>{var s,r;return e.jsxs(p,{to:`/products/${a.slug}`,className:"group bg-white dark:bg-slate-800 rounded-2xl overflow-hidden border border-gray-100 dark:border-slate-700 shadow-sm hover:shadow-xl hover:shadow-emerald-900/5 transition-all duration-300",children:[e.jsxs("div",{className:"aspect-square relative overflow-hidden bg-gray-50 dark:bg-slate-700",children:[(s=a.images)!=null&&s[0]?e.jsx("img",{src:a.images[0],className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",alt:a.name}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(P,{className:"w-8 h-8 text-gray-200 dark:text-slate-500"})}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx("span",{className:"px-2 py-0.5 bg-white/90 backdrop-blur-md rounded-full text-[8px] font-black text-emerald-600 uppercase tracking-widest shadow-sm",children:((r=a.category)==null?void 0:r.name)||"Item"})})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h4",{className:"font-bold text-gray-900 dark:text-white text-xs mb-2 uppercase tracking-tight group-hover:text-emerald-600 transition-colors line-clamp-1 leading-tight",children:a.name}),e.jsxs("div",{className:"flex items-center justify-between border-t border-gray-50 dark:border-slate-700 pt-2",children:[e.jsxs("p",{className:"text-sm font-black text-emerald-600 dark:text-emerald-400",children:["$",a.base_price.toFixed(2)]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:d=>{var C;d.preventDefault(),d.stopPropagation(),(C=a.category)!=null&&C.slug&&b(`/products?category=${a.category.slug}`)},className:"w-6 h-6 bg-gray-50 dark:bg-slate-700 hover:bg-emerald-600 dark:hover:bg-emerald-500 hover:text-white text-gray-400 dark:text-gray-500 rounded-lg flex items-center justify-center transition-all",title:"Find Similar",children:e.jsx(z,{className:"w-3.5 h-3.5"})}),e.jsx("div",{className:"w-6 h-6 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg flex items-center justify-center text-emerald-600 dark:text-emerald-400 group-hover:bg-emerald-600 dark:group-hover:bg-emerald-500 group-hover:text-white transition-all",children:e.jsx(q,{className:"w-3.5 h-3.5 rotate-180"})})]})]})]})]},a.id)})})]}),e.jsx("div",{className:"mt-16",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-10",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx("h2",{className:"text-xl font-black text-gray-900 dark:text-white uppercase tracking-tight mb-1",children:"Shop Ratings"}),e.jsxs("p",{className:"text-gray-400 dark:text-gray-500 font-bold text-[10px] uppercase tracking-widest mb-8",children:["Customer feedback for ",t.shop_name,"."]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl p-6 border border-gray-100 dark:border-slate-700 shadow-sm mb-6 text-left",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"text-4xl font-black text-gray-900 dark:text-white mb-1",children:(t.rating||5).toFixed(1)}),e.jsx("div",{className:"flex justify-center gap-1 mb-1",children:[...Array(5)].map((a,s)=>e.jsx(o,{className:`w-4 h-4 ${s<Math.floor(t.rating||5)?"text-yellow-500 fill-yellow-500":"text-gray-200 dark:text-slate-600"}`},s))}),e.jsxs("p",{className:"text-[9px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-[0.2em]",children:[i.length," Store Reviews"]})]}),e.jsx("div",{className:"space-y-3",children:[5,4,3,2,1].map(a=>{const s=i.filter(d=>d.rating===a).length,r=i.length>0?s/i.length*100:0;return e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-400 dark:text-gray-500 w-2 shrink-0",children:a}),e.jsx("div",{className:"flex-1 h-1.5 bg-gray-50 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-yellow-500 rounded-full",style:{width:`${r}%`}})}),e.jsx("span",{className:"text-[10px] font-black text-gray-400 dark:text-gray-500 w-6 shrink-0 text-right",children:s})]},a)})})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl p-6 border border-emerald-100 dark:border-emerald-900/30 shadow-xl shadow-emerald-900/5 text-left",children:[e.jsxs("h3",{className:"font-black text-gray-900 dark:text-white uppercase tracking-tight mb-4 flex items-center gap-2 text-sm",children:[e.jsx(F,{className:"w-4 h-4 text-emerald-600"})," Rate Vendor"]}),n?e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[8px] font-black text-gray-400 dark:text-gray-500 uppercase tracking-widest mb-2 block text-center",children:"Your Rating"}),e.jsx("div",{className:"flex justify-center gap-1",children:[1,2,3,4,5].map(a=>e.jsx("button",{type:"button",onClick:()=>k(a),className:`p-1 transition-all ${h>=a?"scale-110":"opacity-30 hover:opacity-100"}`,children:e.jsx(o,{className:`w-6 h-6 ${h>=a?"text-yellow-500 fill-yellow-500":"text-gray-300 dark:text-slate-600"}`})},a))})]}),e.jsx("div",{children:e.jsx("textarea",{required:!0,value:w,onChange:a=>j(a.target.value),placeholder:"Service feedback...",rows:3,className:"w-full bg-gray-50 dark:bg-slate-900 border border-transparent rounded-xl p-4 text-xs font-medium text-gray-900 dark:text-white focus:bg-white dark:focus:bg-slate-700 focus:border-emerald-500 outline-none transition-all placeholder-gray-400 dark:placeholder-gray-500"})}),y&&e.jsxs("div",{className:"bg-red-50 text-red-600 text-[8px] font-bold p-3 rounded-lg flex items-center gap-2",children:[e.jsx(Y,{className:"w-3 h-3"})," ",y]}),e.jsx("button",{type:"submit",disabled:g,className:`w-full py-3 rounded-xl font-black uppercase tracking-widest text-[9px] transition-all flex items-center justify-center gap-2 ${v?"bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600 dark:text-emerald-400":g?"bg-gray-100 dark:bg-slate-700 text-gray-400":"bg-gray-900 dark:bg-slate-700 text-white hover:bg-emerald-600"}`,children:v?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"w-3 h-3"})," Posted"]}):g?e.jsx("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-3 h-3"})," Submit"]})})]}):e.jsxs("div",{className:"text-center py-2",children:[e.jsx("p",{className:"text-[10px] text-gray-400 dark:text-gray-500 font-bold mb-2",children:"Sign in to share your experience"}),e.jsx(p,{to:"/login",className:"text-[9px] font-black text-emerald-600 dark:text-emerald-400 uppercase tracking-widest hover:underline",children:"Sign In Now"})]})]})]}),e.jsx("div",{className:"lg:col-span-2 space-y-4",children:i.length===0?e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl border border-gray-100 dark:border-slate-700 p-12 text-center shadow-sm",children:[e.jsx(F,{className:"w-12 h-12 text-gray-100 dark:text-slate-700 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-black text-gray-900 dark:text-white uppercase",children:"Awaiting Feedback"}),e.jsx("p",{className:"text-gray-400 dark:text-gray-500 font-bold text-[10px] uppercase tracking-widest",children:"Be the first to rate your experience."})]}):i.map(a=>{var s,r,d;return e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl p-6 md:p-8 border border-gray-100 dark:border-slate-700 shadow-sm text-left",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-50 dark:bg-emerald-900/20 rounded-xl flex items-center justify-center font-black text-emerald-600 dark:text-emerald-400 uppercase text-sm",children:((r=(s=a.user)==null?void 0:s.full_name)==null?void 0:r.charAt(0))||"U"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-black text-gray-900 dark:text-white uppercase tracking-tight text-xs",children:((d=a.user)==null?void 0:d.full_name)||"Verified Customer"}),e.jsx("p",{className:"text-[8px] text-gray-400 dark:text-gray-500 font-bold uppercase tracking-widest",children:new Date(a.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-yellow-50 dark:bg-yellow-900/20 px-2 py-1 rounded-full",children:[e.jsx(o,{className:"w-3 h-3 text-yellow-500 fill-yellow-500"}),e.jsx("span",{className:"text-[10px] font-black text-yellow-700 dark:text-yellow-400",children:a.rating.toFixed(1)})]})]}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-300 font-medium leading-relaxed italic text-sm",children:['"',a.comment,'"']})]},a.id)})})]})})]})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-slate-900 p-4 transition-colors duration-300",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx(R,{className:"w-20 h-20 text-gray-200 dark:text-slate-700 mx-auto mb-6"}),e.jsx("h2",{className:"text-3xl font-black text-gray-900 dark:text-white uppercase mb-4",children:"Store Not Found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 font-medium mb-8",children:"The shop you are looking for might have moved or closed down."}),e.jsxs(p,{to:"/vendors",className:"inline-flex items-center gap-2 bg-emerald-600 text-white px-8 py-4 rounded-2xl font-black uppercase tracking-widest text-xs shadow-xl shadow-emerald-200 hover:bg-emerald-700 transition-all",children:[e.jsx(q,{className:"w-4 h-4"})," Back to Vendors"]})]})})}export{ae as ShopPage};
