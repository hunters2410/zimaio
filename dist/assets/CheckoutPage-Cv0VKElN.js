import{i as Se,b as Oe,a as De,e as Ie,f as Me,c as qe,u as Ae,r as d,j as e,U as xe,M as pe,g as $e,s as j}from"./index-BktnpWS0.js";import{p as G}from"./paymentService-CTucAM2Y.js";import{L as ye}from"./lock-BwUOE3mp.js";import{C as Te}from"./check-t-U1Tl8Z.js";import{C as R}from"./credit-card-BMxorgaG.js";import{S as X,L as Ve}from"./smartphone-C6kVHtbt.js";import{W as ze}from"./wallet-BZzyyv9x.js";import{T as Fe}from"./truck-CO3939ut.js";import{S as Le}from"./shield-check-DNs4Rlpo.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ge=Se("copy",Ye);function et(){const{user:v}=Oe(),{cartItems:O,clearCart:D}=De(),{formatPrice:C}=Ie(),{calculatePrice:W,settings:N}=Me();qe();const z=Ae(),[ee,F]=d.useState(!1),[ge,he]=d.useState([]),[r,I]=d.useState(null),[L,fe]=d.useState([]),[y,M]=d.useState(""),[q,te]=d.useState(""),[A,re]=d.useState(""),[ae,se]=d.useState(""),[x,B]=d.useState({pan:"",expiry:"",cvv:""}),[Z,be]=d.useState(""),[we,oe]=d.useState(!1),[Re,le]=d.useState(""),[je,ne]=d.useState(!1),[ie,ve]=d.useState(""),[Ne,_e]=d.useState(""),[ce,de]=d.useState(!1),ke=O.reduce((t,a)=>t+a.base_price*a.quantity,0),{totalTax:Pe,totalWithTax:U}=O.reduce((t,a)=>{const s=W(a.base_price);return{totalTax:t.totalTax+s.vat*a.quantity,totalWithTax:t.totalWithTax+s.total*a.quantity}},{totalTax:0,totalWithTax:0}),[h,J]=d.useState({street:"",city:"",state:"",zip:"",country:"Zimbabwe"}),$=r?r.base_cost:0,_=U+$,T=ge.filter(t=>{const a=t.min_order_total||0,s=t.max_order_total;return U>=a&&(s==null||U<=s)});d.useEffect(()=>{T.length>0?(!r||r.id!=="pickup"&&!T.find(t=>t.id===r.id))&&I(T[0]):(!r||r.id!=="pickup")&&I({id:"pickup",display_name:"Store Pickup",base_cost:0,delivery_time_min:0,delivery_time_max:0})},[T,r]),d.useEffect(()=>{const t=async()=>{const{data:s}=await j.from("shipping_methods").select("*").eq("is_active",!0);s&&(he(s),I({id:"pickup",display_name:"Store Pickup",base_cost:0,delivery_time_min:0,delivery_time_max:0}))},a=async()=>{const s=await G.getActiveGateways();fe(s),s.length>0&&(s.some(c=>c.gateway_type==="iveri")?M("iveri_card"):M(s[0].gateway_type))};t(),a(),v&&(te(v.email||""),(async()=>{const{data:c}=await j.from("profiles").select("*").eq("id",v.id).single();c&&(re(c.full_name||""),se(c.phone||""))})())},[v]);const me=async()=>{const t=Math.random().toString(36).slice(-8)+"Aa1!",{data:a,error:s}=await j.auth.signUp({email:q,password:t,options:{data:{full_name:A,phone:ae,role:"customer"}}});if(s)throw s;return{user:a.user,password:t}};d.useEffect(()=>{y==="paypal"&&(async()=>{var s;const a=L.find(c=>c.gateway_type==="paypal");if(!(!a||!((s=a.configuration)!=null&&s.client_id)))if(document.getElementById("paypal-sdk"))ue();else{const c=document.createElement("script");c.id="paypal-sdk",c.src=`https://www.paypal.com/sdk/js?client-id=${a.configuration.client_id}&currency=USD`,c.onload=ue,document.body.appendChild(c)}})()},[y,L]);const ue=()=>{if(window.paypal){const t=document.getElementById("paypal-button-container");t&&(t.innerHTML=""),window.paypal.Buttons({createOrder:async(a,s)=>{try{return s.order.create({purchase_units:[{amount:{value:_.toFixed(2)},description:`Order from ${(N==null?void 0:N.site_name)||"ZimAIO"}`}]})}catch(c){return console.error("PayPal Create Error",c),null}},onApprove:async(a,s)=>{const c=await s.order.capture();await Ce(c)},onError:a=>{console.error("PayPal Error",a),alert("PayPal payment failed")}}).render("#paypal-button-container")}},Ce=async t=>{F(!0);try{let a=v;if(!a){if(!q)throw new Error("Email is required for receipt.");const{user:f,password:g}=await me();a=f}if(!a)throw new Error("Authentication failed during order creation.");const s=O.reduce((f,g)=>(f[g.vendor_id]||(f[g.vendor_id]=[]),f[g.vendor_id].push(g),f),{}),c=Object.entries(s).map(async([f,g])=>{var S;const H=g.reduce((u,w)=>u+w.base_price*w.quantity,0),o=g.reduce((u,w)=>{const k=W(w.base_price);return{total:u.total+k.total*w.quantity,tax:u.tax+k.vat*w.quantity,comm:u.comm+k.commission*w.quantity}},{tax:0,comm:0,total:0}),l=o.total+$/Object.keys(s).length,m=(r==null?void 0:r.id)==="pickup",i=m?{street:"Store Pickup",city:"Store Pickup",state:"Store Pickup",country:"Zimbabwe",zip:"0000"}:h,p=m?null:r==null?void 0:r.id,E=`ORD-${Date.now()}-${Math.floor(Math.random()*1e3)}`,{data:V,error:Y}=await j.from("orders").insert({order_number:E,customer_id:a.id,vendor_id:f,status:"processing",payment_status:"paid",payment_method:"paypal",shipping_method_id:p,shipping_address:i,subtotal:H,tax_total:o.tax,shipping_total:$/Object.keys(s).length,total:l,commission_amount:o.comm,items:g}).select().single();if(Y)throw Y;const Q=g.map(u=>({order_id:V.id,product_id:u.id,quantity:u.quantity,unit_price:u.price,total_price:u.price*u.quantity}));return await j.from("order_items").insert(Q),await j.from("payment_transactions").insert({order_id:V.id,user_id:a.id,gateway_id:(S=L.find(u=>u.gateway_type==="paypal"))==null?void 0:S.id,gateway_type:"paypal",amount:l,currency:"USD",status:"completed",transaction_reference:t.id,metadata:{paypal_payer:t.payer}}),V}),n=await Promise.all(c);D(),z(`/orders/${n[0].id}?payment=success`)}catch(a){console.error("Order Finalization Error",a),alert("Payment received but order creation failed. Please contact support.")}finally{F(!1)}},Ee=async()=>{var t,a,s,c;F(!0),console.log("Starting order placement...");try{let n=v;if(!n){if(console.log("No user logged in, attempting guest signup..."),!q)throw new Error("Email is required for guest checkout.");const{user:o,password:l}=await me();if(n=o,console.log("Guest signup successful:",n==null?void 0:n.id),n){if((r==null?void 0:r.id)!=="pickup"){const{error:m}=await j.from("profiles").update({city:h.city,country:h.country}).eq("id",n.id);m&&console.error("Profile update error:",m)}ve(l),_e(q),ne(!0)}}if(!n)throw new Error("Authentication failed.");if((r==null?void 0:r.id)!=="pickup"&&(!h.street||!h.city||!h.state))throw new Error("Please enter a valid shipping address.");const f=O.reduce((o,l)=>(o[l.vendor_id]||(o[l.vendor_id]=[]),o[l.vendor_id].push(l),o),{}),g=Object.entries(f).map(async([o,l])=>{const m=l.reduce((b,P)=>b+P.base_price*P.quantity,0),i=l.reduce((b,P)=>{const K=W(P.base_price);return{tax:b.tax+K.vat*P.quantity,comm:b.comm+K.commission*P.quantity,total:b.total+K.total*P.quantity}},{tax:0,comm:0,total:0}),p=i.total+$/Object.keys(f).length,E=(r==null?void 0:r.id)==="pickup",V=E?{street:"Store Pickup",city:"Store Pickup",state:"Store Pickup",country:"Zimbabwe",zip:"0000"}:h,Y=E?null:r==null?void 0:r.id,Q=`ORD-${Date.now()}-${Math.floor(Math.random()*1e3)}`;console.log(`Creating order for vendor ${o}...`);const{data:S,error:u}=await j.from("orders").insert({order_number:Q,customer_id:n.id,vendor_id:o,status:"pending",payment_status:"pending",payment_method:y,shipping_method_id:Y,shipping_address:V,subtotal:m,tax_total:i.tax,shipping_total:$/Object.keys(f).length,total:p,commission_amount:i.comm,items:l}).select().single();if(u)throw console.error("Order Insert Error:",u),u;console.log("Order created:",S.id);const w=l.map(b=>({order_id:S.id,product_id:b.id,quantity:b.quantity,unit_price:b.price,total_price:b.price*b.quantity}));console.log("Inserting order items...");const{error:k}=await j.from("order_items").insert(w);if(k)throw console.error("Order Items Insert Error:",k),k;return console.log("Order items inserted successfully."),{data:S}}),H=await Promise.all(g);if(["paynow","paypal"].includes(y)){const o=(t=H[0])==null?void 0:t.data;if(!o)throw new Error("Order creation failed");console.log("Initiating payment for order:",o.id);const l=await G.initiatePayment({order_id:o.id,gateway_type:y,amount:_,currency:"USD",return_url:`${window.location.origin}/orders/${o.id}?payment=success`,metadata:{customer_name:A||(n==null?void 0:n.email),full_cart_payment:!0}});if(l.redirect_url){window.location.href=l.redirect_url,D();return}}else if(y==="iveri_card"){const o=(a=(await Promise.all(g))[0])==null?void 0:a.data;if(!o)throw new Error("Order creation failed");if(!x.pan||!x.expiry||!x.cvv)throw new Error("Please enter valid card details.");const l=x.pan.replace(/\s/g,"");if(l.length<13||l.length>19)throw new Error("Invalid card number. Please enter a valid 13-19 digit card number.");if(x.expiry.length!==4||!/^\d{4}$/.test(x.expiry))throw new Error("Invalid expiry date. Please use MMYY format (e.g., 1225).");console.log("=== iVeri Card Payment Debug ==="),console.log("Order ID:",o.id),console.log("Amount:",_),console.log("Currency: USD"),console.log("Card (masked):",l.slice(0,4)+"****"+l.slice(-4)),console.log("Expiry:",x.expiry);try{const m=await G.initiatePayment({order_id:o.id,gateway_type:"iveri",amount:_,currency:"USD",metadata:{customer_name:A||(n==null?void 0:n.email),full_cart_payment:!0,card_pan:l,card_expiry:x.expiry,card_cvv:x.cvv,payment_subtype:"card"}});if(console.log("=== iVeri Response ==="),console.log(m),m.success)le(o.id),oe(!0),D(),setTimeout(()=>{z(`/orders/${o.id}?payment=success`)},3e3);else{console.error("iVeri Payment Declined:",m);const i=m.details||m,p=JSON.stringify(i,null,2);throw new Error(`Payment Failed:
${p}`)}}catch(m){console.error("=== iVeri Payment Error ==="),console.error(m);let i=m.message||"Payment initiation failed";throw i.includes("not authenticated")?i="Session expired. Please refresh the page and try again.":i.includes("gateway not available")?i="Payment gateway is currently unavailable. Please contact support.":i.includes("Application ID")&&(i="Payment system configuration error. Please contact support."),new Error(i)}}else if(y==="iveri_ecocash"){const o=(s=(await Promise.all(g))[0])==null?void 0:s.data;if(!o)throw new Error("Order creation failed");if(!Z)throw new Error("Please enter your EcoCash number.");const l=Z.replace(/\D/g,"");if(l.length<9||l.length>12)throw new Error("Invalid phone number. Please enter a valid mobile number.");const m=`910012${l}`;console.log("=== iVeri EcoCash Payment Debug ==="),console.log("Order ID:",o.id),console.log("Amount:",_),console.log("Phone (masked):",l.slice(0,3)+"***"+l.slice(-2)),console.log("EcoCash PAN:",m.slice(0,6)+"****");try{const i=await G.initiatePayment({order_id:o.id,gateway_type:"iveri",amount:_,currency:"USD",metadata:{customer_name:A||(n==null?void 0:n.email),full_cart_payment:!0,card_pan:m,card_expiry:"1228",card_cvv:"",payment_subtype:"ecocash"}});if(console.log("=== iVeri EcoCash Response ==="),console.log(i),i.success)le(o.id),oe(!0),D(),setTimeout(()=>{z(`/orders/${o.id}?payment=success`)},3e3);else{console.error("EcoCash Payment Declined:",i);const p=i.details||i,E=JSON.stringify(p,null,2);throw new Error(`EcoCash Failed:
${E}`)}}catch(i){console.error("=== iVeri EcoCash Payment Error ==="),console.error(i);let p=i.message||"EcoCash payment initiation failed";throw p.includes("not authenticated")?p="Session expired. Please refresh the page and try again.":p.includes("gateway not available")?p="Payment gateway is currently unavailable. Please contact support.":p.includes("Application ID")&&(p="Payment system configuration error. Please contact support."),new Error(p)}}else D(),z("/orders")}catch(n){console.error("Detailed Checkout Error:",n),n.message,n.code==="42501"||(c=n.message)!=null&&c.includes("violates row-level security")}finally{F(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 py-12",children:[we&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-sm w-full shadow-2xl transform scale-100 animate-in zoom-in-95 duration-300 flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-32 h-32 flex items-center justify-center mb-6 animate-bounce",children:e.jsx("img",{src:"/zimaio-logo.png",alt:"ZimAIO",className:"w-full h-full object-contain"})}),e.jsx("h2",{className:"text-2xl font-black text-gray-900 mb-2",children:"Payment Successful!"}),e.jsx("p",{className:"text-gray-500 text-sm mb-6",children:"Your secure payment has been processed. Redirecting to your order summary..."}),e.jsx("div",{className:"w-full bg-gray-100 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500 animate-[progress_3s_ease-in-out_forwards] w-full origin-left"})})]})}),je&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full shadow-2xl transform scale-100 animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(xe,{className:"w-8 h-8 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-black text-gray-900 mb-2",children:"Account Created!"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Welcome to ZimAIO! Your account has been successfully created."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl p-5 mb-6 border border-gray-200",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 tracking-wider mb-2",children:"Email Address"}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-white rounded-lg border border-gray-200",children:[e.jsx(pe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:Ne})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-gray-500 tracking-wider mb-2",children:"Temporary Password"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-2 px-4 py-3 bg-white rounded-lg border border-gray-200",children:[e.jsx(ye,{className:"w-4 h-4 text-gray-400"}),e.jsx("code",{className:"text-sm font-mono font-bold text-green-600 flex-1",children:ie})]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(ie),de(!0),setTimeout(()=>de(!1),2e3)},className:`p-3 rounded-lg transition-all ${ce?"bg-green-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"}`,title:"Copy password",children:ce?e.jsx(Te,{className:"w-5 h-5"}):e.jsx(Ge,{className:"w-5 h-5"})})]})]})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6",children:e.jsxs("p",{className:"text-xs text-amber-800 leading-relaxed",children:[e.jsx("strong",{className:"font-bold",children:"Important:"})," Please save this password securely. You can change it after logging in from your account settings."]})}),e.jsx("button",{onClick:()=>ne(!1),className:"w-full py-4 bg-green-600 text-white rounded-xl font-black uppercase tracking-widest text-xs shadow-xl shadow-green-200 hover:bg-green-700 active:scale-95 transition-all",children:"Continue to Checkout"})]})}),e.jsxs("div",{className:"container mx-auto px-4 max-w-6xl",children:[e.jsx("h1",{className:"text-3xl font-black text-gray-900 uppercase tracking-tight mb-8",children:"Secure Checkout"}),e.jsxs("div",{className:"grid lg:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-[2rem] p-8 shadow-sm border border-gray-100",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"w-6 h-6 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center text-xs",children:"1"}),"Contact Information"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 mb-1",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-2.5 w-3.5 h-3.5 text-gray-400"}),e.jsx("input",{type:"email",disabled:!!v,value:q,onChange:t=>te(t.target.value),className:"w-full pl-9 pr-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 mb-1",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-2.5 w-3.5 h-3.5 text-gray-400"}),e.jsx("input",{type:"tel",value:ae,onChange:t=>se(t.target.value),className:"w-full pl-9 pr-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 mb-1",children:"Full Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-2.5 w-3.5 h-3.5 text-gray-400"}),e.jsx("input",{type:"text",value:A,onChange:t=>re(t.target.value),className:"w-full pl-9 pr-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"w-6 h-6 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center text-xs",children:"2"}),"Delivery Method"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("div",{onClick:()=>I({id:"pickup",display_name:"Store Pickup",base_cost:0,delivery_time_min:0,delivery_time_max:0}),className:`cursor-pointer border rounded-xl p-3 flex items-center justify-between transition-all ${(r==null?void 0:r.id)==="pickup"?"border-emerald-500 bg-emerald-50/20":"border-gray-100 hover:border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${(r==null?void 0:r.id)==="pickup"?"border-emerald-500":"border-gray-300"}`,children:(r==null?void 0:r.id)==="pickup"&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-xs text-gray-900",children:"Store Pickup"}),e.jsx("p",{className:"text-[10px] text-gray-400 font-medium",children:"Collect directly from shop"})]})]}),e.jsx("span",{className:"font-bold text-xs text-emerald-600",children:"FREE"})]}),T.map(t=>e.jsxs("div",{onClick:()=>I(t),className:`cursor-pointer border rounded-xl p-3 flex items-center justify-between transition-all ${(r==null?void 0:r.id)===t.id?"border-emerald-500 bg-emerald-50/20":"border-gray-100 hover:border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border flex items-center justify-center ${(r==null?void 0:r.id)===t.id?"border-emerald-500":"border-gray-300"}`,children:(r==null?void 0:r.id)===t.id&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-xs text-gray-900",children:t.display_name}),e.jsxs("p",{className:"text-[10px] text-gray-400 font-medium",children:[t.delivery_time_min,"-",t.delivery_time_max," Days"]})]})]}),e.jsx("span",{className:"font-bold text-xs text-gray-900",children:C(t.base_cost)})]},t.id))]})]}),(r==null?void 0:r.id)!=="pickup"&&e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 animate-in fade-in slide-in-from-top-4 duration-300",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"w-6 h-6 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center text-xs",children:"3"}),"Shipping Address"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 mb-1",children:"Street Address"}),e.jsx("input",{type:"text",value:h.street,onChange:t=>J({...h,street:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 mb-1",children:"City"}),e.jsx("input",{type:"text",value:h.city,onChange:t=>J({...h,city:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 mb-1",children:"Province/State"}),e.jsx("input",{type:"text",value:h.state,onChange:t=>J({...h,state:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("h2",{className:"text-lg font-bold flex items-center gap-3 mb-4",children:[e.jsx("span",{className:"w-6 h-6 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center text-xs",children:"4"}),"Payment Method"]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:L.map(t=>{if(t.gateway_type==="iveri")return e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:()=>M("iveri_card"),className:`cursor-pointer border rounded-xl p-3 flex flex-col items-center justify-center gap-2 transition-all ${y==="iveri_card"?"border-emerald-500 bg-emerald-50/20 text-emerald-700":"border-gray-100 text-gray-400 hover:border-gray-200"}`,children:[e.jsx(R,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wide text-center",children:"In-Store Card"})]},"iveri_card"),e.jsxs("div",{onClick:()=>M("iveri_ecocash"),className:`cursor-pointer border rounded-xl p-3 flex flex-col items-center justify-center gap-2 transition-all ${y==="iveri_ecocash"?"border-emerald-500 bg-emerald-50/20 text-emerald-700":"border-gray-100 text-gray-400 hover:border-gray-200"}`,children:[e.jsx(X,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wide text-center",children:"EcoCash"})]},"iveri_ecocash")]});const a=t.gateway_type==="paynow"?X:t.gateway_type==="stripe"?R:t.gateway_type==="paypal"?ze:t.gateway_type==="cash"?Fe:R;return e.jsxs("div",{onClick:()=>M(t.gateway_type),className:`cursor-pointer border rounded-xl p-3 flex flex-col items-center justify-center gap-2 transition-all ${y===t.gateway_type?"border-emerald-500 bg-emerald-50/20 text-emerald-700":"border-gray-100 text-gray-400 hover:border-gray-200"}`,children:[e.jsx(a,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wide text-center",children:t.display_name})]},t.id)})}),y==="iveri_card"&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100 animate-in slide-in-from-top-2 fade-in",children:[e.jsx("h3",{className:"text-xs font-black text-gray-900 uppercase tracking-widest mb-4",children:"Card Details"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 mb-1",children:"Card Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",maxLength:19,placeholder:"0000 0000 0000 0000",value:x.pan,onChange:t=>B({...x,pan:t.target.value}),className:"w-full pl-9 pr-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 tracking-wider"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 mb-1",children:"Expiry Date"}),e.jsx("input",{type:"text",placeholder:"MMYY",maxLength:4,value:x.expiry,onChange:t=>B({...x,expiry:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 text-center"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 mb-1",children:"CVV / CVC"}),e.jsx("input",{type:"text",maxLength:4,placeholder:"123",value:x.cvv,onChange:t=>B({...x,cvv:t.target.value}),className:"w-full px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 text-center"})]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 text-emerald-600 bg-emerald-50 p-3 rounded-lg",children:[e.jsx(Le,{className:"w-4 h-4"}),e.jsx("p",{className:"text-[10px] font-bold leading-tight",children:"Your card details are securely processed via iVeri Enterprise Gateway."})]})]}),y==="iveri_ecocash"&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100 animate-in slide-in-from-top-2 fade-in",children:[e.jsx("h3",{className:"text-xs font-black text-gray-900 uppercase tracking-widest mb-4",children:"EcoCash Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase text-gray-500 mb-1",children:"Mobile Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"tel",placeholder:"077 123 4567",value:Z,onChange:t=>be(t.target.value),className:"w-full pl-9 pr-3 py-2 bg-gray-50 border border-gray-200 rounded-lg focus:outline-none focus:border-emerald-500 font-medium text-xs text-gray-700 tracking-wider"})]}),e.jsx("p",{className:"text-[9px] text-gray-400 mt-2 ml-1",children:"We will send a push notification to your phone."})]})]}),y==="paypal"&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100 animate-in slide-in-from-top-2 fade-in",children:[e.jsx("div",{id:"paypal-button-container",className:"w-full"}),e.jsx("p",{className:"text-[10px] text-center text-gray-400 mt-2",children:"Secure payment processing by PayPal. You will be redirected to PayPal to complete your purchase."})]})]})]}),e.jsx("div",{className:"lg:col-span-4",children:e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm sticky top-24",children:[e.jsx("h3",{className:"text-lg font-black text-gray-900 uppercase tracking-tight mb-6",children:"Order Summary"}),e.jsx("div",{className:"space-y-3 mb-4",children:O.map(t=>e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-50 rounded-lg overflow-hidden border border-gray-100",children:e.jsx("img",{src:t.image,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-[11px] font-bold text-gray-900 line-clamp-1",children:t.name}),e.jsxs("p",{className:"text-[9px] text-gray-400",children:["Qty: ",t.quantity]})]})]}),e.jsx("span",{className:"text-[11px] font-black text-gray-900",children:C(t.price*t.quantity)})]},t.id))}),e.jsx("div",{className:"border-t border-gray-100 my-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 font-medium",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"text-gray-900 font-bold",children:C(ke)})]}),(N==null?void 0:N.is_enabled)&&e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 font-medium",children:[e.jsxs("span",{children:["VAT (",N.default_rate,"%)"]}),e.jsx("span",{className:"text-gray-900 font-bold",children:C(Pe)})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 font-medium",children:[e.jsx("span",{children:"Shipping"}),e.jsx("span",{className:"text-emerald-600 font-bold",children:r?C(r.base_cost):"--"})]})]}),e.jsx("div",{className:"border-t border-gray-100 my-6 pt-6",children:e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"font-black text-gray-900 uppercase",children:"Total"}),e.jsx("span",{className:"text-3xl font-black text-emerald-600 leading-none",children:C(_)})]})}),y!=="paypal"&&e.jsx("button",{onClick:Ee,disabled:ee,className:"w-full py-4 bg-emerald-600 text-white rounded-xl font-black uppercase tracking-widest text-xs shadow-xl shadow-emerald-200 hover:bg-emerald-700 active:scale-95 transition-all flex items-center justify-center gap-2",children:ee?e.jsx(Ve,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"w-4 h-4"})," Pay & Place Order"]})})]})})]})]})]})}export{et as CheckoutPage};
