import{r as i,s as o,j as e}from"./index-BktnpWS0.js";import{A as p}from"./AdminLayout-C6Mn2_Yu.js";import{P as w}from"./plus-DKkFzrwN.js";import{S as k}from"./square-pen-RrpnH1Wm.js";import{T as C}from"./trash-2-BZYqHlTV.js";import"./chevron-left-AWoZAuKB.js";import"./x-Be8cuiWM.js";import"./triangle-alert-HMuOKNOn.js";import"./circle-check-big-DQYFJHkd.js";import"./chevron-right-peYPGYwP.js";import"./zap-CpGj1Zaf.js";import"./maximize-DSH1SQuK.js";import"./store-DDL7ZG_8.js";import"./users-vNuzB1jC.js";import"./shield-QBrICIHj.js";import"./file-text-DIHdwLby.js";import"./globe-CdXxteOx.js";import"./truck-CO3939ut.js";import"./credit-card-BMxorgaG.js";import"./settings-D3GsvmJN.js";import"./trending-up-wuknMfwd.js";function Q(){const[g,u]=i.useState([]),[h,f]=i.useState(!0),[b,l]=i.useState(!1),[n,m]=i.useState(null),[t,a]=i.useState({role_name:"",role_description:"",permissions:[],is_active:!0}),j=["view_dashboard","manage_users","manage_vendors","manage_products","manage_orders","manage_finances","view_reports","manage_settings","manage_content","manage_promotions"];i.useEffect(()=>{c()},[]);const c=async()=>{const{data:s}=await o.from("user_roles").select("*").order("created_at",{ascending:!1});u(s||[]),f(!1)},_=async s=>{s.preventDefault(),n?await o.from("user_roles").update({role_name:t.role_name,role_description:t.role_description,permissions:t.permissions,is_active:t.is_active,updated_at:new Date().toISOString()}).eq("id",n.id):await o.from("user_roles").insert([{role_name:t.role_name,role_description:t.role_description,permissions:t.permissions,is_active:t.is_active}]),c(),x()},v=async s=>{confirm("Are you sure you want to delete this role?")&&(await o.from("user_roles").delete().eq("id",s),c())},y=s=>{a(r=>({...r,permissions:r.permissions.includes(s)?r.permissions.filter(d=>d!==s):[...r.permissions,s]}))},x=()=>{a({role_name:"",role_description:"",permissions:[],is_active:!0}),m(null),l(!1)},N=s=>{m(s),a({role_name:s.role_name,role_description:s.role_description,permissions:s.permissions,is_active:s.is_active}),l(!0)};return h?e.jsx(p,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})})}):e.jsxs(p,{children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"User Roles Management"}),e.jsx("p",{className:"text-gray-600",children:"Define custom roles and permissions"})]}),e.jsxs("button",{onClick:()=>l(!0),className:"flex items-center px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition",children:[e.jsx(w,{className:"h-5 w-5 mr-2"}),"Add Role"]})]}),e.jsx("div",{className:"grid gap-6",children:g.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:s.role_name}),e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${s.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.is_active?"Active":"Inactive"})]}),e.jsx("p",{className:"text-gray-600",children:s.role_description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>N(s),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition",children:e.jsx(k,{className:"h-5 w-5"})}),e.jsx("button",{onClick:()=>v(s.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",children:e.jsx(C,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.permissions.map(r=>e.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 text-sm rounded-full",children:r.replace(/_/g," ").replace(/\b\w/g,d=>d.toUpperCase())},r))})]},s.id))}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:n?"Edit Role":"Add New Role"}),e.jsxs("form",{onSubmit:_,children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role Name"}),e.jsx("input",{type:"text",required:!0,value:t.role_name,onChange:s=>a({...t,role_name:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",{value:t.role_description,onChange:s=>a({...t,role_description:s.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Permissions"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:j.map(s=>e.jsxs("label",{className:"flex items-center space-x-2 p-3 border rounded-lg cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:t.permissions.includes(s),onChange:()=>y(s),className:"rounded text-green-600 focus:ring-green-500"}),e.jsx("span",{className:"text-sm",children:s.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase())})]},s))})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.is_active,onChange:s=>a({...t,is_active:s.target.checked}),className:"rounded text-green-600 focus:ring-green-500"}),e.jsx("label",{className:"ml-2 text-sm text-gray-700",children:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:x,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition",children:[n?"Update":"Create"," Role"]})]})]})]})})]})}export{Q as UserRolesManagement};
